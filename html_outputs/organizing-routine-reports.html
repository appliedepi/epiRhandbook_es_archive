<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>39 Borrador. Organización de informes rutinarios | El manual de R para la Epidemiología</title>
<meta name="author" content="El equipo del manual">
<meta name="description" content="ADVERTENCIA: Esta traducción es sólo un borrador de la traducción al español. Este documento tal cual está ha sido generado automáticamente con DeepL.com y se han hecho algunas correcciones...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="39 Borrador. Organización de informes rutinarios | El manual de R para la Epidemiología">
<meta property="og:type" content="book">
<meta property="og:description" content="ADVERTENCIA: Esta traducción es sólo un borrador de la traducción al español. Este documento tal cual está ha sido generado automáticamente con DeepL.com y se han hecho algunas correcciones...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="39 Borrador. Organización de informes rutinarios | El manual de R para la Epidemiología">
<meta name="twitter:description" content="ADVERTENCIA: Esta traducción es sólo un borrador de la traducción al español. Este documento tal cual está ha sido generado automáticamente con DeepL.com y se han hecho algunas correcciones...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.18/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.4.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-8.1.2/highcharts.js"></script><script src="libs/highcharts-8.1.2/highcharts-3d.js"></script><script src="libs/highcharts-8.1.2/highcharts-more.js"></script><script src="libs/highcharts-8.1.2/modules/stock.js"></script><script src="libs/highcharts-8.1.2/modules/map.js"></script><script src="libs/highcharts-8.1.2/modules/annotations.js"></script><script src="libs/highcharts-8.1.2/modules/data.js"></script><script src="libs/highcharts-8.1.2/modules/drilldown.js"></script><script src="libs/highcharts-8.1.2/modules/item-series.js"></script><script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script><script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-8.1.2/modules/exporting.js"></script><script src="libs/highcharts-8.1.2/modules/export-data.js"></script><script src="libs/highcharts-8.1.2/modules/funnel.js"></script><script src="libs/highcharts-8.1.2/modules/heatmap.js"></script><script src="libs/highcharts-8.1.2/modules/treemap.js"></script><script src="libs/highcharts-8.1.2/modules/sankey.js"></script><script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script><script src="libs/highcharts-8.1.2/modules/organization.js"></script><script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script><script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script><script src="libs/highcharts-8.1.2/modules/sunburst.js"></script><script src="libs/highcharts-8.1.2/modules/vector.js"></script><script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script><script src="libs/highcharts-8.1.2/modules/xrange.js"></script><script src="libs/highcharts-8.1.2/modules/tilemap.js"></script><script src="libs/highcharts-8.1.2/modules/venn.js"></script><script src="libs/highcharts-8.1.2/modules/gantt.js"></script><script src="libs/highcharts-8.1.2/modules/timeline.js"></script><script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script><script src="libs/highcharts-8.1.2/modules/bullet.js"></script><script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script><script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script><script src="libs/highcharts-8.1.2/modules/lollipop.js"></script><script src="libs/highcharts-8.1.2/modules/series-label.js"></script><script src="libs/highcharts-8.1.2/plugins/motion.js"></script><script src="libs/highcharts-8.1.2/custom/reset.js"></script><script src="libs/highcharts-8.1.2/modules/boost.js"></script><script src="libs/highchart-binding-0.8.2/highchart.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">El manual de R para la Epidemiología</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Acerca de este libro</li>
<li><a class="" href="editorial-and-technical-notes.html"><span class="header-section-number">1</span> Notas editoriales y técnicas</a></li>
<li><a class="" href="download-handbook-and-data.html"><span class="header-section-number">2</span> Descargando el manual y los datos</a></li>
<li class="book-part">Aspectos básicos</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> Fundamentos de R</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transición a R</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">5</span> Paquetes recomendados</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> Proyectos en R</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">7</span> Importación y exportación</a></li>
<li class="book-part">Gestión de datos</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Limpieza de datos y funciones básicas</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with dates</a></li>
<li><a class="" href="characters-and-strings.html"><span class="header-section-number">10</span> Caracteres y cadenas</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">11</span> Factors</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">12</span> Pivoting data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">13</span> Grouping data</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">14</span> Joining data</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></li>
<li><a class="" href="iteration-loops-and-lists.html"><span class="header-section-number">16</span> Iteration, loops, and lists</a></li>
<li class="book-part">Análisis</li>
<li><a class="" href="descriptive-tables.html"><span class="header-section-number">17</span> Descriptive tables</a></li>
<li><a class="" href="simple-statistical-tests.html"><span class="header-section-number">18</span> Simple statistical tests</a></li>
<li><a class="" href="univariate-and-multivariable-regression.html"><span class="header-section-number">19</span> Univariate and multivariable regression</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Missing data</a></li>
<li><a class="" href="standardised-rates.html"><span class="header-section-number">21</span> Standardised rates</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">22</span> Moving averages</a></li>
<li><a class="" href="time-series-and-outbreak-detection.html"><span class="header-section-number">23</span> Time series and outbreak detection</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">24</span> Epidemic modeling</a></li>
<li><a class="" href="contact-tracing.html"><span class="header-section-number">25</span> Contact tracing</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">26</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">27</span> Survival analysis</a></li>
<li class="book-part">Visualización de datos</li>
<li><a class="" href="tables-for-presentation.html"><span class="header-section-number">28</span> Tables for presentation</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">29</span> Conceptos básicos de ggplot</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">30</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">31</span> Epidemic curves</a></li>
<li><a class="" href="demographic-pyramids-and-likert-scales.html"><span class="header-section-number">32</span> Demographic pyramids and Likert-scales</a></li>
<li><a class="" href="heat-plots.html"><span class="header-section-number">33</span> Heat plots</a></li>
<li><a class="" href="diagrams-and-charts.html"><span class="header-section-number">34</span> Diagrams and charts</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">35</span> Combinations analysis</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">36</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees-1.html"><span class="header-section-number">37</span> Árboles filogenéticos</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">38</span> Gráficos interactivos</a></li>
<li class="book-part">Informes y Dashboards</li>
<li><a class="active" href="organizing-routine-reports.html"><span class="header-section-number">39</span> Borrador. Organización de informes rutinarios</a></li>
<li><a class="" href="dashboards-with-r-markdown.html"><span class="header-section-number">40</span> Dashboards with R Markdown</a></li>
<li><a class="" href="dashboards-with-shiny.html"><span class="header-section-number">41</span> Dashboards with Shiny</a></li>
<li class="book-part">Miscelánea</li>
<li><a class="" href="writing-functions-1.html"><span class="header-section-number">42</span> Writing functions</a></li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">43</span> Directory interactions</a></li>
<li><a class="" href="version-control-and-collaboration-with-git-and-github.html"><span class="header-section-number">44</span> Control de versiones y colaboración con Git y Github</a></li>
<li><a class="" href="common-errors.html"><span class="header-section-number">45</span> Common errors</a></li>
<li><a class="" href="getting-help.html"><span class="header-section-number">46</span> Getting help</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">47</span> R on network drives</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">48</span> Data Table</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="organizing-routine-reports" class="section level1" number="39">
<h1>
<span class="header-section-number">39</span> Borrador. Organización de informes rutinarios<a class="anchor" aria-label="anchor" href="#organizing-routine-reports"><i class="fas fa-link"></i></a>
</h1>
<p><span style="color: red;"><strong><em>ADVERTENCIA:</em></strong> Esta traducción es sólo un borrador de la traducción al español. Este documento tal cual está ha sido generado automáticamente con DeepL.com y se han hecho algunas correcciones globales. Está pendiente de una revisión completa. </span></p>
<p>Esta página cubre el paquete <strong>reportfactory</strong>, que es un <em>complemento para el uso de R Markdown para los informes</em>.</p>
<p>En situaciones en las que se ejecutan reportes de forma rutinaria (diariamente, semanalmente, etc.), facilita la compilación de múltiples archivos R Markdown y la organización de sus resultados. En esencia, proporciona una “fábrica” desde la que se pueden ejecutar los informes R Markdown, obtener automáticamente carpetas con fecha y hora para los resultados, y tener un control de versiones “ligero”.</p>
<p><strong>reportfactory</strong> es uno de los paquetes desarrollados por RECON (R Epidemics Consortium). Aquí está su <a href="https://www.repidemicsconsortium.org/">sitio web</a> y <a href="https://github.com/reconverse">Github</a>.</p>
<div id="preparation-31" class="section level2" number="39.1">
<h2>
<span class="header-section-number">39.1</span> Preparación<a class="anchor" aria-label="anchor" href="#preparation-31"><i class="fas fa-link"></i></a>
</h2>
<div id="load-packages-25" class="section level3" number="39.1.1">
<h3>
<span class="header-section-number">39.1.1</span> Cargar paquetes<a class="anchor" aria-label="anchor" href="#load-packages-25"><i class="fas fa-link"></i></a>
</h3>
<p>Desde RStudio, instala la última versión del paquete <strong>reportfactory</strong> desde Github.</p>
<p>Puedes hacerlo a través del paquete <strong>pacman</strong> con p_load_current_gh() que forzará la instalación de la última versión desde Github. Proporcione la cadena de caracteres “reconverse/reportfactory”, que especifica la organización de Github (reconverse) y el repositorio (reportfactory). También puede utilizar <code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github()</a></code> del paquete <strong>remotes</strong>, como alternativa.</p>
<div class="sourceCode" id="cb1763"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Install and load the latest version of the package from Github</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load_current_gh.html">p_load_current_gh</a></span><span class="op">(</span><span class="st">"reconverse/reportfactory"</span><span class="op">)</span>
<span class="co">#remotes::install_github("reconverse/reportfactory") # alternative</span></code></pre></div>
</div>
</div>
<div id="new-factory" class="section level2" number="39.2">
<h2>
<span class="header-section-number">39.2</span> New factory<a class="anchor" aria-label="anchor" href="#new-factory"><i class="fas fa-link"></i></a>
</h2>
<p>Para crear una nueva fábrica, ejecuta la función <code>new_factory()</code>. Esto creará una nueva carpeta de proyecto R autocontenida. Por defecto:</p>
<ul>
<li>La fábrica se añadirá a tu directorio de trabajo</li>
<li>El nombre del proyecto R de la fábrica se llamará “nueva_fábrica.Rproj”</li>
<li>Tu sesión de RStudio se “trasladará” a este proyecto R</li>
</ul>
<div class="sourceCode" id="cb1764"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This will create the factory in the working directory</span>
<span class="fu">new_factory</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Mirando dentro de la fábrica, se puede ver que las subcarpetas y algunos archivos se crearon automáticamente.</p>
<div class="inline-figure"><img src="images/factory_new2.png" width="424"></div>
<ul>
<li>La carpeta <em>report_sources</em> contendrá sus scripts R Markdown, que generan sus informes</li>
<li>La carpeta de <em>resultas</em> contendrá los resultados del informe (por ejemplo, HTML, Word, PDF, etc.)</li>
<li>La carpeta de <em>scripts</em> puede utilizarse para almacenar otros scripts de R (por ejemplo, los que se originan en sus scripts de Rmd)</li>
<li>La carpeta de <em>data</em> puede utilizarse para guardar sus datos (se incluyen las subcarpetas “raw” y “clean”)</li>
<li>Un archivo <em>.here</em>, para que puedas utilizar el paquete <strong>here</strong> para llamar a los archivos de las subcarpetas por su relación con esta carpeta raíz (véase la página de <a href="r-projects.html#r-projects">proyectos de R</a> para más detalles)</li>
<li>Se ha creado un archivo <em>gitignore</em> en caso de que se vincule este proyecto R a un repositorio de Github (ver [Control de versiones y colaboración con Github])</li>
<li>Un archivo README vacío, para si usas un repositorio de Github</li>
</ul>
<p><span style="color: orange;"><strong><em>ATENCIÓN::</em></strong> dependiendo de la configuración de tu ordenador, los archivos como “.here” pueden existir pero estar ocultos.</span></p>
<p>De los ajustes por defecto, a continuación hay varios que puede querer ajustar dentro del comando <code>new_factory()</code>:</p>
<ul>
<li>
<code>factory =</code> - Proporcionar un nombre para la carpeta de fábrica (por defecto es “new_factory”)</li>
<li>
<code>path =</code> - Designa una ruta de archivo para la nueva fábrica (por defecto es el directorio de trabajo)</li>
<li>
<code>report_sources =</code> Proporcione un nombre alternativo para la subcarpeta que contiene los scripts R Markdown (por defecto es “report_sources”)</li>
<li>
<code>outputs =</code> Proporcione un nombre alternativo para la carpeta que contiene los resultados del informe (por defecto es “outputs”)</li>
</ul>
<p>Véase ?new_factory para una lista completa de los argumentos.</p>
<p>Cuando se crea la nueva fábrica, tu sesión de R se transfiere al nuevo proyecto R, por lo que debes cargar de nuevo el paquete <strong>reportfactory</strong>.</p>
<div class="sourceCode" id="cb1765"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">reportfactory</span><span class="op">)</span></code></pre></div>
<p>Ahora puede ejecutar el comando <code>factory_overview()</code> para ver la estructura interna (todas las carpetas y archivos) de la fábrica.</p>
<div class="sourceCode" id="cb1766"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">factory_overview</span><span class="op">(</span><span class="op">)</span>            <span class="co"># print overview of the factory to console</span></code></pre></div>
<p>El siguiente “árbol” de las carpetas y archivos de la fábrica se imprime en la consola de R. Observe que en la carpeta “data” hay subcarpetas para los datos “raw” y “clean”, y datos CSV de ejemplo. También hay “example_report.Rmd” en la carpeta “report_sources”.</p>
<div class="inline-figure"><img src="images/factory_overview.png" width="202"></div>
</div>
<div id="create-a-report" class="section level2" number="39.3">
<h2>
<span class="header-section-number">39.3</span> Crear un informe<a class="anchor" aria-label="anchor" href="#create-a-report"><i class="fas fa-link"></i></a>
</h2>
<p>Desde la fábrica del proyecto R, crea un informe R Markdown como lo haría normalmente, y guárdalo en la carpeta “report_sources”. Consulta la página de <a href="reports-with-r-markdown">R Markdown</a> para obtener instrucciones. A modo de ejemplo, hemos añadido lo siguiente a la fábrica:</p>
<ul>
<li>Un nuevo script de R markdown titulado “daily_sitrep.Rmd”, guardado dentro de la carpeta “report_sources”.</li>
<li>Datos para el informe (“linelist_cleaned.rds”), guardados en la subcarpeta “clean” dentro de la carpeta “data”</li>
</ul>
<p>Podemos ver usando factory_overview() nuestro R Markdown en la carpeta “report_sources” y el archivo de datos en la carpeta de datos “clean” (resaltado):</p>
<div class="inline-figure"><img src="images/factory_overview2.png" width="149"></div>
<p>A continuación se muestra una captura de pantalla del comienzo del R Markdown “daily_sitrep.Rmd”. Puedes ver que el formato de salida está configurado para ser HTML, a través de la cabecera YAML <code>output: html_document</code>.</p>
<div class="inline-figure"><img src="images/factory_new_rmd.png" width="420"></div>
<p>En este sencillo script, hay comandos para:</p>
<ul>
<li>Cargar los paquetes necesarios</li>
<li>Importe los datos del listado utilizando una ruta de archivo del paquete <strong>aquí</strong> (lea más en la página sobre <a href="import-and-export.html#import-and-export">importación y exportación</a>)</li>
</ul>
<div class="sourceCode" id="cb1767"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"clean"</span>, <span class="st">"linelist_cleaned.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<ul>
<li>Imprime una tabla resumen de los casos, y la exporta con <code><a href="https://rdrr.io/pkg/plotly/man/export.html">export()</a></code> como un archivo .csv</li>
<li>Imprimir una epicurva, y exportarla con <code>ggsave()</code> como un archivo .png</li>
</ul>
<p>Puedes revisar sólo la lista de informes R Markdown en la carpeta “report_sources” con este comando:</p>
<div class="sourceCode" id="cb1768"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">list_reports</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="compile" class="section level2" number="39.4">
<h2>
<span class="header-section-number">39.4</span> Compilar<a class="anchor" aria-label="anchor" href="#compile"><i class="fas fa-link"></i></a>
</h2>
<p>En una fábrica de informes, “compilar” un informe R Markdown significa que se ejecutará el script .Rmd y se producirá la salida (como se especifica en el script YAML, por ejemplo, como HTML, Word, PDF, etc.).</p>
<p><em>La fábrica creará automáticamente una carpeta con fecha y hora para las salidas en la carpeta “outputs”.</em></p>
<p>El propio informe y cualquier archivo exportado producido por el script (por ejemplo, csv, png, xlsx) se guardarán en esta carpeta. Además, el propio script Rmd se guardará en esta carpeta, para que tenga un registro de esa versión del script.</p>
<p>Esto contrasta con el comportamiento normal de un R Markdown “tejido”, que guarda las salidas en la ubicación del script Rmd. Este comportamiento por defecto puede resultar en carpetas abarrotadas y desordenadas. El objetivo de la fábrica es mejorar la organización cuando uno necesita ejecutar informes con frecuencia.</p>
<div id="compile-by-name" class="section level3" number="39.4.1">
<h3>
<span class="header-section-number">39.4.1</span> Compilar por nombre<a class="anchor" aria-label="anchor" href="#compile-by-name"><i class="fas fa-link"></i></a>
</h3>
<p>Puedes compilar un informe específico ejecutando <code>compile_reports()</code> y proporcionando el nombre del script Rmd (sin la extensión .Rmd) a <code>reports =</code>. Para simplificar, puede omitir <code>reports =</code> y simplemente escribir el nombre R Markdown entre comillas, como se indica a continuación.</p>
<div class="inline-figure"><img src="images/factory_compile1.png" width="271"></div>
<p>Este comando compilaría sólo el informe “daily_sitrep.Rmd”, guardando el informe HTML, y las exportaciones de la tabla .csv y la epicurva .png en una subcarpeta con fecha y hora específicas del informe, dentro de la carpeta “outputs”.</p>
<p>Ten en cuenta que si elige proporcionar la extensión .Rmd, debe escribir correctamente la extensión tal y como se guarda en el nombre del archivo (.rmd vs. .Rmd).</p>
<p>Ten en cuenta también que, al compilar, es posible que aparezcan temporalmente varios archivos en la carpeta “report_sources”, pero pronto desaparecerán al ser transferidos a la carpeta “outputs” correcta.</p>
</div>
<div id="compile-by-number" class="section level3" number="39.4.2">
<h3>
<span class="header-section-number">39.4.2</span> Compilación por número<a class="anchor" aria-label="anchor" href="#compile-by-number"><i class="fas fa-link"></i></a>
</h3>
<p>También puede especificar el script Rmd a compilar proporcionando un número o vector de números a <code>reports =</code>. Los números deben alinearse con el orden en que aparecen los informes cuando se ejecuta <code>list_reports()</code>.</p>
<div class="sourceCode" id="cb1769"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compile the second and fourth Rmds in the "report_sources" folder</span>
<span class="fu">compile_reports</span><span class="op">(</span>reports <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="compile-all" class="section level3" number="39.4.3">
<h3>
<span class="header-section-number">39.4.3</span> Compilar todos<a class="anchor" aria-label="anchor" href="#compile-all"><i class="fas fa-link"></i></a>
</h3>
<p>Puedes compilar <em>todos</em> los informes R Markdown en la carpeta “report_sources” estableciendo el argumento <code>reports =</code>a TRUE.</p>
<div class="inline-figure"><img src="images/factory_compile_all.png" width="268"></div>
</div>
<div id="compile-from-sub-folder" class="section level3" number="39.4.4">
<h3>
<span class="header-section-number">39.4.4</span> Compilar desde la subcarpeta<a class="anchor" aria-label="anchor" href="#compile-from-sub-folder"><i class="fas fa-link"></i></a>
</h3>
<p>Puedes añadir subcarpetas a la carpeta “report_sources”. Para ejecutar un informe R Markdown desde una subcarpeta, simplemente proporcione el nombre de la carpeta a <code>subfolder =</code>. A continuación se muestra un ejemplo de código para compilar un informe Rmd que vive en una subcarpeta de “report_sources”.</p>
<div class="sourceCode" id="cb1770"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">compile_reports</span><span class="op">(</span>
     reports <span class="op">=</span> <span class="st">"summary_for_partners.Rmd"</span>,
     subfolder <span class="op">=</span> <span class="st">"for_partners"</span><span class="op">)</span></code></pre></div>
<p>Puedes compilar todos los informes Rmd dentro de una subcarpeta proporcionando el nombre de la subcarpeta a <code>reports =</code>, con una barra al final, como se indica a continuación.</p>
<div class="sourceCode" id="cb1771"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">compile_reports</span><span class="op">(</span>reports <span class="op">=</span> <span class="st">"for_partners/"</span><span class="op">)</span></code></pre></div>
</div>
<div id="parameterization" class="section level3" number="39.4.5">
<h3>
<span class="header-section-number">39.4.5</span> Parametrización<a class="anchor" aria-label="anchor" href="#parameterization"><i class="fas fa-link"></i></a>
</h3>
<p>Como se indicó en la página sobre <a href="#reports-with-r-markdown">Informes con R Markdown</a>, puede ejecutar informes con parámetros especificados. Puedes pasar estos parámetros como una lista a <code>compile_reports()</code> a través del argumento <code>params =</code>. Por ejemplo, en este informe ficticio hay tres parámetros proporcionados a los informes de R Markdown.</p>
<div class="sourceCode" id="cb1772"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">compile_reports</span><span class="op">(</span>
  reports <span class="op">=</span> <span class="st">"daily_sitrep.Rmd"</span>,
  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>most_recent_data <span class="op">=</span> <span class="cn">TRUE</span>,
                region <span class="op">=</span> <span class="st">"NORTHERN"</span>,
                rates_denominator <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span>,
  subfolder <span class="op">=</span> <span class="st">"regional"</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="using-a-run-file" class="section level3" number="39.4.6">
<h3>
<span class="header-section-number">39.4.6</span> Utilizar un “run-file”<a class="anchor" aria-label="anchor" href="#using-a-run-file"><i class="fas fa-link"></i></a>
</h3>
<p>Si tienes varios informes que ejecutar, considera la posibilidad de crear un script de R que contenga todos los comandos <code>compile_reports()</code>. Un usuario puede simplemente ejecutar todos los comandos en este script de R y todos los informes se compilarán. Puedes guardar este “archivo de ejecución” en la carpeta “scripts”.</p>
</div>
</div>
<div id="outputs-1" class="section level2" number="39.5">
<h2>
<span class="header-section-number">39.5</span> Salidas<a class="anchor" aria-label="anchor" href="#outputs-1"><i class="fas fa-link"></i></a>
</h2>
<p>Después de haber compilado los informes unas cuantas veces, la carpeta “outputs” podría tener este aspecto (los resaltados se han añadido para mayor claridad):</p>
<div class="inline-figure"><img src="images/factory_overview_all.png" width="350"></div>
<ul>
<li>Dentro de “outputs”, se han creado subcarpetas para cada informe Rmd</li>
<li>Dentro de ellas, se han creado otras subcarpetas para cada compilación única
<ul>
<li>Están marcados con fecha y hora (“2021-04-23_T11-07-36” significa 23 de abril de 2021 a las 11:07:36)</li>
<li>Puedes editar el formato de la fecha/hora. Ver <code>?compile_reports</code>
</li>
</ul>
</li>
<li>Dentro de cada carpeta compilada de fecha/hora, se almacena el resultado del informe (por ejemplo, HTML, PDF, Word) junto con el script Rmd (¡control de versiones!) y cualquier otro archivo exportado (por ejemplo, table.csv, epidemic_curve.png)</li>
</ul>
<p>Esta es una vista dentro de una de las carpetas con fecha/hora, para el informe “daily_sitrep”. La ruta del archivo está resaltada en amarillo para enfatizar.</p>
<div class="inline-figure"><img src="images/factory_compile_folder.png" width="435"></div>
<p>Por último, a continuación se muestra una captura de pantalla de la salida del informe HTML.</p>
<div class="inline-figure"><img src="images/factory_html.png" width="452"></div>
<p>Puedes utilizar <code>list_outputs()</code> para revisar una lista de las salidas.</p>
</div>
<div id="miscellaneous-1" class="section level2" number="39.6">
<h2>
<span class="header-section-number">39.6</span> Miscelánea<a class="anchor" aria-label="anchor" href="#miscellaneous-1"><i class="fas fa-link"></i></a>
</h2>
<div id="knit" class="section level3" number="39.6.1">
<h3>
<span class="header-section-number">39.6.1</span> Knit<a class="anchor" aria-label="anchor" href="#knit"><i class="fas fa-link"></i></a>
</h3>
<p>Si lo deseas, puedes “procesar” uno de tus informes R Markdown clicando el botón “Knit”. Si haces esto, como por defecto, las salidas aparecerán en la carpeta donde se guarda el Rmd - la carpeta “report_sources”. En versiones anteriores de <strong>reportfactory</strong>, tener cualquier archivo que no sea Rmd en “report_sources” impediría la compilación, pero esto ya no es así. Puedes ejecutar <code>compile_reports()</code> y no se producirá ningún error.</p>
</div>
<div id="scripts-2" class="section level3" number="39.6.2">
<h3>
<span class="header-section-number">39.6.2</span> Scripts<a class="anchor" aria-label="anchor" href="#scripts-2"><i class="fas fa-link"></i></a>
</h3>
<p>Te animamos a utilizar la carpeta “scripts” para almacenar “archivos de ejecución” o scripts .R que se originan en tus scripts .Rmd. Consulta la página sobre <a href="#reports-with-r-markdown">R Markdown</a> para obtener consejos sobre cómo estructurar tu código en varios archivos.</p>
</div>
<div id="extras" class="section level3" number="39.6.3">
<h3>
<span class="header-section-number">39.6.3</span> Extras<a class="anchor" aria-label="anchor" href="#extras"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Con <strong>reportfactory</strong>, puede utilizar la función <code>list_deps()</code> para listar todos los paquetes requeridos en todos los informes de toda la fábrica.</p></li>
<li>
<p>Hay un paquete de acompañamiento en desarrollo llamado <strong>rfextras</strong> que ofrece más funciones de ayuda para asistirle en la construcción de informes, tales como:</p>
<ul>
<li>
<code>load_scripts()</code> - carga todos los scripts .R en una carpeta determinada (la carpeta “scripts” por defecto)</li>
<li>
<code>find_latest()</code>- encuentra la última versión de un archivo (por ejemplo, el último conjunto de datos)</li>
</ul>
</li>
</ul>
<!-- ======================================================= -->
</div>
</div>
<div id="resources-30" class="section level2" number="39.7">
<h2>
<span class="header-section-number">39.7</span> Recursos<a class="anchor" aria-label="anchor" href="#resources-30"><i class="fas fa-link"></i></a>
</h2>
<p>Consulta la <a href="https://github.com/reconverse/reportfactory">página de Github del paquete <strong>reportfactory</strong></a></p>
<p>Consulta la <a href="https://github.com/reconhub/rfextras">página de Github del paquete <strong>rfextras</strong></a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="interactive-plots.html"><span class="header-section-number">38</span> Gráficos interactivos</a></div>
<div class="next"><a href="dashboards-with-r-markdown.html"><span class="header-section-number">40</span> Dashboards with R Markdown</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#organizing-routine-reports"><span class="header-section-number">39</span> Borrador. Organización de informes rutinarios</a></li>
<li>
<a class="nav-link" href="#preparation-31"><span class="header-section-number">39.1</span> Preparación</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#load-packages-25"><span class="header-section-number">39.1.1</span> Cargar paquetes</a></li></ul>
</li>
<li><a class="nav-link" href="#new-factory"><span class="header-section-number">39.2</span> New factory</a></li>
<li><a class="nav-link" href="#create-a-report"><span class="header-section-number">39.3</span> Crear un informe</a></li>
<li>
<a class="nav-link" href="#compile"><span class="header-section-number">39.4</span> Compilar</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#compile-by-name"><span class="header-section-number">39.4.1</span> Compilar por nombre</a></li>
<li><a class="nav-link" href="#compile-by-number"><span class="header-section-number">39.4.2</span> Compilación por número</a></li>
<li><a class="nav-link" href="#compile-all"><span class="header-section-number">39.4.3</span> Compilar todos</a></li>
<li><a class="nav-link" href="#compile-from-sub-folder"><span class="header-section-number">39.4.4</span> Compilar desde la subcarpeta</a></li>
<li><a class="nav-link" href="#parameterization"><span class="header-section-number">39.4.5</span> Parametrización</a></li>
<li><a class="nav-link" href="#using-a-run-file"><span class="header-section-number">39.4.6</span> Utilizar un “run-file”</a></li>
</ul>
</li>
<li><a class="nav-link" href="#outputs-1"><span class="header-section-number">39.5</span> Salidas</a></li>
<li>
<a class="nav-link" href="#miscellaneous-1"><span class="header-section-number">39.6</span> Miscelánea</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#knit"><span class="header-section-number">39.6.1</span> Knit</a></li>
<li><a class="nav-link" href="#scripts-2"><span class="header-section-number">39.6.2</span> Scripts</a></li>
<li><a class="nav-link" href="#extras"><span class="header-section-number">39.6.3</span> Extras</a></li>
</ul>
</li>
<li><a class="nav-link" href="#resources-30"><span class="header-section-number">39.7</span> Recursos</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>El manual de R para la Epidemiología</strong>" was written by El equipo del manual. It was last built on 2021-11-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
