<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>38 Gráficos interactivos | El manual de R para la Epidemiología</title>
<meta name="author" content="El equipo del manual">
<meta name="description" content="Últimamente es cada vez más común la necesidad de que la visualización de datos sea interactiva para el público. Por ello, es cada vez más habitual la realización de gráficos interactivos. Hay...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="38 Gráficos interactivos | El manual de R para la Epidemiología">
<meta property="og:type" content="book">
<meta property="og:description" content="Últimamente es cada vez más común la necesidad de que la visualización de datos sea interactiva para el público. Por ello, es cada vez más habitual la realización de gráficos interactivos. Hay...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="38 Gráficos interactivos | El manual de R para la Epidemiología">
<meta name="twitter:description" content="Últimamente es cada vez más común la necesidad de que la visualización de datos sea interactiva para el público. Por ello, es cada vez más habitual la realización de gráficos interactivos. Hay...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.18/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.4.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-8.1.2/highcharts.js"></script><script src="libs/highcharts-8.1.2/highcharts-3d.js"></script><script src="libs/highcharts-8.1.2/highcharts-more.js"></script><script src="libs/highcharts-8.1.2/modules/stock.js"></script><script src="libs/highcharts-8.1.2/modules/map.js"></script><script src="libs/highcharts-8.1.2/modules/annotations.js"></script><script src="libs/highcharts-8.1.2/modules/data.js"></script><script src="libs/highcharts-8.1.2/modules/drilldown.js"></script><script src="libs/highcharts-8.1.2/modules/item-series.js"></script><script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script><script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-8.1.2/modules/exporting.js"></script><script src="libs/highcharts-8.1.2/modules/export-data.js"></script><script src="libs/highcharts-8.1.2/modules/funnel.js"></script><script src="libs/highcharts-8.1.2/modules/heatmap.js"></script><script src="libs/highcharts-8.1.2/modules/treemap.js"></script><script src="libs/highcharts-8.1.2/modules/sankey.js"></script><script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script><script src="libs/highcharts-8.1.2/modules/organization.js"></script><script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script><script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script><script src="libs/highcharts-8.1.2/modules/sunburst.js"></script><script src="libs/highcharts-8.1.2/modules/vector.js"></script><script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script><script src="libs/highcharts-8.1.2/modules/xrange.js"></script><script src="libs/highcharts-8.1.2/modules/tilemap.js"></script><script src="libs/highcharts-8.1.2/modules/venn.js"></script><script src="libs/highcharts-8.1.2/modules/gantt.js"></script><script src="libs/highcharts-8.1.2/modules/timeline.js"></script><script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script><script src="libs/highcharts-8.1.2/modules/bullet.js"></script><script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script><script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script><script src="libs/highcharts-8.1.2/modules/lollipop.js"></script><script src="libs/highcharts-8.1.2/modules/series-label.js"></script><script src="libs/highcharts-8.1.2/plugins/motion.js"></script><script src="libs/highcharts-8.1.2/custom/reset.js"></script><script src="libs/highcharts-8.1.2/modules/boost.js"></script><script src="libs/highchart-binding-0.8.2/highchart.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">El manual de R para la Epidemiología</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Acerca de este libro</li>
<li><a class="" href="editorial-and-technical-notes.html"><span class="header-section-number">1</span> Notas editoriales y técnicas</a></li>
<li><a class="" href="download-handbook-and-data.html"><span class="header-section-number">2</span> Descargando el manual y los datos</a></li>
<li class="book-part">Aspectos básicos</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> Fundamentos de R</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transición a R</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">5</span> Paquetes recomendados</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> Proyectos en R</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">7</span> Importación y exportación</a></li>
<li class="book-part">Gestión de datos</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Limpieza de datos y funciones básicas</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with dates</a></li>
<li><a class="" href="characters-and-strings.html"><span class="header-section-number">10</span> Caracteres y cadenas</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">11</span> Factors</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">12</span> Pivoting data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">13</span> Grouping data</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">14</span> Joining data</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></li>
<li><a class="" href="iteration-loops-and-lists.html"><span class="header-section-number">16</span> Iteration, loops, and lists</a></li>
<li class="book-part">Análisis</li>
<li><a class="" href="descriptive-tables.html"><span class="header-section-number">17</span> Descriptive tables</a></li>
<li><a class="" href="simple-statistical-tests.html"><span class="header-section-number">18</span> Simple statistical tests</a></li>
<li><a class="" href="univariate-and-multivariable-regression.html"><span class="header-section-number">19</span> Univariate and multivariable regression</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Missing data</a></li>
<li><a class="" href="standardised-rates.html"><span class="header-section-number">21</span> Standardised rates</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">22</span> Moving averages</a></li>
<li><a class="" href="time-series-and-outbreak-detection.html"><span class="header-section-number">23</span> Time series and outbreak detection</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">24</span> Epidemic modeling</a></li>
<li><a class="" href="contact-tracing.html"><span class="header-section-number">25</span> Contact tracing</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">26</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">27</span> Survival analysis</a></li>
<li class="book-part">Visualización de datos</li>
<li><a class="" href="tables-for-presentation.html"><span class="header-section-number">28</span> Tables for presentation</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">29</span> Conceptos básicos de ggplot</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">30</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">31</span> Epidemic curves</a></li>
<li><a class="" href="demographic-pyramids-and-likert-scales.html"><span class="header-section-number">32</span> Demographic pyramids and Likert-scales</a></li>
<li><a class="" href="heat-plots.html"><span class="header-section-number">33</span> Heat plots</a></li>
<li><a class="" href="diagrams-and-charts.html"><span class="header-section-number">34</span> Diagrams and charts</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">35</span> Combinations analysis</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">36</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees-1.html"><span class="header-section-number">37</span> Árboles filogenéticos</a></li>
<li><a class="active" href="interactive-plots.html"><span class="header-section-number">38</span> Gráficos interactivos</a></li>
<li class="book-part">Informes y Dashboards</li>
<li><a class="" href="organizing-routine-reports.html"><span class="header-section-number">39</span> Borrador. Organización de informes rutinarios</a></li>
<li><a class="" href="dashboards-with-r-markdown.html"><span class="header-section-number">40</span> Dashboards with R Markdown</a></li>
<li><a class="" href="dashboards-with-shiny.html"><span class="header-section-number">41</span> Dashboards with Shiny</a></li>
<li class="book-part">Miscelánea</li>
<li><a class="" href="writing-functions-1.html"><span class="header-section-number">42</span> Writing functions</a></li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">43</span> Directory interactions</a></li>
<li><a class="" href="version-control-and-collaboration-with-git-and-github.html"><span class="header-section-number">44</span> Control de versiones y colaboración con Git y Github</a></li>
<li><a class="" href="common-errors.html"><span class="header-section-number">45</span> Common errors</a></li>
<li><a class="" href="getting-help.html"><span class="header-section-number">46</span> Getting help</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">47</span> R on network drives</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">48</span> Data Table</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="interactive-plots" class="section level1" number="38">
<h1>
<span class="header-section-number">38</span> Gráficos interactivos<a class="anchor" aria-label="anchor" href="#interactive-plots"><i class="fas fa-link"></i></a>
</h1>
<p>Últimamente es cada vez más común la necesidad de que la visualización de datos sea interactiva para el público. Por ello, es cada vez más habitual la realización de gráficos interactivos. Hay varias formas de realizarlos, pero las dos más comunes son empleando <strong>plotly</strong> y <strong>shiny</strong>.</p>
<p>En esta página nos centraremos en como convertir un gráfico <code>ggplot()</code> existente en un gráfico interactivo con <strong>plotly</strong>. Puedes leer más sobre <strong>shiny</strong> en la página <a href="dashboards-with-shiny.html#dashboards-with-shiny">Dashboards with Shiny</a>. Antes de comenzar, merece la pena mencionar que los gráficos interactivos sólo se pueden utilizar en documentos R markdown en formato HTML, no en documentos PDF o Word.</p>
<p>A continuación se muestra una curva epidémica que se ha transformado en interactiva utilizando la integración de <strong>ggplot2</strong> y <strong>plotly</strong> (pasa el cursor por encima del gráfico, amplía la imagen o clica en los elementos de la leyenda para comprobarlo).</p>
<div id="htmlwidget-4161a15bafec57ee7d8b" style="width:75%;height:500px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4161a15bafec57ee7d8b">{"x":{"data":[{"orientation":"v","width":[6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.30000000000109,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291],"base":[3,8,13,13,14,5,11,17,23,16,27,31,41,37,50,58,78,110,118,157,149,188,167,149,139,136,136,129,87,84,72,75,78,64,70,65,55,55,58,49,40,42,38,62,35,32,36,32,26,25,15,20,16,5],"x":[16181,16188,16195,16202,16209,16216,16223,16230,16237,16244,16251,16258,16265,16272,16279,16286,16293,16300,16307,16314,16321,16328,16335,16342,16349,16356,16363,16370,16377,16384,16391,16398,16405,16412,16419,16426,16433,16440,16447,16454,16461,16468,16475,16482,16489,16496,16503,16510,16517,16524,16531,16538,16545,16552],"y":[3,2,3,5,7,12,14,14,10,11,13,15,26,36,37,46,67,68,57,101,121,138,130,121,138,112,113,102,82,82,83,66,59,40,47,57,31,44,51,37,36,28,32,43,33,30,21,29,29,21,14,13,11,3],"text":["week_earliest: 2014-04-21<br />n:   3<br />outcome: Death","week_earliest: 2014-04-28<br />n:   2<br />outcome: Death","week_earliest: 2014-05-05<br />n:   3<br />outcome: Death","week_earliest: 2014-05-12<br />n:   5<br />outcome: Death","week_earliest: 2014-05-19<br />n:   7<br />outcome: Death","week_earliest: 2014-05-26<br />n:  12<br />outcome: Death","week_earliest: 2014-06-02<br />n:  14<br />outcome: Death","week_earliest: 2014-06-09<br />n:  14<br />outcome: Death","week_earliest: 2014-06-16<br />n:  10<br />outcome: Death","week_earliest: 2014-06-23<br />n:  11<br />outcome: Death","week_earliest: 2014-06-30<br />n:  13<br />outcome: Death","week_earliest: 2014-07-07<br />n:  15<br />outcome: Death","week_earliest: 2014-07-14<br />n:  26<br />outcome: Death","week_earliest: 2014-07-21<br />n:  36<br />outcome: Death","week_earliest: 2014-07-28<br />n:  37<br />outcome: Death","week_earliest: 2014-08-04<br />n:  46<br />outcome: Death","week_earliest: 2014-08-11<br />n:  67<br />outcome: Death","week_earliest: 2014-08-18<br />n:  68<br />outcome: Death","week_earliest: 2014-08-25<br />n:  57<br />outcome: Death","week_earliest: 2014-09-01<br />n: 101<br />outcome: Death","week_earliest: 2014-09-08<br />n: 121<br />outcome: Death","week_earliest: 2014-09-15<br />n: 138<br />outcome: Death","week_earliest: 2014-09-22<br />n: 130<br />outcome: Death","week_earliest: 2014-09-29<br />n: 121<br />outcome: Death","week_earliest: 2014-10-06<br />n: 138<br />outcome: Death","week_earliest: 2014-10-13<br />n: 112<br />outcome: Death","week_earliest: 2014-10-20<br />n: 113<br />outcome: Death","week_earliest: 2014-10-27<br />n: 102<br />outcome: Death","week_earliest: 2014-11-03<br />n:  82<br />outcome: Death","week_earliest: 2014-11-10<br />n:  82<br />outcome: Death","week_earliest: 2014-11-17<br />n:  83<br />outcome: Death","week_earliest: 2014-11-24<br />n:  66<br />outcome: Death","week_earliest: 2014-12-01<br />n:  59<br />outcome: Death","week_earliest: 2014-12-08<br />n:  40<br />outcome: Death","week_earliest: 2014-12-15<br />n:  47<br />outcome: Death","week_earliest: 2014-12-22<br />n:  57<br />outcome: Death","week_earliest: 2014-12-29<br />n:  31<br />outcome: Death","week_earliest: 2015-01-05<br />n:  44<br />outcome: Death","week_earliest: 2015-01-12<br />n:  51<br />outcome: Death","week_earliest: 2015-01-19<br />n:  37<br />outcome: Death","week_earliest: 2015-01-26<br />n:  36<br />outcome: Death","week_earliest: 2015-02-02<br />n:  28<br />outcome: Death","week_earliest: 2015-02-09<br />n:  32<br />outcome: Death","week_earliest: 2015-02-16<br />n:  43<br />outcome: Death","week_earliest: 2015-02-23<br />n:  33<br />outcome: Death","week_earliest: 2015-03-02<br />n:  30<br />outcome: Death","week_earliest: 2015-03-09<br />n:  21<br />outcome: Death","week_earliest: 2015-03-16<br />n:  29<br />outcome: Death","week_earliest: 2015-03-23<br />n:  29<br />outcome: Death","week_earliest: 2015-03-30<br />n:  21<br />outcome: Death","week_earliest: 2015-04-06<br />n:  14<br />outcome: Death","week_earliest: 2015-04-13<br />n:  13<br />outcome: Death","week_earliest: 2015-04-20<br />n:  11<br />outcome: Death","week_earliest: 2015-04-27<br />n:   3<br />outcome: Death"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Death","legendgroup":"Death","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.30000000000109,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291],"base":[0,0,3,6,7,6,1,5,6,10,8,10,13,13,14,23,19,35,36,41,66,64,68,69,56,53,47,58,64,38,28,27,28,33,33,30,27,24,22,24,16,18,16,13,27,18,14,13,15,13,5,4,8,7,2],"x":[16174,16181,16188,16195,16202,16209,16216,16223,16230,16237,16244,16251,16258,16265,16272,16279,16286,16293,16300,16307,16314,16321,16328,16335,16342,16349,16356,16363,16370,16377,16384,16391,16398,16405,16412,16419,16426,16433,16440,16447,16454,16461,16468,16475,16482,16489,16496,16503,16510,16517,16524,16531,16538,16545,16552],"y":[1,3,5,7,6,8,4,6,11,13,8,17,18,28,23,27,39,43,74,77,91,85,120,98,93,86,89,78,65,49,56,45,47,45,31,40,38,31,33,34,33,22,26,25,35,17,18,23,17,13,20,11,12,9,3],"text":["week_earliest: 2014-04-14<br />n:   1<br />outcome: Recover","week_earliest: 2014-04-21<br />n:   3<br />outcome: Recover","week_earliest: 2014-04-28<br />n:   5<br />outcome: Recover","week_earliest: 2014-05-05<br />n:   7<br />outcome: Recover","week_earliest: 2014-05-12<br />n:   6<br />outcome: Recover","week_earliest: 2014-05-19<br />n:   8<br />outcome: Recover","week_earliest: 2014-05-26<br />n:   4<br />outcome: Recover","week_earliest: 2014-06-02<br />n:   6<br />outcome: Recover","week_earliest: 2014-06-09<br />n:  11<br />outcome: Recover","week_earliest: 2014-06-16<br />n:  13<br />outcome: Recover","week_earliest: 2014-06-23<br />n:   8<br />outcome: Recover","week_earliest: 2014-06-30<br />n:  17<br />outcome: Recover","week_earliest: 2014-07-07<br />n:  18<br />outcome: Recover","week_earliest: 2014-07-14<br />n:  28<br />outcome: Recover","week_earliest: 2014-07-21<br />n:  23<br />outcome: Recover","week_earliest: 2014-07-28<br />n:  27<br />outcome: Recover","week_earliest: 2014-08-04<br />n:  39<br />outcome: Recover","week_earliest: 2014-08-11<br />n:  43<br />outcome: Recover","week_earliest: 2014-08-18<br />n:  74<br />outcome: Recover","week_earliest: 2014-08-25<br />n:  77<br />outcome: Recover","week_earliest: 2014-09-01<br />n:  91<br />outcome: Recover","week_earliest: 2014-09-08<br />n:  85<br />outcome: Recover","week_earliest: 2014-09-15<br />n: 120<br />outcome: Recover","week_earliest: 2014-09-22<br />n:  98<br />outcome: Recover","week_earliest: 2014-09-29<br />n:  93<br />outcome: Recover","week_earliest: 2014-10-06<br />n:  86<br />outcome: Recover","week_earliest: 2014-10-13<br />n:  89<br />outcome: Recover","week_earliest: 2014-10-20<br />n:  78<br />outcome: Recover","week_earliest: 2014-10-27<br />n:  65<br />outcome: Recover","week_earliest: 2014-11-03<br />n:  49<br />outcome: Recover","week_earliest: 2014-11-10<br />n:  56<br />outcome: Recover","week_earliest: 2014-11-17<br />n:  45<br />outcome: Recover","week_earliest: 2014-11-24<br />n:  47<br />outcome: Recover","week_earliest: 2014-12-01<br />n:  45<br />outcome: Recover","week_earliest: 2014-12-08<br />n:  31<br />outcome: Recover","week_earliest: 2014-12-15<br />n:  40<br />outcome: Recover","week_earliest: 2014-12-22<br />n:  38<br />outcome: Recover","week_earliest: 2014-12-29<br />n:  31<br />outcome: Recover","week_earliest: 2015-01-05<br />n:  33<br />outcome: Recover","week_earliest: 2015-01-12<br />n:  34<br />outcome: Recover","week_earliest: 2015-01-19<br />n:  33<br />outcome: Recover","week_earliest: 2015-01-26<br />n:  22<br />outcome: Recover","week_earliest: 2015-02-02<br />n:  26<br />outcome: Recover","week_earliest: 2015-02-09<br />n:  25<br />outcome: Recover","week_earliest: 2015-02-16<br />n:  35<br />outcome: Recover","week_earliest: 2015-02-23<br />n:  17<br />outcome: Recover","week_earliest: 2015-03-02<br />n:  18<br />outcome: Recover","week_earliest: 2015-03-09<br />n:  23<br />outcome: Recover","week_earliest: 2015-03-16<br />n:  17<br />outcome: Recover","week_earliest: 2015-03-23<br />n:  13<br />outcome: Recover","week_earliest: 2015-03-30<br />n:  20<br />outcome: Recover","week_earliest: 2015-04-06<br />n:  11<br />outcome: Recover","week_earliest: 2015-04-13<br />n:  12<br />outcome: Recover","week_earliest: 2015-04-20<br />n:   9<br />outcome: Recover","week_earliest: 2015-04-27<br />n:   3<br />outcome: Recover"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Recover","legendgroup":"Recover","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.30000000000109,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[16146,16167,16188,16195,16202,16209,16216,16223,16230,16237,16244,16251,16258,16265,16272,16279,16286,16293,16300,16307,16314,16321,16328,16335,16342,16349,16356,16363,16370,16377,16384,16391,16398,16405,16412,16419,16426,16433,16440,16447,16454,16461,16468,16475,16482,16489,16496,16503,16510,16517,16524,16531,16538,16545,16552],"y":[1,2,3,6,7,6,1,5,6,10,8,10,13,13,14,23,19,35,36,41,66,64,68,69,56,53,47,58,64,38,28,27,28,33,33,30,27,24,22,24,16,18,16,13,27,18,14,13,15,13,5,4,8,7,2],"text":["week_earliest: 2014-03-17<br />n:   1<br />outcome: Unknown","week_earliest: 2014-04-07<br />n:   2<br />outcome: Unknown","week_earliest: 2014-04-28<br />n:   3<br />outcome: Unknown","week_earliest: 2014-05-05<br />n:   6<br />outcome: Unknown","week_earliest: 2014-05-12<br />n:   7<br />outcome: Unknown","week_earliest: 2014-05-19<br />n:   6<br />outcome: Unknown","week_earliest: 2014-05-26<br />n:   1<br />outcome: Unknown","week_earliest: 2014-06-02<br />n:   5<br />outcome: Unknown","week_earliest: 2014-06-09<br />n:   6<br />outcome: Unknown","week_earliest: 2014-06-16<br />n:  10<br />outcome: Unknown","week_earliest: 2014-06-23<br />n:   8<br />outcome: Unknown","week_earliest: 2014-06-30<br />n:  10<br />outcome: Unknown","week_earliest: 2014-07-07<br />n:  13<br />outcome: Unknown","week_earliest: 2014-07-14<br />n:  13<br />outcome: Unknown","week_earliest: 2014-07-21<br />n:  14<br />outcome: Unknown","week_earliest: 2014-07-28<br />n:  23<br />outcome: Unknown","week_earliest: 2014-08-04<br />n:  19<br />outcome: Unknown","week_earliest: 2014-08-11<br />n:  35<br />outcome: Unknown","week_earliest: 2014-08-18<br />n:  36<br />outcome: Unknown","week_earliest: 2014-08-25<br />n:  41<br />outcome: Unknown","week_earliest: 2014-09-01<br />n:  66<br />outcome: Unknown","week_earliest: 2014-09-08<br />n:  64<br />outcome: Unknown","week_earliest: 2014-09-15<br />n:  68<br />outcome: Unknown","week_earliest: 2014-09-22<br />n:  69<br />outcome: Unknown","week_earliest: 2014-09-29<br />n:  56<br />outcome: Unknown","week_earliest: 2014-10-06<br />n:  53<br />outcome: Unknown","week_earliest: 2014-10-13<br />n:  47<br />outcome: Unknown","week_earliest: 2014-10-20<br />n:  58<br />outcome: Unknown","week_earliest: 2014-10-27<br />n:  64<br />outcome: Unknown","week_earliest: 2014-11-03<br />n:  38<br />outcome: Unknown","week_earliest: 2014-11-10<br />n:  28<br />outcome: Unknown","week_earliest: 2014-11-17<br />n:  27<br />outcome: Unknown","week_earliest: 2014-11-24<br />n:  28<br />outcome: Unknown","week_earliest: 2014-12-01<br />n:  33<br />outcome: Unknown","week_earliest: 2014-12-08<br />n:  33<br />outcome: Unknown","week_earliest: 2014-12-15<br />n:  30<br />outcome: Unknown","week_earliest: 2014-12-22<br />n:  27<br />outcome: Unknown","week_earliest: 2014-12-29<br />n:  24<br />outcome: Unknown","week_earliest: 2015-01-05<br />n:  22<br />outcome: Unknown","week_earliest: 2015-01-12<br />n:  24<br />outcome: Unknown","week_earliest: 2015-01-19<br />n:  16<br />outcome: Unknown","week_earliest: 2015-01-26<br />n:  18<br />outcome: Unknown","week_earliest: 2015-02-02<br />n:  16<br />outcome: Unknown","week_earliest: 2015-02-09<br />n:  13<br />outcome: Unknown","week_earliest: 2015-02-16<br />n:  27<br />outcome: Unknown","week_earliest: 2015-02-23<br />n:  18<br />outcome: Unknown","week_earliest: 2015-03-02<br />n:  14<br />outcome: Unknown","week_earliest: 2015-03-09<br />n:  13<br />outcome: Unknown","week_earliest: 2015-03-16<br />n:  15<br />outcome: Unknown","week_earliest: 2015-03-23<br />n:  13<br />outcome: Unknown","week_earliest: 2015-03-30<br />n:   5<br />outcome: Unknown","week_earliest: 2015-04-06<br />n:   4<br />outcome: Unknown","week_earliest: 2015-04-13<br />n:   8<br />outcome: Unknown","week_earliest: 2015-04-20<br />n:   7<br />outcome: Unknown","week_earliest: 2015-04-27<br />n:   2<br />outcome: Unknown"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Unknown","legendgroup":"Unknown","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[16122.235,16575.765],"tickmode":"array","ticktext":["abr. 2014","jul. 2014","oct. 2014","ene. 2015","abr. 2015"],"tickvals":[16161,16252,16344,16436,16526],"categoryorder":"array","categoryarray":["abr. 2014","jul. 2014","oct. 2014","ene. 2015","abr. 2015"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Week of infection/onset","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-16.3,342.3],"tickmode":"array","ticktext":["0","100","200","300"],"tickvals":[0,100,200,300],"categoryorder":"array","categoryarray":["0","100","200","300"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Cases per week","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96751968503937},"annotations":[{"text":"outcome","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["zoom2d","pan2d","lasso2d","select2d","zoomIn2d","zoomOut2d","autoScale2d","hoverClosestCartesian","toggleSpikelines","hoverCompareCartesian"]},"source":"A","attrs":{"2ec5dd73b8":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"2ec5dd73b8","visdat":{"2ec5dd73b8":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><!-- ======================================================= --><div id="preparation-30" class="section level2" number="38.1">
<h2>
<span class="header-section-number">38.1</span> Preparación<a class="anchor" aria-label="anchor" href="#preparation-30"><i class="fas fa-link"></i></a>
</h2>
<div id="load-packages-26" class="section level3" number="38.1.1">
<h3>
<span class="header-section-number">38.1.1</span> Cargar paquetes<a class="anchor" aria-label="anchor" href="#load-packages-26"><i class="fas fa-link"></i></a>
</h3>
<p>Este trozo de código muestra la carga de los paquetes necesarios para los análisis. En este manual destacamos <code><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load()</a></code> de <strong>pacman</strong>, que instala el paquete si es necesario <em>y</em> lo carga para su uso. También puedes cargar los paquetes instalados con <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>. Consulta la página sobre <a href="r-basics.html#r-basics">los fundamentos de R</a> para obtener más información sobre los paquetes de R.</p>
<div class="sourceCode" id="cb1728"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span>
  <span class="va">rio</span>,       <span class="co"># importación/exportación</span>
  <span class="va">here</span>,      <span class="co"># rutas de archivos</span>
  <span class="va">lubridate</span>, <span class="co"># lubridate</span>
  <span class="va">plotly</span>,    <span class="co"># gráficos interactivos</span>
  <span class="va">scales</span>,    <span class="co"># porcentajes rápidos</span>
  <span class="va">tidyverse</span>  <span class="co"># gestión y visualización de datos</span>
  <span class="op">)</span> </code></pre></div>
</div>
<div id="start-with-a-ggplot" class="section level3" number="38.1.2">
<h3>
<span class="header-section-number">38.1.2</span> Comienza con un <code>ggplot()</code><a class="anchor" aria-label="anchor" href="#start-with-a-ggplot"><i class="fas fa-link"></i></a>
</h3>
<p>En esta página asumimos que comienzas con un gráfico <code>ggplot()</code> que deseas convertir en interactivo. Construiremos varios de estos gráficos en esta página, utilizando la base de datos <code>linelist</code>, la cual es ampliamente utilizada en este manual.</p>
</div>
<div id="import-data-24" class="section level3" number="38.1.3">
<h3>
<span class="header-section-number">38.1.3</span> Importar datos<a class="anchor" aria-label="anchor" href="#import-data-24"><i class="fas fa-link"></i></a>
</h3>
<p>Para empezar, importamos la lista de casos limpia de una epidemia de ébola simulada. Si quieres seguir el proceso, <a href="https://github.com/epirhandbook/Epi_R_handbook/raw/master/data/case_linelists/linelist_cleaned.rds">clica aquí para descargar el listado “limpio”</a> (como archivo .rds). Importae los datos con la función <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> del paquete <strong>rio</strong> (maneja muchos tipos de archivos como .xlsx, .csv, .rds - consulta la página de <a href="import-and-export.html#import-and-export">importación y exportación</a> para más detalles).</p>
<div class="sourceCode" id="cb1729"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Importar base de datos linelist </span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_cleaned.rds"</span><span class="op">)</span></code></pre></div>
<p>A continuación se muestran las primeras 50 filas de la base de datos.</p>
<div id="htmlwidget-0b0a4c26406f9de9f09e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0b0a4c26406f9de9f09e">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2\" data-max=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1399075200000\" data-max=\"1406419200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1399939200000\" data-max=\"1407024000000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1400025600000\" data-max=\"1407110400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1400371200000\" data-max=\"1410566400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"67\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"67\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-29&quot;,&quot;30-49&quot;,&quot;50-69&quot;,&quot;70+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-24&quot;,&quot;25-29&quot;,&quot;30-34&quot;,&quot;35-39&quot;,&quot;40-44&quot;,&quot;45-49&quot;,&quot;50-54&quot;,&quot;55-59&quot;,&quot;60-64&quot;,&quot;65-69&quot;,&quot;70-74&quot;,&quot;75-79&quot;,&quot;80-84&quot;,&quot;85+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-13.2697246824573\" data-max=\"-13.209391925612\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"8.45171855856465\" data-max=\"8.48802917129884\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"100\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"11\" data-max=\"241\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"20\" data-max=\"24\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"35.9\" data-max=\"38\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"428.994082840237\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca","2978ac","57a565","fc15ef","2eaa9a","bbfa93","c97dd9","f50e8a","3a7673","7f5a01","ddddee","99e8fa","567136","9371a9","bc2adf","403057","8bd1e8","f327be","42e1a9","90e5fe","959170","8ebf6e","e56412","6d788e","a47529","67be4e","da8ecb","148f18","2cb9a5","f5c142","70a9fe","3ad520","062638","c76676","baacc1","497372","23e499","38cc4a","3789ee","c71dcd","6b70f0"],[4,4,2,3,3,3,4,4,4,4,4,4,6,5,6,9,10,8,7,6,7,6,8,6,10,8,6,12,5,8,7,9,11,5,8,5,6,11,7,9,7,8,9,12,13,9,8,10,8,7],["2014-05-08",null,null,"2014-05-04","2014-05-18","2014-05-03","2014-05-22","2014-05-28",null,null,"2014-05-30","2014-05-28","2014-06-14","2014-06-07","2014-06-09",null,null,null,"2014-06-23","2014-06-18","2014-06-24",null,null,"2014-07-03",null,"2014-07-10","2014-06-14",null,"2014-06-18","2014-06-29","2014-07-02","2014-07-12","2014-07-12","2014-06-13","2014-07-15","2014-06-20",null,null,"2014-07-20",null,"2014-07-12","2014-07-19","2014-07-18","2014-07-18","2014-07-27",null,"2014-07-19","2014-07-26","2014-07-24",null],["2014-05-13","2014-05-13","2014-05-16","2014-05-18","2014-05-21","2014-05-22","2014-05-27","2014-06-02","2014-06-05","2014-06-05","2014-06-06","2014-06-13","2014-06-16","2014-06-17","2014-06-18","2014-06-19","2014-06-22","2014-06-23","2014-06-25","2014-06-26","2014-06-28","2014-07-02","2014-07-08","2014-07-09","2014-07-09","2014-07-10","2014-07-12","2014-07-12","2014-07-13","2014-07-13","2014-07-14","2014-07-15","2014-07-16","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-22","2014-07-22","2014-07-24","2014-07-24","2014-07-25","2014-07-25","2014-07-27","2014-07-29","2014-07-30",null,"2014-08-01","2014-08-02","2014-08-03"],["2014-05-15","2014-05-14","2014-05-18","2014-05-20","2014-05-22","2014-05-23","2014-05-29","2014-06-03","2014-06-06","2014-06-07","2014-06-08","2014-06-15","2014-06-17","2014-06-17","2014-06-20","2014-06-19","2014-06-23","2014-06-24","2014-06-27","2014-06-28","2014-06-29","2014-07-03","2014-07-09","2014-07-09","2014-07-11","2014-07-11","2014-07-13","2014-07-14","2014-07-14","2014-07-13","2014-07-14","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-20","2014-07-20","2014-07-22","2014-07-24","2014-07-26","2014-07-24","2014-07-27","2014-07-25","2014-07-27","2014-07-31","2014-08-01","2014-08-03","2014-08-02","2014-08-02","2014-08-04"],[null,"2014-05-18","2014-05-30",null,"2014-05-29","2014-05-24","2014-06-01","2014-06-07","2014-06-18","2014-06-09","2014-06-15",null,"2014-07-09",null,"2014-06-30","2014-07-11","2014-07-01","2014-06-25","2014-07-06","2014-07-02","2014-07-09","2014-07-07","2014-07-20",null,"2014-07-22","2014-07-16","2014-07-14","2014-07-20","2014-07-16","2014-07-19","2014-07-27","2014-07-19",null,"2014-07-26","2014-08-14","2014-08-01","2014-07-23","2014-08-28","2014-07-28","2014-07-19",null,"2014-08-03",null,null,null,"2014-08-06","2014-08-21","2014-09-13","2014-08-04",null],[null,"Recover","Recover",null,"Recover","Recover","Recover","Death","Recover","Death","Death","Death","Recover","Recover",null,"Recover",null,null,"Death","Death","Recover",null,null,null,"Death",null,"Death","Death",null,"Death","Recover","Death","Recover","Death","Recover",null,"Death","Recover","Recover","Death",null,null,"Death","Death","Death","Death","Recover",null,"Death","Death"],["m","f","m","f","m","f","f","f","m","f","m","m","m","f","f","m","f","f","f","f","m","m","f","m","f","m","m","f","m","f","f","f","m","m","f","m","f","f","f","m","f","m","f","m","m","f","m","f","m","m"],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14],["years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years"],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14],["0-4","0-4","50-69","15-19","0-4","15-19","15-19","0-4","50-69","20-29","10-14","30-49","15-19","5-9","5-9","10-14","30-49","15-19","10-14","10-14","15-19","50-69","10-14","20-29","5-9","0-4","30-49","5-9","50-69","10-14","10-14","20-29","20-29","30-49","0-4","10-14","0-4","15-19","20-29","30-49","5-9","10-14","10-14","0-4","10-14","0-4","0-4","20-29","20-29","10-14"],["0-4","0-4","55-59","15-19","0-4","15-19","15-19","0-4","60-64","25-29","10-14","40-44","15-19","5-9","5-9","10-14","35-39","15-19","10-14","10-14","15-19","50-54","10-14","25-29","5-9","0-4","30-34","5-9","65-69","10-14","10-14","20-24","20-24","45-49","0-4","10-14","0-4","15-19","20-24","35-39","5-9","10-14","10-14","0-4","10-14","0-4","0-4","20-24","25-29","10-14"],["Other","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital","Military Hospital","Port Hospital","Missing","Missing","Missing","Missing","Port Hospital","Military Hospital","Missing","Missing","Other","Port Hospital","Port Hospital","Port Hospital","Missing","Other","Port Hospital","Port Hospital","St. Mark's Maternity Hospital (SMMH)","Missing","Other","Missing","St. Mark's Maternity Hospital (SMMH)","Military Hospital","Port Hospital","Central Hospital","Military Hospital","Central Hospital","Missing","Military Hospital","Other","Missing","Missing","Port Hospital","Port Hospital","Port Hospital","Missing","Central Hospital","Military Hospital","Other","Other","Other","Missing","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","Missing"],[-13.2157351064963,-13.2152339775486,-13.212910703914,-13.2363711169728,-13.2228638912441,-13.222625321098,-13.2331547837254,-13.2320975453153,-13.2225511595637,-13.2572163655863,-13.2206286746001,-13.253989309478,-13.2385127873491,-13.209391925612,-13.2157278814899,-13.2243437095992,-13.2336087079551,-13.21422143145,-13.2339681355349,-13.2535640411465,-13.2250089377786,-13.2160657166043,-13.2680671272333,-13.2266742923612,-13.2160179088168,-13.2482584611565,-13.2156319199566,-13.2142410663192,-13.2614879104088,-13.2452992638476,-13.2630592726116,-13.2343341712241,-13.2199077448676,-13.2227293309912,-13.2343062806506,-13.218781651651,-13.2483677722899,-13.2097478342339,-13.2680867723786,-13.2587535457526,-13.262635786914,-13.2697246824573,-13.2209026809759,-13.2330734719715,-13.2680923666905,-13.2547212675054,-13.2573683214693,-13.2137356012883,-13.2175973322257,-13.2486407324245],[8.46897295100924,8.45171855856465,8.46481700596819,8.4754761613651,8.46082377490923,8.46183062600728,8.46272931462646,8.46144367534271,8.46191259217774,8.47292327643506,8.48401630165138,8.45837125340844,8.47761705512509,8.47570184950483,8.47779946878972,8.47145134147474,8.47804840685363,8.48528034195779,8.46957530395867,8.45957352078114,8.47404889511544,8.48802917129884,8.473437335922,8.48408263734462,8.46242233645879,8.47026822126572,8.46398447480533,8.4641347894342,8.45623094629607,8.48334624336805,8.47493999153642,8.47832062438022,8.4693933891765,8.48480589906514,8.47121232619015,8.48438437371817,8.48466158574339,8.47714159984428,8.46238127010609,8.45568597813113,8.4632880274758,8.47940722413856,8.46353857052336,8.46178968158864,8.47508713872833,8.45825808128071,8.4532568143863,8.4732571907655,8.47911586641933,8.48480340615605],["f547d6",null,null,"f90f5f","11f8ea","aec8ec","893f25","133ee7",null,null,"996f3a","133ee7","37a6f6","9f6884","4802b1",null,null,null,"a75c7f","8e104d","ab634e",null,null,"b799eb",null,"5d9e4d","a15e13",null,"ea3740","beb26e","567136","894024","36e2e7","a2086d","7baf73","eb2277",null,null,"d6584f",null,"312ecf","52ea64","cfd79c","d145b7","174288",null,"53608c","3b096b","f5c142",null],["other",null,null,"other","other","other","other","other",null,null,"other","other","other","other","other",null,null,null,"other","other","other",null,null,"other",null,"other","other",null,"other","funeral","other","funeral","other","other","other","funeral",null,null,"other",null,"other","other","other","other","other",null,"funeral","other","other",null],[27,25,91,41,36,56,47,0,86,69,67,84,68,44,34,66,78,47,53,47,71,86,53,69,38,46,68,37,100,56,50,57,65,72,29,69,37,48,54,71,47,61,47,35,53,16,13,59,69,67],[48,59,238,135,71,116,87,11,226,174,112,186,174,90,91,152,214,137,117,131,150,241,131,161,80,69,188,66,233,142,110,182,164,214,26,157,39,154,133,168,100,125,123,67,134,31,36,125,183,169],[22,22,21,23,23,21,21,22,22,22,22,22,22,21,23,22,23,21,22,23,21,23,21,24,23,22,24,23,20,24,24,20,24,21,22,21,23,22,23,23,23,22,23,22,22,22,23,22,22,22],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","no","no","no","no","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","yes","no",null,"no","no","no","yes","no",null,"no","no","yes",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","yes","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes",null,"yes","yes","yes","yes","yes",null,"yes","yes","yes",null,null,"yes","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","yes","yes","yes","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","yes","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"yes","yes",null,"no","no",null,"no","no","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","no","yes","no","no","no","yes","no","no","no",null,"no","yes","no","no","no",null,"no","no","no",null,null,"no","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","no","yes","yes","yes",null],[36.8,36.9,36.9,36.8,36.9,37.6,37.3,37,36.4,35.9,36.5,36.9,36.5,37.1,36.5,37.3,37,38,38,36,37,36.7,36.9,36.5,37,36.5,37.6,36.6,36.6,36.2,36.4,37.1,37.5,37.5,37.4,36.9,36.4,37.3,37,37.8,36.5,37.5,36.7,37,37.3,36.6,36.5,36.6,37.6,36.8],[null,"09:36","16:48","11:22","12:60","14:13","14:33","09:25","11:16","10:55","16:03","11:14","12:42","11:06","09:10","08:45",null,"15:41","13:34","18:58","12:43","16:33","14:29","07:18","08:11","16:32","16:17","07:32","17:45",null,"13:24","14:43","02:33","11:36","17:28","16:27",null,"20:49",null,"11:38","14:25","13:42","21:22","13:33","19:06","17:14","20:09",null,"10:23","09:09"],[117.1875,71.8184429761563,16.0652496292635,22.4965706447188,71.4144019043841,41.6171224732461,62.0953890870657,0,16.8376536925366,22.7903289734443,53.4119897959184,24.2802636142907,22.4600343506408,54.320987654321,41.0578432556455,28.5664819944598,17.0320552013276,25.0412914912888,38.7172182043977,27.3876813705495,31.5555555555556,14.8069075945662,30.8839811199813,26.6193433895297,59.375,96.6183574879227,19.2394748755093,84.9403122130395,18.4199377406104,27.7722674072605,41.3223140495868,17.2080666586161,24.1671624033314,15.7218971089178,428.994082840237,27.9930220292912,243.261012491782,20.2395007589813,30.527446435638,25.15589569161,47,39.04,31.0661643201798,77.9683671196257,29.5165961238583,166.493236212279,100.308641975309,37.76,20.6037803457852,23.458562375267],[2,1,2,2,1,1,2,1,1,2,2,2,1,0,2,0,1,1,2,2,1,1,1,0,2,1,1,2,1,0,0,2,1,1,2,2,1,0,2,2,0,2,0,0,2,2,null,1,0,1]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,8,10,14,15,18,19,20,26,28,29]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
</div>
<div id="plot-with-ggplotly" class="section level2" number="38.2">
<h2>
<span class="header-section-number">38.2</span> Trazar con <code>ggplotly()</code><a class="anchor" aria-label="anchor" href="#plot-with-ggplotly"><i class="fas fa-link"></i></a>
</h2>
<p>La función <code><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly()</a></code> del paquete <strong>plotly</strong> facilita la conversión de un <code>ggplot()</code> para que sea interactivo. Simplemente guarda tu <code>ggplot()</code> y luego pásaselo a la función <code><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly()</a></code>.</p>
<p>A continuación, trazamos una línea simple que representa la proporción de casos que murieron en una semana determinada.</p>
<p>Comenzamos creando unos datos resumidos de cada semana epidemiológica y el porcentaje de casos con resultado conocido que murieron.</p>
<div class="sourceCode" id="cb1730"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weekly_deaths</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span>epiweek <span class="op">=</span> <span class="fu">floor_date</span><span class="op">(</span><span class="va">date_onset</span>, <span class="st">"week"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># crear y agrupar los datos por la columna epiweek</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>                                              <span class="co"># crear nuevo dataframe descriptivo </span>
    n_known_outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,      <span class="co"># número de casos por grupo con resultado conocido</span>
    n_death  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"Death"</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,          <span class="co"># número de casos por grupo que murieron</span>
    pct_death <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="va">n_death</span> <span class="op">/</span> <span class="va">n_known_outcome</span><span class="op">)</span>           <span class="co"># porcentaje de casos con resultado conocido que murieron</span>
  <span class="op">)</span></code></pre></div>
<p>Aquí están las primeras 50 filas de los datos <code>weekly_deaths</code>.</p>
<div id="htmlwidget-708bcfe0df24b532c72f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-708bcfe0df24b532c72f">{"x":{"filter":"none","data":[["2014-04-06","2014-04-13","2014-04-20","2014-04-27","2014-05-04","2014-05-11","2014-05-18","2014-05-25","2014-06-01","2014-06-08","2014-06-15","2014-06-22","2014-06-29","2014-07-06","2014-07-13","2014-07-20","2014-07-27","2014-08-03","2014-08-10","2014-08-17","2014-08-24","2014-08-31","2014-09-07","2014-09-14","2014-09-21","2014-09-28","2014-10-05","2014-10-12","2014-10-19","2014-10-26","2014-11-02","2014-11-09","2014-11-16","2014-11-23","2014-11-30","2014-12-07","2014-12-14","2014-12-21","2014-12-28","2015-01-04","2015-01-11","2015-01-18","2015-01-25","2015-02-01","2015-02-08","2015-02-15","2015-02-22","2015-03-01","2015-03-08","2015-03-15"],[0,0,3,4,7,10,8,17,16,14,25,16,25,23,40,46,62,66,92,91,120,146,159,223,214,213,210,199,199,180,163,134,116,140,120,94,86,94,70,76,88,74,70,63,52,59,64,56,52,41],[0,0,0,2,3,5,1,11,11,8,12,11,11,9,22,21,43,33,51,46,61,72,85,118,110,115,131,120,112,97,98,86,79,84,68,52,42,62,43,39,46,43,39,41,27,33,34,37,31,23],[null,null,0,50,42.8571428571429,50,12.5,64.7058823529412,68.75,57.1428571428571,48,68.75,44,39.1304347826087,55,45.6521739130435,69.3548387096774,50,55.4347826086957,50.5494505494505,50.8333333333333,49.3150684931507,53.4591194968553,52.914798206278,51.4018691588785,53.9906103286385,62.3809523809524,60.3015075376884,56.2814070351759,53.8888888888889,60.1226993865031,64.1791044776119,68.1034482758621,60,56.6666666666667,55.3191489361702,48.8372093023256,65.9574468085106,61.4285714285714,51.3157894736842,52.2727272727273,58.1081081081081,55.7142857142857,65.0793650793651,51.9230769230769,55.9322033898305,53.125,66.0714285714286,59.6153846153846,56.0975609756098]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>epiweek<\/th>\n      <th>n_known_outcome<\/th>\n      <th>n_death<\/th>\n      <th>pct_death<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Luego creamos el gráfico con <strong>ggplot2</strong>, utilizando <code>geom_line()</code>.</p>
<div class="sourceCode" id="cb1731"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deaths_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">weekly_deaths</span><span class="op">)</span><span class="op">+</span>            <span class="co"># comenzar introduciendo los datos de  weekly deaths </span>
  <span class="fu">geom_line</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">epiweek</span>, y <span class="op">=</span> <span class="va">pct_death</span><span class="op">)</span><span class="op">)</span>  <span class="co"># hacer un gráfico de línea</span>

<span class="va">deaths_plot</span>   <span class="co"># imprimir</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-1273-1.png" width="672"></div>
<p>Podemos convertirlo en interactivo simplemente pasando este gráfico mediante un “pipe” a <code><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly()</a></code>, como se muestra abajo. Pasa el cursor por encima de la línea para mostrar los valores x e y. Puedes ampliar el gráfico y arrastrarlo. También puedes ver los iconos en la parte superior derecha del gráfico. En orden, estos botones permiten:</p>
<ul>
<li>Descargar la vista actual como imagen PNG</li>
<li>Acercarse con un cuadro de selección</li>
<li>“Pan”, o moverse a través de la gráfica clicando y arrastrando la gráfica</li>
<li>Acercar, alejar o volver al zoom por defecto</li>
<li>Restablecer los ejes por defecto</li>
<li>Activar/desactivar las “líneas en pico” que son líneas punteadas desde el punto interactivo que se extienden a los ejes x e y</li>
<li>Ajustes para que los datos se muestren cuando no se está sobre la línea</li>
</ul>
<div class="sourceCode" id="cb1732"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deaths_plot</span> <span class="op">%&gt;%</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-0c437106ac3e6d4a45d9" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0c437106ac3e6d4a45d9">{"x":{"data":[{"x":[16166,16173,16180,16187,16194,16201,16208,16215,16222,16229,16236,16243,16250,16257,16264,16271,16278,16285,16292,16299,16306,16313,16320,16327,16334,16341,16348,16355,16362,16369,16376,16383,16390,16397,16404,16411,16418,16425,16432,16439,16446,16453,16460,16467,16474,16481,16488,16495,16502,16509,16516,16523,16530,16537,16544,16551,null],"y":[null,null,0,50,42.8571428571429,50,12.5,64.7058823529412,68.75,57.1428571428571,48,68.75,44,39.1304347826087,55,45.6521739130435,69.3548387096774,50,55.4347826086957,50.5494505494505,50.8333333333333,49.3150684931507,53.4591194968553,52.914798206278,51.4018691588785,53.9906103286385,62.3809523809524,60.3015075376884,56.2814070351759,53.8888888888889,60.1226993865031,64.1791044776119,68.1034482758621,60,56.6666666666667,55.3191489361702,48.8372093023256,65.9574468085106,61.4285714285714,51.3157894736842,52.2727272727273,58.1081081081081,55.7142857142857,65.0793650793651,51.9230769230769,55.9322033898305,53.125,66.0714285714286,59.6153846153846,56.0975609756098,53.4883720930233,63.8297872340426,42.4242424242424,65.7894736842105,57.1428571428571,52.3809523809524,62.7906976744186],"text":["epiweek: 2014-04-06<br />pct_death:      NaN","epiweek: 2014-04-13<br />pct_death:      NaN","epiweek: 2014-04-20<br />pct_death:  0.00000","epiweek: 2014-04-27<br />pct_death: 50.00000","epiweek: 2014-05-04<br />pct_death: 42.85714","epiweek: 2014-05-11<br />pct_death: 50.00000","epiweek: 2014-05-18<br />pct_death: 12.50000","epiweek: 2014-05-25<br />pct_death: 64.70588","epiweek: 2014-06-01<br />pct_death: 68.75000","epiweek: 2014-06-08<br />pct_death: 57.14286","epiweek: 2014-06-15<br />pct_death: 48.00000","epiweek: 2014-06-22<br />pct_death: 68.75000","epiweek: 2014-06-29<br />pct_death: 44.00000","epiweek: 2014-07-06<br />pct_death: 39.13043","epiweek: 2014-07-13<br />pct_death: 55.00000","epiweek: 2014-07-20<br />pct_death: 45.65217","epiweek: 2014-07-27<br />pct_death: 69.35484","epiweek: 2014-08-03<br />pct_death: 50.00000","epiweek: 2014-08-10<br />pct_death: 55.43478","epiweek: 2014-08-17<br />pct_death: 50.54945","epiweek: 2014-08-24<br />pct_death: 50.83333","epiweek: 2014-08-31<br />pct_death: 49.31507","epiweek: 2014-09-07<br />pct_death: 53.45912","epiweek: 2014-09-14<br />pct_death: 52.91480","epiweek: 2014-09-21<br />pct_death: 51.40187","epiweek: 2014-09-28<br />pct_death: 53.99061","epiweek: 2014-10-05<br />pct_death: 62.38095","epiweek: 2014-10-12<br />pct_death: 60.30151","epiweek: 2014-10-19<br />pct_death: 56.28141","epiweek: 2014-10-26<br />pct_death: 53.88889","epiweek: 2014-11-02<br />pct_death: 60.12270","epiweek: 2014-11-09<br />pct_death: 64.17910","epiweek: 2014-11-16<br />pct_death: 68.10345","epiweek: 2014-11-23<br />pct_death: 60.00000","epiweek: 2014-11-30<br />pct_death: 56.66667","epiweek: 2014-12-07<br />pct_death: 55.31915","epiweek: 2014-12-14<br />pct_death: 48.83721","epiweek: 2014-12-21<br />pct_death: 65.95745","epiweek: 2014-12-28<br />pct_death: 61.42857","epiweek: 2015-01-04<br />pct_death: 51.31579","epiweek: 2015-01-11<br />pct_death: 52.27273","epiweek: 2015-01-18<br />pct_death: 58.10811","epiweek: 2015-01-25<br />pct_death: 55.71429","epiweek: 2015-02-01<br />pct_death: 65.07937","epiweek: 2015-02-08<br />pct_death: 51.92308","epiweek: 2015-02-15<br />pct_death: 55.93220","epiweek: 2015-02-22<br />pct_death: 53.12500","epiweek: 2015-03-01<br />pct_death: 66.07143","epiweek: 2015-03-08<br />pct_death: 59.61538","epiweek: 2015-03-15<br />pct_death: 56.09756","epiweek: 2015-03-22<br />pct_death: 53.48837","epiweek: 2015-03-29<br />pct_death: 63.82979","epiweek: 2015-04-05<br />pct_death: 42.42424","epiweek: 2015-04-12<br />pct_death: 65.78947","epiweek: 2015-04-19<br />pct_death: 57.14286","epiweek: 2015-04-26<br />pct_death: 52.38095","epiweek: NA<br />pct_death: 62.79070"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[16146.75,16570.25],"tickmode":"array","ticktext":["abr. 2014","jul. 2014","oct. 2014","ene. 2015","abr. 2015"],"tickvals":[16161,16252,16344,16436,16526],"categoryorder":"array","categoryarray":["abr. 2014","jul. 2014","oct. 2014","ene. 2015","abr. 2015"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"epiweek","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.46774193548387,72.8225806451613],"tickmode":"array","ticktext":["0","20","40","60"],"tickvals":[0,20,40,60],"categoryorder":"array","categoryarray":["0","20","40","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"pct_death","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"2ec317b7f9a":{"x":{},"y":{},"type":"scatter"}},"cur_data":"2ec317b7f9a","visdat":{"2ec317b7f9a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Los datos agrupados también funcionan con <code><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly()</a></code>. A continuación, realizaremos una curva epidemica semanal agrupada por resultado. Las barras apiladas son interactivas. Prueba a clicar en los diferentes elementos de la leyenda (aparecerán/desaparecerán).</p>
<div class="sourceCode" id="cb1733"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Hacer curva epidémica con el paquete incidence2</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/incidence2/man/incidence.html">incidence</a></span><span class="op">(</span>
  <span class="va">linelist</span>,
  date_index <span class="op">=</span> <span class="va">date_onset</span>,
  interval <span class="op">=</span> <span class="st">"weeks"</span>,
  groups <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1734"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Hacer interactivo</span>
<span class="va">p</span> <span class="op">%&gt;%</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-8a616d0846a7668478a6" style="width:95%;height:500px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8a616d0846a7668478a6">{"x":{"data":[{"orientation":"v","width":[6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.30000000000109,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291],"base":[3,8,13,13,14,5,11,17,23,16,27,31,41,37,50,58,78,110,118,157,149,188,167,149,139,136,136,129,87,84,72,75,78,64,70,65,55,55,58,49,40,42,38,62,35,32,36,32,26,25,15,20,16,5],"x":[16181,16188,16195,16202,16209,16216,16223,16230,16237,16244,16251,16258,16265,16272,16279,16286,16293,16300,16307,16314,16321,16328,16335,16342,16349,16356,16363,16370,16377,16384,16391,16398,16405,16412,16419,16426,16433,16440,16447,16454,16461,16468,16475,16482,16489,16496,16503,16510,16517,16524,16531,16538,16545,16552],"y":[3,2,3,5,7,12,14,14,10,11,13,15,26,36,37,46,67,68,57,101,121,138,130,121,138,112,113,102,82,82,83,66,59,40,47,57,31,44,51,37,36,28,32,43,33,30,21,29,29,21,14,13,11,3],"text":["week_earliest: 2014-04-21<br />n:   3<br />outcome: Death","week_earliest: 2014-04-28<br />n:   2<br />outcome: Death","week_earliest: 2014-05-05<br />n:   3<br />outcome: Death","week_earliest: 2014-05-12<br />n:   5<br />outcome: Death","week_earliest: 2014-05-19<br />n:   7<br />outcome: Death","week_earliest: 2014-05-26<br />n:  12<br />outcome: Death","week_earliest: 2014-06-02<br />n:  14<br />outcome: Death","week_earliest: 2014-06-09<br />n:  14<br />outcome: Death","week_earliest: 2014-06-16<br />n:  10<br />outcome: Death","week_earliest: 2014-06-23<br />n:  11<br />outcome: Death","week_earliest: 2014-06-30<br />n:  13<br />outcome: Death","week_earliest: 2014-07-07<br />n:  15<br />outcome: Death","week_earliest: 2014-07-14<br />n:  26<br />outcome: Death","week_earliest: 2014-07-21<br />n:  36<br />outcome: Death","week_earliest: 2014-07-28<br />n:  37<br />outcome: Death","week_earliest: 2014-08-04<br />n:  46<br />outcome: Death","week_earliest: 2014-08-11<br />n:  67<br />outcome: Death","week_earliest: 2014-08-18<br />n:  68<br />outcome: Death","week_earliest: 2014-08-25<br />n:  57<br />outcome: Death","week_earliest: 2014-09-01<br />n: 101<br />outcome: Death","week_earliest: 2014-09-08<br />n: 121<br />outcome: Death","week_earliest: 2014-09-15<br />n: 138<br />outcome: Death","week_earliest: 2014-09-22<br />n: 130<br />outcome: Death","week_earliest: 2014-09-29<br />n: 121<br />outcome: Death","week_earliest: 2014-10-06<br />n: 138<br />outcome: Death","week_earliest: 2014-10-13<br />n: 112<br />outcome: Death","week_earliest: 2014-10-20<br />n: 113<br />outcome: Death","week_earliest: 2014-10-27<br />n: 102<br />outcome: Death","week_earliest: 2014-11-03<br />n:  82<br />outcome: Death","week_earliest: 2014-11-10<br />n:  82<br />outcome: Death","week_earliest: 2014-11-17<br />n:  83<br />outcome: Death","week_earliest: 2014-11-24<br />n:  66<br />outcome: Death","week_earliest: 2014-12-01<br />n:  59<br />outcome: Death","week_earliest: 2014-12-08<br />n:  40<br />outcome: Death","week_earliest: 2014-12-15<br />n:  47<br />outcome: Death","week_earliest: 2014-12-22<br />n:  57<br />outcome: Death","week_earliest: 2014-12-29<br />n:  31<br />outcome: Death","week_earliest: 2015-01-05<br />n:  44<br />outcome: Death","week_earliest: 2015-01-12<br />n:  51<br />outcome: Death","week_earliest: 2015-01-19<br />n:  37<br />outcome: Death","week_earliest: 2015-01-26<br />n:  36<br />outcome: Death","week_earliest: 2015-02-02<br />n:  28<br />outcome: Death","week_earliest: 2015-02-09<br />n:  32<br />outcome: Death","week_earliest: 2015-02-16<br />n:  43<br />outcome: Death","week_earliest: 2015-02-23<br />n:  33<br />outcome: Death","week_earliest: 2015-03-02<br />n:  30<br />outcome: Death","week_earliest: 2015-03-09<br />n:  21<br />outcome: Death","week_earliest: 2015-03-16<br />n:  29<br />outcome: Death","week_earliest: 2015-03-23<br />n:  29<br />outcome: Death","week_earliest: 2015-03-30<br />n:  21<br />outcome: Death","week_earliest: 2015-04-06<br />n:  14<br />outcome: Death","week_earliest: 2015-04-13<br />n:  13<br />outcome: Death","week_earliest: 2015-04-20<br />n:  11<br />outcome: Death","week_earliest: 2015-04-27<br />n:   3<br />outcome: Death"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Death","legendgroup":"Death","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.30000000000109,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291],"base":[0,0,3,6,7,6,1,5,6,10,8,10,13,13,14,23,19,35,36,41,66,64,68,69,56,53,47,58,64,38,28,27,28,33,33,30,27,24,22,24,16,18,16,13,27,18,14,13,15,13,5,4,8,7,2],"x":[16174,16181,16188,16195,16202,16209,16216,16223,16230,16237,16244,16251,16258,16265,16272,16279,16286,16293,16300,16307,16314,16321,16328,16335,16342,16349,16356,16363,16370,16377,16384,16391,16398,16405,16412,16419,16426,16433,16440,16447,16454,16461,16468,16475,16482,16489,16496,16503,16510,16517,16524,16531,16538,16545,16552],"y":[1,3,5,7,6,8,4,6,11,13,8,17,18,28,23,27,39,43,74,77,91,85,120,98,93,86,89,78,65,49,56,45,47,45,31,40,38,31,33,34,33,22,26,25,35,17,18,23,17,13,20,11,12,9,3],"text":["week_earliest: 2014-04-14<br />n:   1<br />outcome: Recover","week_earliest: 2014-04-21<br />n:   3<br />outcome: Recover","week_earliest: 2014-04-28<br />n:   5<br />outcome: Recover","week_earliest: 2014-05-05<br />n:   7<br />outcome: Recover","week_earliest: 2014-05-12<br />n:   6<br />outcome: Recover","week_earliest: 2014-05-19<br />n:   8<br />outcome: Recover","week_earliest: 2014-05-26<br />n:   4<br />outcome: Recover","week_earliest: 2014-06-02<br />n:   6<br />outcome: Recover","week_earliest: 2014-06-09<br />n:  11<br />outcome: Recover","week_earliest: 2014-06-16<br />n:  13<br />outcome: Recover","week_earliest: 2014-06-23<br />n:   8<br />outcome: Recover","week_earliest: 2014-06-30<br />n:  17<br />outcome: Recover","week_earliest: 2014-07-07<br />n:  18<br />outcome: Recover","week_earliest: 2014-07-14<br />n:  28<br />outcome: Recover","week_earliest: 2014-07-21<br />n:  23<br />outcome: Recover","week_earliest: 2014-07-28<br />n:  27<br />outcome: Recover","week_earliest: 2014-08-04<br />n:  39<br />outcome: Recover","week_earliest: 2014-08-11<br />n:  43<br />outcome: Recover","week_earliest: 2014-08-18<br />n:  74<br />outcome: Recover","week_earliest: 2014-08-25<br />n:  77<br />outcome: Recover","week_earliest: 2014-09-01<br />n:  91<br />outcome: Recover","week_earliest: 2014-09-08<br />n:  85<br />outcome: Recover","week_earliest: 2014-09-15<br />n: 120<br />outcome: Recover","week_earliest: 2014-09-22<br />n:  98<br />outcome: Recover","week_earliest: 2014-09-29<br />n:  93<br />outcome: Recover","week_earliest: 2014-10-06<br />n:  86<br />outcome: Recover","week_earliest: 2014-10-13<br />n:  89<br />outcome: Recover","week_earliest: 2014-10-20<br />n:  78<br />outcome: Recover","week_earliest: 2014-10-27<br />n:  65<br />outcome: Recover","week_earliest: 2014-11-03<br />n:  49<br />outcome: Recover","week_earliest: 2014-11-10<br />n:  56<br />outcome: Recover","week_earliest: 2014-11-17<br />n:  45<br />outcome: Recover","week_earliest: 2014-11-24<br />n:  47<br />outcome: Recover","week_earliest: 2014-12-01<br />n:  45<br />outcome: Recover","week_earliest: 2014-12-08<br />n:  31<br />outcome: Recover","week_earliest: 2014-12-15<br />n:  40<br />outcome: Recover","week_earliest: 2014-12-22<br />n:  38<br />outcome: Recover","week_earliest: 2014-12-29<br />n:  31<br />outcome: Recover","week_earliest: 2015-01-05<br />n:  33<br />outcome: Recover","week_earliest: 2015-01-12<br />n:  34<br />outcome: Recover","week_earliest: 2015-01-19<br />n:  33<br />outcome: Recover","week_earliest: 2015-01-26<br />n:  22<br />outcome: Recover","week_earliest: 2015-02-02<br />n:  26<br />outcome: Recover","week_earliest: 2015-02-09<br />n:  25<br />outcome: Recover","week_earliest: 2015-02-16<br />n:  35<br />outcome: Recover","week_earliest: 2015-02-23<br />n:  17<br />outcome: Recover","week_earliest: 2015-03-02<br />n:  18<br />outcome: Recover","week_earliest: 2015-03-09<br />n:  23<br />outcome: Recover","week_earliest: 2015-03-16<br />n:  17<br />outcome: Recover","week_earliest: 2015-03-23<br />n:  13<br />outcome: Recover","week_earliest: 2015-03-30<br />n:  20<br />outcome: Recover","week_earliest: 2015-04-06<br />n:  11<br />outcome: Recover","week_earliest: 2015-04-13<br />n:  12<br />outcome: Recover","week_earliest: 2015-04-20<br />n:   9<br />outcome: Recover","week_earliest: 2015-04-27<br />n:   3<br />outcome: Recover"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Recover","legendgroup":"Recover","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.29999999999927,6.30000000000109,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291,6.30000000000291],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[16146,16167,16188,16195,16202,16209,16216,16223,16230,16237,16244,16251,16258,16265,16272,16279,16286,16293,16300,16307,16314,16321,16328,16335,16342,16349,16356,16363,16370,16377,16384,16391,16398,16405,16412,16419,16426,16433,16440,16447,16454,16461,16468,16475,16482,16489,16496,16503,16510,16517,16524,16531,16538,16545,16552],"y":[1,2,3,6,7,6,1,5,6,10,8,10,13,13,14,23,19,35,36,41,66,64,68,69,56,53,47,58,64,38,28,27,28,33,33,30,27,24,22,24,16,18,16,13,27,18,14,13,15,13,5,4,8,7,2],"text":["week_earliest: 2014-03-17<br />n:   1<br />outcome: Unknown","week_earliest: 2014-04-07<br />n:   2<br />outcome: Unknown","week_earliest: 2014-04-28<br />n:   3<br />outcome: Unknown","week_earliest: 2014-05-05<br />n:   6<br />outcome: Unknown","week_earliest: 2014-05-12<br />n:   7<br />outcome: Unknown","week_earliest: 2014-05-19<br />n:   6<br />outcome: Unknown","week_earliest: 2014-05-26<br />n:   1<br />outcome: Unknown","week_earliest: 2014-06-02<br />n:   5<br />outcome: Unknown","week_earliest: 2014-06-09<br />n:   6<br />outcome: Unknown","week_earliest: 2014-06-16<br />n:  10<br />outcome: Unknown","week_earliest: 2014-06-23<br />n:   8<br />outcome: Unknown","week_earliest: 2014-06-30<br />n:  10<br />outcome: Unknown","week_earliest: 2014-07-07<br />n:  13<br />outcome: Unknown","week_earliest: 2014-07-14<br />n:  13<br />outcome: Unknown","week_earliest: 2014-07-21<br />n:  14<br />outcome: Unknown","week_earliest: 2014-07-28<br />n:  23<br />outcome: Unknown","week_earliest: 2014-08-04<br />n:  19<br />outcome: Unknown","week_earliest: 2014-08-11<br />n:  35<br />outcome: Unknown","week_earliest: 2014-08-18<br />n:  36<br />outcome: Unknown","week_earliest: 2014-08-25<br />n:  41<br />outcome: Unknown","week_earliest: 2014-09-01<br />n:  66<br />outcome: Unknown","week_earliest: 2014-09-08<br />n:  64<br />outcome: Unknown","week_earliest: 2014-09-15<br />n:  68<br />outcome: Unknown","week_earliest: 2014-09-22<br />n:  69<br />outcome: Unknown","week_earliest: 2014-09-29<br />n:  56<br />outcome: Unknown","week_earliest: 2014-10-06<br />n:  53<br />outcome: Unknown","week_earliest: 2014-10-13<br />n:  47<br />outcome: Unknown","week_earliest: 2014-10-20<br />n:  58<br />outcome: Unknown","week_earliest: 2014-10-27<br />n:  64<br />outcome: Unknown","week_earliest: 2014-11-03<br />n:  38<br />outcome: Unknown","week_earliest: 2014-11-10<br />n:  28<br />outcome: Unknown","week_earliest: 2014-11-17<br />n:  27<br />outcome: Unknown","week_earliest: 2014-11-24<br />n:  28<br />outcome: Unknown","week_earliest: 2014-12-01<br />n:  33<br />outcome: Unknown","week_earliest: 2014-12-08<br />n:  33<br />outcome: Unknown","week_earliest: 2014-12-15<br />n:  30<br />outcome: Unknown","week_earliest: 2014-12-22<br />n:  27<br />outcome: Unknown","week_earliest: 2014-12-29<br />n:  24<br />outcome: Unknown","week_earliest: 2015-01-05<br />n:  22<br />outcome: Unknown","week_earliest: 2015-01-12<br />n:  24<br />outcome: Unknown","week_earliest: 2015-01-19<br />n:  16<br />outcome: Unknown","week_earliest: 2015-01-26<br />n:  18<br />outcome: Unknown","week_earliest: 2015-02-02<br />n:  16<br />outcome: Unknown","week_earliest: 2015-02-09<br />n:  13<br />outcome: Unknown","week_earliest: 2015-02-16<br />n:  27<br />outcome: Unknown","week_earliest: 2015-02-23<br />n:  18<br />outcome: Unknown","week_earliest: 2015-03-02<br />n:  14<br />outcome: Unknown","week_earliest: 2015-03-09<br />n:  13<br />outcome: Unknown","week_earliest: 2015-03-16<br />n:  15<br />outcome: Unknown","week_earliest: 2015-03-23<br />n:  13<br />outcome: Unknown","week_earliest: 2015-03-30<br />n:   5<br />outcome: Unknown","week_earliest: 2015-04-06<br />n:   4<br />outcome: Unknown","week_earliest: 2015-04-13<br />n:   8<br />outcome: Unknown","week_earliest: 2015-04-20<br />n:   7<br />outcome: Unknown","week_earliest: 2015-04-27<br />n:   2<br />outcome: Unknown"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Unknown","legendgroup":"Unknown","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[16122.235,16575.765],"tickmode":"array","ticktext":["abr. 2014","jul. 2014","oct. 2014","ene. 2015","abr. 2015"],"tickvals":[16161,16252,16344,16436,16526],"categoryorder":"array","categoryarray":["abr. 2014","jul. 2014","oct. 2014","ene. 2015","abr. 2015"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Week of infection/onset","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-16.3,342.3],"tickmode":"array","ticktext":["0","100","200","300"],"tickvals":[0,100,200,300],"categoryorder":"array","categoryarray":["0","100","200","300"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Cases per week","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96751968503937},"annotations":[{"text":"outcome","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"2ec31c5342a":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"2ec31c5342a","visdat":{"2ec31c5342a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
<div id="modifications" class="section level2" number="38.3">
<h2>
<span class="header-section-number">38.3</span> Modificaciones<a class="anchor" aria-label="anchor" href="#modifications"><i class="fas fa-link"></i></a>
</h2>
<div id="file-size" class="section level3" number="38.3.1">
<h3>
<span class="header-section-number">38.3.1</span> Tamaño del archivo<a class="anchor" aria-label="anchor" href="#file-size"><i class="fas fa-link"></i></a>
</h3>
<p>Cuando se exportan imagenes en un HTML generado por R Markdown (¡como este libro!) es deseable que el gráfico tenga el menor tamaño de datos posible (y siempre que se pueda, evitar que esto tenga repercusiones negativas). Para ello, sólo hay que realizar “pipe” desde el gráfico interactivo a <code><a href="https://rdrr.io/pkg/plotly/man/partial_bundle.html">partial_bundle()</a></code>, de <strong>plotly</strong>.</p>
<div class="sourceCode" id="cb1735"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">%&gt;%</span> 
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/partial_bundle.html">partial_bundle</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="botones-buttons" class="section level3" number="38.3.2">
<h3>
<span class="header-section-number">38.3.2</span> Botones {buttons}<a class="anchor" aria-label="anchor" href="#botones-buttons"><i class="fas fa-link"></i></a>
</h3>
<p>Algunos de los botones de un plotly estándar son superfluos y pueden distraer, por lo que, si quieres, puedes eliminarlos. Puedes hacer esto simplemente canalizando la haz pipe hacia <code><a href="https://rdrr.io/pkg/plotly/man/config.html">config()</a></code> de <strong>plotly</strong> y especifican qué botones eliminar. En el siguiente ejemplo especificamos por adelantado los nombres de los botones a eliminar, y los especificamos en el argumento <code>modeBarButtonsToRemove =</code>. También establecemos <code>displaylogo = FALSE</code> para eliminar el logo de plotly.</p>
<div class="sourceCode" id="cb1736"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## estos botones distraen y queremos eliminarlos</span>
<span class="va">plotly_buttons_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'zoom2d'</span>,<span class="st">'pan2d'</span>,<span class="st">'lasso2d'</span>, <span class="st">'select2d'</span>,<span class="st">'zoomIn2d'</span>,
                              <span class="st">'zoomOut2d'</span>,<span class="st">'autoScale2d'</span>,<span class="st">'hoverClosestCartesian'</span>,
                              <span class="st">'toggleSpikelines'</span>,<span class="st">'hoverCompareCartesian'</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">%&gt;%</span>            <span class="co"># redefinir el gráfico  interactivo sin estos botones</span>
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/config.html">config</a></span><span class="op">(</span>displaylogo <span class="op">=</span> <span class="cn">FALSE</span>, modeBarButtonsToRemove <span class="op">=</span> <span class="va">plotly_buttons_remove</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="heat-tiles" class="section level2" number="38.4">
<h2>
<span class="header-section-number">38.4</span> Gráficos de calor<a class="anchor" aria-label="anchor" href="#heat-tiles"><i class="fas fa-link"></i></a>
</h2>
<p>Puedes hacer que casi cualquier gráfico de <code>ggplot()</code> sea interactivo, incluidos los gráficos de calor. En la página sobre <a href="heat-plots.html#heat-plots">gráficos de calor</a> puede leer cómo hacer el siguiente gráfico, que muestra la proporción de días a la semana en que determinados centros comunicaron datos a su provincia.</p>
<p>Aquí está el código, aunque en este capítulo no describiremos en profundidad como realizarlo.</p>
<div class="sourceCode" id="cb1737"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># importar datos</span>
<span class="va">facility_count_data</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"malaria_facility_count_data.rds"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># datos agregados en semanas para el distrito de Spring</span>
<span class="va">agg_weeks</span> <span class="op">&lt;-</span> <span class="va">facility_count_data</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">District</span> <span class="op">==</span> <span class="st">"Spring"</span>,
         <span class="va">data_date</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-08-01"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fu">aweek</span><span class="fu">::</span><span class="fu"><a href="https://www.repidemicsconsortium.org/aweek/reference/date2week.html">date2week</a></span><span class="op">(</span>
    <span class="va">data_date</span>,
    start_date <span class="op">=</span> <span class="st">"Monday"</span>,
    floor_day <span class="op">=</span> <span class="cn">TRUE</span>,
    factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">location_name</span>, <span class="va">week</span>, .drop <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>
    n_days          <span class="op">=</span> <span class="fl">7</span>,
    n_reports       <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,
    malaria_tot     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">malaria_tot</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,
    n_days_reported <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data_date</span><span class="op">)</span><span class="op">)</span>,
    p_days_reported <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="va">n_days_reported</span> <span class="op">/</span> <span class="va">n_days</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">right_join</span><span class="op">(</span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">expand</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">week</span>, <span class="va">location_name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fu">aweek</span><span class="fu">::</span><span class="fu"><a href="https://www.repidemicsconsortium.org/aweek/reference/date2week.html">week2date</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span><span class="op">)</span>

<span class="co"># crear plot</span>
<span class="va">metrics_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">agg_weeks</span>,
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">week</span>,
           y <span class="op">=</span> <span class="va">location_name</span>,
           fill <span class="op">=</span> <span class="va">p_days_reported</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_tile</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"orange"</span>, high <span class="op">=</span> <span class="st">"darkgreen"</span>, na.value <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_x_date</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,
               date_breaks <span class="op">=</span> <span class="st">"2 weeks"</span>,
               date_labels <span class="op">=</span> <span class="st">"%d\n%b"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    legend.text  <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    legend.key.height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"cm"</span><span class="op">)</span>,
    legend.key.width  <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="st">"cm"</span><span class="op">)</span>,
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,
    axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>vjust<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>,
    axis.ticks <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>,
    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>,size<span class="op">=</span><span class="fl">14</span>,face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>
    <span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Week"</span>,
       y <span class="op">=</span> <span class="st">"Facility name"</span>,
       fill <span class="op">=</span> <span class="st">"Reporting\nperformance (%)"</span>,
       title <span class="op">=</span> <span class="st">"Percent of days per week that facility reported data"</span>,
       subtitle <span class="op">=</span> <span class="st">"District health facilities, April-May 2019"</span>,
       caption <span class="op">=</span> <span class="st">"7-day weeks beginning on Mondays."</span><span class="op">)</span>

<span class="va">metrics_plot</span> <span class="co"># imprimir</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-1277-1.png" width="672"></div>
<p>A continuación, lo convertimos en interactivo y lo modificamos para que los botones sean sencillos y disminuya el tamaño del archivo.</p>
<div class="sourceCode" id="cb1738"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">metrics_plot</span> <span class="op">%&gt;%</span> 
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/partial_bundle.html">partial_bundle</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/config.html">config</a></span><span class="op">(</span>displaylogo <span class="op">=</span> <span class="cn">FALSE</span>, modeBarButtonsToRemove <span class="op">=</span> <span class="va">plotly_buttons_remove</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-d6d2e6678341efa3546c" style="width:95%;height:500px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d6d2e6678341efa3546c">{"x":{"data":[{"x":[18393,18400,18407,18414,18421,18428,18435,18442,18449,18456,18463,18470],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"z":[[0,0,0,0,0.29,1,1,1,1,1,1,0.57],[0,0,0,0,0,0,0,0.29,1,0.86,0.29,0.43],[0,0,0,0.14,0.71,0.29,0.71,0.86,0.71,1,0.86,0.71],[0.29,1,1,1,1,1,1,1,1,1,1,0.71],[0,0,0,0.14,0.86,0.43,0.71,0.57,0.71,1,1,0.71],[0,0,0,0,0.86,0.86,1,1,1,1,1,0.71],[0,0,0,0,0,0,0.29,0.71,1,1,1,0.71],[0,0,0,0,0.86,1,1,1,1,1,1,0.71],[0,0,0,0,0.14,0.86,0.86,0.86,0.86,1,0.86,0.57],[0,0,0,0,0,0,0.14,0,0,0,0,0],[0,0,0,0.14,1,1,1,1,1,1,1,0.71],[0,0,0,0,0,0.29,0.86,0.71,0.86,0.86,0.71,0.71],[0,0,0,0,0,0.29,0.57,0,0,0,0,0],[0,0,0,0,0,0.71,1,1,0.86,1,1,0.71],[0,0,0,0,0.86,1,1,1,1,1,0.57,0.71]],"text":[["week: 2020-05-11<br />location_name: Facility 1<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 1<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 1<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 1<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 1<br />p_days_reported:  29","week: 2020-06-15<br />location_name: Facility 1<br />p_days_reported: 100","week: 2020-06-22<br />location_name: Facility 1<br />p_days_reported: 100","week: 2020-06-29<br />location_name: Facility 1<br />p_days_reported: 100","week: 2020-07-06<br />location_name: Facility 1<br />p_days_reported: 100","week: 2020-07-13<br />location_name: Facility 1<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 1<br />p_days_reported: 100","week: 2020-07-27<br />location_name: Facility 1<br />p_days_reported:  57"],["week: 2020-05-11<br />location_name: Facility 11<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 11<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 11<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 11<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 11<br />p_days_reported:   0","week: 2020-06-15<br />location_name: Facility 11<br />p_days_reported:   0","week: 2020-06-22<br />location_name: Facility 11<br />p_days_reported:   0","week: 2020-06-29<br />location_name: Facility 11<br />p_days_reported:  29","week: 2020-07-06<br />location_name: Facility 11<br />p_days_reported: 100","week: 2020-07-13<br />location_name: Facility 11<br />p_days_reported:  86","week: 2020-07-20<br />location_name: Facility 11<br />p_days_reported:  29","week: 2020-07-27<br />location_name: Facility 11<br />p_days_reported:  43"],["week: 2020-05-11<br />location_name: Facility 27<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 27<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 27<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 27<br />p_days_reported:  14","week: 2020-06-08<br />location_name: Facility 27<br />p_days_reported:  71","week: 2020-06-15<br />location_name: Facility 27<br />p_days_reported:  29","week: 2020-06-22<br />location_name: Facility 27<br />p_days_reported:  71","week: 2020-06-29<br />location_name: Facility 27<br />p_days_reported:  86","week: 2020-07-06<br />location_name: Facility 27<br />p_days_reported:  71","week: 2020-07-13<br />location_name: Facility 27<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 27<br />p_days_reported:  86","week: 2020-07-27<br />location_name: Facility 27<br />p_days_reported:  71"],["week: 2020-05-11<br />location_name: Facility 28<br />p_days_reported:  29","week: 2020-05-18<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-05-25<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-06-01<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-06-08<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-06-15<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-06-22<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-06-29<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-07-06<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-07-13<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 28<br />p_days_reported: 100","week: 2020-07-27<br />location_name: Facility 28<br />p_days_reported:  71"],["week: 2020-05-11<br />location_name: Facility 32<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 32<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 32<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 32<br />p_days_reported:  14","week: 2020-06-08<br />location_name: Facility 32<br />p_days_reported:  86","week: 2020-06-15<br />location_name: Facility 32<br />p_days_reported:  43","week: 2020-06-22<br />location_name: Facility 32<br />p_days_reported:  71","week: 2020-06-29<br />location_name: Facility 32<br />p_days_reported:  57","week: 2020-07-06<br />location_name: Facility 32<br />p_days_reported:  71","week: 2020-07-13<br />location_name: Facility 32<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 32<br />p_days_reported: 100","week: 2020-07-27<br />location_name: Facility 32<br />p_days_reported:  71"],["week: 2020-05-11<br />location_name: Facility 35<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 35<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 35<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 35<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 35<br />p_days_reported:  86","week: 2020-06-15<br />location_name: Facility 35<br />p_days_reported:  86","week: 2020-06-22<br />location_name: Facility 35<br />p_days_reported: 100","week: 2020-06-29<br />location_name: Facility 35<br />p_days_reported: 100","week: 2020-07-06<br />location_name: Facility 35<br />p_days_reported: 100","week: 2020-07-13<br />location_name: Facility 35<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 35<br />p_days_reported: 100","week: 2020-07-27<br />location_name: Facility 35<br />p_days_reported:  71"],["week: 2020-05-11<br />location_name: Facility 39<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 39<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 39<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 39<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 39<br />p_days_reported:   0","week: 2020-06-15<br />location_name: Facility 39<br />p_days_reported:   0","week: 2020-06-22<br />location_name: Facility 39<br />p_days_reported:  29","week: 2020-06-29<br />location_name: Facility 39<br />p_days_reported:  71","week: 2020-07-06<br />location_name: Facility 39<br />p_days_reported: 100","week: 2020-07-13<br />location_name: Facility 39<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 39<br />p_days_reported: 100","week: 2020-07-27<br />location_name: Facility 39<br />p_days_reported:  71"],["week: 2020-05-11<br />location_name: Facility 50<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 50<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 50<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 50<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 50<br />p_days_reported:  86","week: 2020-06-15<br />location_name: Facility 50<br />p_days_reported: 100","week: 2020-06-22<br />location_name: Facility 50<br />p_days_reported: 100","week: 2020-06-29<br />location_name: Facility 50<br />p_days_reported: 100","week: 2020-07-06<br />location_name: Facility 50<br />p_days_reported: 100","week: 2020-07-13<br />location_name: Facility 50<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 50<br />p_days_reported: 100","week: 2020-07-27<br />location_name: Facility 50<br />p_days_reported:  71"],["week: 2020-05-11<br />location_name: Facility 51<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 51<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 51<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 51<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 51<br />p_days_reported:  14","week: 2020-06-15<br />location_name: Facility 51<br />p_days_reported:  86","week: 2020-06-22<br />location_name: Facility 51<br />p_days_reported:  86","week: 2020-06-29<br />location_name: Facility 51<br />p_days_reported:  86","week: 2020-07-06<br />location_name: Facility 51<br />p_days_reported:  86","week: 2020-07-13<br />location_name: Facility 51<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 51<br />p_days_reported:  86","week: 2020-07-27<br />location_name: Facility 51<br />p_days_reported:  57"],["week: 2020-05-11<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-06-15<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-06-22<br />location_name: Facility 56<br />p_days_reported:  14","week: 2020-06-29<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-07-06<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-07-13<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-07-20<br />location_name: Facility 56<br />p_days_reported:   0","week: 2020-07-27<br />location_name: Facility 56<br />p_days_reported:   0"],["week: 2020-05-11<br />location_name: Facility 58<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 58<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 58<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 58<br />p_days_reported:  14","week: 2020-06-08<br />location_name: Facility 58<br />p_days_reported: 100","week: 2020-06-15<br />location_name: Facility 58<br />p_days_reported: 100","week: 2020-06-22<br />location_name: Facility 58<br />p_days_reported: 100","week: 2020-06-29<br />location_name: Facility 58<br />p_days_reported: 100","week: 2020-07-06<br />location_name: Facility 58<br />p_days_reported: 100","week: 2020-07-13<br />location_name: Facility 58<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 58<br />p_days_reported: 100","week: 2020-07-27<br />location_name: Facility 58<br />p_days_reported:  71"],["week: 2020-05-11<br />location_name: Facility 59<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 59<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 59<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 59<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 59<br />p_days_reported:   0","week: 2020-06-15<br />location_name: Facility 59<br />p_days_reported:  29","week: 2020-06-22<br />location_name: Facility 59<br />p_days_reported:  86","week: 2020-06-29<br />location_name: Facility 59<br />p_days_reported:  71","week: 2020-07-06<br />location_name: Facility 59<br />p_days_reported:  86","week: 2020-07-13<br />location_name: Facility 59<br />p_days_reported:  86","week: 2020-07-20<br />location_name: Facility 59<br />p_days_reported:  71","week: 2020-07-27<br />location_name: Facility 59<br />p_days_reported:  71"],["week: 2020-05-11<br />location_name: Facility 65<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 65<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 65<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 65<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 65<br />p_days_reported:   0","week: 2020-06-15<br />location_name: Facility 65<br />p_days_reported:  29","week: 2020-06-22<br />location_name: Facility 65<br />p_days_reported:  57","week: 2020-06-29<br />location_name: Facility 65<br />p_days_reported:   0","week: 2020-07-06<br />location_name: Facility 65<br />p_days_reported:   0","week: 2020-07-13<br />location_name: Facility 65<br />p_days_reported:   0","week: 2020-07-20<br />location_name: Facility 65<br />p_days_reported:   0","week: 2020-07-27<br />location_name: Facility 65<br />p_days_reported:   0"],["week: 2020-05-11<br />location_name: Facility 7<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 7<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 7<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 7<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 7<br />p_days_reported:   0","week: 2020-06-15<br />location_name: Facility 7<br />p_days_reported:  71","week: 2020-06-22<br />location_name: Facility 7<br />p_days_reported: 100","week: 2020-06-29<br />location_name: Facility 7<br />p_days_reported: 100","week: 2020-07-06<br />location_name: Facility 7<br />p_days_reported:  86","week: 2020-07-13<br />location_name: Facility 7<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 7<br />p_days_reported: 100","week: 2020-07-27<br />location_name: Facility 7<br />p_days_reported:  71"],["week: 2020-05-11<br />location_name: Facility 9<br />p_days_reported:   0","week: 2020-05-18<br />location_name: Facility 9<br />p_days_reported:   0","week: 2020-05-25<br />location_name: Facility 9<br />p_days_reported:   0","week: 2020-06-01<br />location_name: Facility 9<br />p_days_reported:   0","week: 2020-06-08<br />location_name: Facility 9<br />p_days_reported:  86","week: 2020-06-15<br />location_name: Facility 9<br />p_days_reported: 100","week: 2020-06-22<br />location_name: Facility 9<br />p_days_reported: 100","week: 2020-06-29<br />location_name: Facility 9<br />p_days_reported: 100","week: 2020-07-06<br />location_name: Facility 9<br />p_days_reported: 100","week: 2020-07-13<br />location_name: Facility 9<br />p_days_reported: 100","week: 2020-07-20<br />location_name: Facility 9<br />p_days_reported:  57","week: 2020-07-27<br />location_name: Facility 9<br />p_days_reported:  71"]],"colorscale":[[0,"#FFA500"],[0.14,"#E09D00"],[0.29,"#BE9500"],[0.43,"#9F8C00"],[0.57,"#818300"],[0.71,"#617A00"],[0.86,"#3C6F00"],[1,"#006400"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18400],"y":[1],"name":"99_340dc5ec5783e326bc90a93c14ebe904","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FFA500"],[0.00334448160535117,"#FEA500"],[0.00668896321070234,"#FDA500"],[0.0100334448160535,"#FDA400"],[0.0133779264214047,"#FCA400"],[0.0167224080267559,"#FBA400"],[0.020066889632107,"#FAA400"],[0.0234113712374582,"#FAA400"],[0.0267558528428094,"#F9A400"],[0.0301003344481605,"#F8A300"],[0.0334448160535117,"#F7A300"],[0.0367892976588629,"#F7A300"],[0.040133779264214,"#F6A300"],[0.0434782608695652,"#F5A300"],[0.0468227424749164,"#F4A300"],[0.0501672240802676,"#F4A200"],[0.0535117056856187,"#F3A200"],[0.0568561872909699,"#F2A200"],[0.0602006688963211,"#F1A200"],[0.0635451505016722,"#F1A200"],[0.0668896321070234,"#F0A100"],[0.0702341137123746,"#EFA100"],[0.0735785953177258,"#EEA100"],[0.0769230769230769,"#EEA100"],[0.0802675585284281,"#EDA100"],[0.0836120401337793,"#ECA100"],[0.0869565217391304,"#EBA000"],[0.0903010033444816,"#EBA000"],[0.0936454849498328,"#EAA000"],[0.0969899665551839,"#E9A000"],[0.100334448160535,"#E8A000"],[0.103678929765886,"#E89F00"],[0.107023411371237,"#E79F00"],[0.110367892976589,"#E69F00"],[0.11371237458194,"#E59F00"],[0.117056856187291,"#E59F00"],[0.120401337792642,"#E49F00"],[0.123745819397993,"#E39E00"],[0.127090301003344,"#E29E00"],[0.130434782608696,"#E29E00"],[0.133779264214047,"#E19E00"],[0.137123745819398,"#E09E00"],[0.140468227424749,"#E09D00"],[0.1438127090301,"#DF9D00"],[0.147157190635452,"#DE9D00"],[0.150501672240803,"#DD9D00"],[0.153846153846154,"#DD9D00"],[0.157190635451505,"#DC9D00"],[0.160535117056856,"#DB9C00"],[0.163879598662207,"#DA9C00"],[0.167224080267559,"#DA9C00"],[0.17056856187291,"#D99C00"],[0.173913043478261,"#D89C00"],[0.177257525083612,"#D79B00"],[0.180602006688963,"#D79B00"],[0.183946488294314,"#D69B00"],[0.187290969899666,"#D59B00"],[0.190635451505017,"#D49B00"],[0.193979933110368,"#D49A00"],[0.197324414715719,"#D39A00"],[0.20066889632107,"#D29A00"],[0.204013377926421,"#D19A00"],[0.207357859531773,"#D19A00"],[0.210702341137124,"#D09900"],[0.214046822742475,"#CF9900"],[0.217391304347826,"#CE9900"],[0.220735785953177,"#CE9900"],[0.224080267558528,"#CD9900"],[0.22742474916388,"#CC9900"],[0.230769230769231,"#CB9800"],[0.234113712374582,"#CB9800"],[0.237458193979933,"#CA9800"],[0.240802675585284,"#C99800"],[0.244147157190635,"#C89800"],[0.247491638795987,"#C89700"],[0.250836120401338,"#C79700"],[0.254180602006689,"#C69700"],[0.25752508361204,"#C69700"],[0.260869565217391,"#C59700"],[0.264214046822742,"#C49600"],[0.267558528428094,"#C39600"],[0.270903010033445,"#C39600"],[0.274247491638796,"#C29600"],[0.277591973244147,"#C19600"],[0.280936454849498,"#C09500"],[0.284280936454849,"#C09500"],[0.287625418060201,"#BF9500"],[0.290969899665552,"#BE9500"],[0.294314381270903,"#BD9500"],[0.297658862876254,"#BD9400"],[0.301003344481605,"#BC9400"],[0.304347826086957,"#BB9400"],[0.307692307692308,"#BA9400"],[0.311036789297659,"#BA9400"],[0.31438127090301,"#B99300"],[0.317725752508361,"#B89300"],[0.321070234113712,"#B79300"],[0.324414715719064,"#B79300"],[0.327759197324415,"#B69300"],[0.331103678929766,"#B59200"],[0.334448160535117,"#B59200"],[0.337792642140468,"#B49200"],[0.341137123745819,"#B39200"],[0.344481605351171,"#B29200"],[0.347826086956522,"#B29100"],[0.351170568561873,"#B19100"],[0.354515050167224,"#B09100"],[0.357859531772575,"#AF9100"],[0.361204013377926,"#AF9100"],[0.364548494983278,"#AE9000"],[0.367892976588629,"#AD9000"],[0.37123745819398,"#AC9000"],[0.374581939799331,"#AC9000"],[0.377926421404682,"#AB9000"],[0.381270903010033,"#AA8F00"],[0.384615384615385,"#A98F00"],[0.387959866220736,"#A98F00"],[0.391304347826087,"#A88F00"],[0.394648829431438,"#A78E00"],[0.397993311036789,"#A78E00"],[0.40133779264214,"#A68E00"],[0.404682274247492,"#A58E00"],[0.408026755852843,"#A48E00"],[0.411371237458194,"#A48D00"],[0.414715719063545,"#A38D00"],[0.418060200668896,"#A28D00"],[0.421404682274247,"#A18D00"],[0.424749163879599,"#A18D00"],[0.42809364548495,"#A08C00"],[0.431438127090301,"#9F8C00"],[0.434782608695652,"#9E8C00"],[0.438127090301003,"#9E8C00"],[0.441471571906355,"#9D8C00"],[0.444816053511706,"#9C8B00"],[0.448160535117057,"#9B8B00"],[0.451505016722408,"#9B8B00"],[0.454849498327759,"#9A8B00"],[0.45819397993311,"#998A00"],[0.461538461538462,"#998A00"],[0.464882943143813,"#988A00"],[0.468227424749164,"#978A00"],[0.471571906354515,"#968A00"],[0.474916387959866,"#968900"],[0.478260869565217,"#958900"],[0.481605351170569,"#948900"],[0.48494983277592,"#938900"],[0.488294314381271,"#938900"],[0.491638795986622,"#928800"],[0.494983277591973,"#918800"],[0.498327759197324,"#908800"],[0.501672240802676,"#908800"],[0.505016722408027,"#8F8700"],[0.508361204013378,"#8E8700"],[0.511705685618729,"#8D8700"],[0.51505016722408,"#8D8700"],[0.518394648829431,"#8C8700"],[0.521739130434783,"#8B8600"],[0.525083612040134,"#8B8600"],[0.528428093645485,"#8A8600"],[0.531772575250836,"#898600"],[0.535117056856187,"#888600"],[0.538461538461538,"#888500"],[0.54180602006689,"#878500"],[0.545150501672241,"#868500"],[0.548494983277592,"#858500"],[0.551839464882943,"#858400"],[0.555183946488294,"#848400"],[0.558528428093645,"#838400"],[0.561872909698997,"#828400"],[0.565217391304348,"#828400"],[0.568561872909699,"#818300"],[0.57190635451505,"#808300"],[0.575250836120401,"#7F8300"],[0.578595317725753,"#7F8300"],[0.581939799331104,"#7E8200"],[0.585284280936455,"#7D8200"],[0.588628762541806,"#7C8200"],[0.591973244147157,"#7C8200"],[0.595317725752508,"#7B8200"],[0.598662207357859,"#7A8100"],[0.602006688963211,"#798100"],[0.605351170568562,"#798100"],[0.608695652173913,"#788100"],[0.612040133779264,"#778000"],[0.615384615384615,"#768000"],[0.618729096989967,"#768000"],[0.622073578595318,"#758000"],[0.625418060200669,"#747F00"],[0.62876254180602,"#737F00"],[0.632107023411371,"#737F00"],[0.635451505016722,"#727F00"],[0.638795986622074,"#717F00"],[0.642140468227425,"#707E00"],[0.645484949832776,"#707E00"],[0.648829431438127,"#6F7E00"],[0.652173913043478,"#6E7E00"],[0.655518394648829,"#6D7D00"],[0.658862876254181,"#6D7D00"],[0.662207357859532,"#6C7D00"],[0.665551839464883,"#6B7D00"],[0.668896321070234,"#6A7C00"],[0.672240802675585,"#6A7C00"],[0.675585284280937,"#697C00"],[0.678929765886288,"#687C00"],[0.682274247491639,"#677C00"],[0.68561872909699,"#677B00"],[0.688963210702341,"#667B00"],[0.692307692307692,"#657B00"],[0.695652173913043,"#647B00"],[0.698996655518395,"#637A00"],[0.702341137123746,"#637A00"],[0.705685618729097,"#627A00"],[0.709030100334448,"#617A00"],[0.712374581939799,"#607900"],[0.71571906354515,"#607900"],[0.719063545150502,"#5F7900"],[0.722408026755853,"#5E7900"],[0.725752508361204,"#5D7800"],[0.729096989966555,"#5C7800"],[0.732441471571906,"#5C7800"],[0.735785953177258,"#5B7800"],[0.739130434782609,"#5A7800"],[0.74247491638796,"#597700"],[0.745819397993311,"#587700"],[0.749163879598662,"#587700"],[0.752508361204013,"#577700"],[0.755852842809364,"#567600"],[0.759197324414716,"#557600"],[0.762541806020067,"#557600"],[0.765886287625418,"#547600"],[0.769230769230769,"#537500"],[0.77257525083612,"#527500"],[0.775919732441471,"#517500"],[0.779264214046823,"#507500"],[0.782608695652174,"#507400"],[0.785953177257525,"#4F7400"],[0.789297658862876,"#4E7400"],[0.792642140468227,"#4D7400"],[0.795986622073579,"#4C7300"],[0.79933110367893,"#4C7300"],[0.802675585284281,"#4B7300"],[0.806020066889632,"#4A7300"],[0.809364548494983,"#497200"],[0.812709030100334,"#487200"],[0.816053511705686,"#477200"],[0.819397993311037,"#467200"],[0.822742474916388,"#467100"],[0.826086956521739,"#457100"],[0.82943143812709,"#447100"],[0.832775919732441,"#437100"],[0.836120401337793,"#427000"],[0.839464882943144,"#417000"],[0.842809364548495,"#407000"],[0.846153846153846,"#3F7000"],[0.849498327759197,"#3F7000"],[0.852842809364548,"#3E6F00"],[0.8561872909699,"#3D6F00"],[0.859531772575251,"#3C6F00"],[0.862876254180602,"#3B6F00"],[0.866220735785953,"#3A6E00"],[0.869565217391304,"#396E00"],[0.872909698996656,"#386E00"],[0.876254180602007,"#376E00"],[0.879598662207358,"#366D00"],[0.882943143812709,"#356D00"],[0.88628762541806,"#346D00"],[0.889632107023411,"#336D00"],[0.892976588628763,"#326C00"],[0.896321070234114,"#316C00"],[0.899665551839465,"#306C00"],[0.903010033444816,"#2F6B00"],[0.906354515050167,"#2E6B00"],[0.909698996655518,"#2D6B00"],[0.91304347826087,"#2C6B00"],[0.916387959866221,"#2B6A00"],[0.919732441471572,"#2A6A00"],[0.923076923076923,"#296A00"],[0.926421404682274,"#286A00"],[0.929765886287625,"#266900"],[0.933110367892977,"#256900"],[0.936454849498328,"#246900"],[0.939799331103679,"#236900"],[0.94314381270903,"#226800"],[0.946488294314381,"#206800"],[0.949832775919732,"#1F6800"],[0.953177257525084,"#1D6800"],[0.956521739130435,"#1C6700"],[0.959866220735786,"#1B6700"],[0.963210702341137,"#196700"],[0.966555183946488,"#176700"],[0.969899665551839,"#166600"],[0.973244147157191,"#146600"],[0.976588628762542,"#126600"],[0.979933110367893,"#106600"],[0.983277591973244,"#0E6500"],[0.986622073578595,"#0B6500"],[0.989966555183946,"#086500"],[0.993311036789298,"#056500"],[0.996655518394649,"#036400"],[1,"#006400"]],"colorbar":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"thickness":22.6771653543307,"title":"Reporting<br />performance (%)","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":15.9402241594022},"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,0.25,0.5,0.75,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":13.2835201328352},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":44.8252386882524,"r":7.30593607305936,"b":45.7617268576173,"l":91.1913657119137},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"<b> Percent of days per week that facility reported data <\/b>","font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[18389.5,18473.5],"tickmode":"array","ticktext":["18<br />may.","01<br />jun.","15<br />jun.","29<br />jun.","13<br />jul.","27<br />jul."],"tickvals":[18400,18414,18428,18442,18456,18470],"categoryorder":"array","categoryarray":["18<br />may.","01<br />jun.","15<br />jun.","29<br />jun.","13<br />jul.","27<br />jul."],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.65296803652968,"tickwidth":0.531340805313408,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15.9402241594022},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"<b> Week <\/b>","font":{"color":"rgba(0,0,0,1)","family":"","size":15.9402241594022}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,15.6],"tickmode":"array","ticktext":["Facility 1","Facility 11","Facility 27","Facility 28","Facility 32","Facility 35","Facility 39","Facility 50","Facility 51","Facility 56","Facility 58","Facility 59","Facility 65","Facility 7","Facility 9"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"categoryorder":"array","categoryarray":["Facility 1","Facility 11","Facility 27","Facility 28","Facility 32","Facility 35","Facility 39","Facility 50","Facility 51","Facility 56","Facility 58","Facility 59","Facility 65","Facility 7","Facility 9"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.65296803652968,"tickwidth":0.531340805313408,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"<b> Facility name <\/b>","font":{"color":"rgba(0,0,0,1)","family":"","size":15.9402241594022}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":13.2835201328352}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["zoom2d","pan2d","lasso2d","select2d","zoomIn2d","zoomOut2d","autoScale2d","hoverClosestCartesian","toggleSpikelines","hoverCompareCartesian"]},"source":"A","attrs":{"2eca44d64":{"x":{},"y":{},"fill":{},"type":"heatmap"}},"cur_data":"2eca44d64","visdat":{"2eca44d64":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><!-- ## Maps {.unnumbered}   --><!-- You can also make `ggplot()` GIS maps interactive, although it makes a bit more care.  --><!-- THIS SECTION IS UNDER CONSTRUCTION  --><!-- Although **plotly** works well with `ggplot2::geom_sf` in RStudio, when you try to include its outputs in R Markdown HTML files (like this book), it doesn't work well.   --><!-- So instead you can use {**plotly**}'s own mapping tools which can be tricky but are easy when you know how. Read on...   --><!-- We're going to use Covid-19 incidence across African countries for this example. The data used can be found on the [World Health Organisation website](https://covid19.who.int/table).   --><!-- You'll also need a new type of file, a GeoJSON, which is sort of similar to a shp file for those familiar with GIS. For this book, we used one from [here](https://geojson-maps.ash.ms).   --><!-- GeoJSON files are stored in R as complex lists and you'll need to maipulate them a little. --><!-- ```{r, echo=T,} --><!-- ## You need two new packages: {rjson} and {purrr} --><!-- pacman::p_load(plotly, rjson, purrr) --><!-- ## This is a simplified version of the WHO data --><!-- df <- rio::import(here::here("data", "gis", "covid_incidence.csv")) --><!-- ## Load your geojson file --><!-- geoJSON <- rjson::fromJSON(file=here::here("data", "gis", "africa_countries.geo.json")) --><!-- ## Here are some of the properties for each element of the object --><!-- head(geoJSON$features[[1]]$properties) --><!-- ``` --><!-- This is the tricky part. For {**plotly**} to match your incidence data to GeoJSON, the countries in the geoJSON need an id in a specific place in the list of lists. For this we need to build a basic function: --><!-- ```{r} --><!-- ## The property column we need to choose here is "sovereignt" as it is the names for each country --><!-- give_id <- function(x){ --><!--   x$id <- x$properties$sovereignt  ## Take sovereignt from properties and set it as the id --><!--   return(x) --><!-- } --><!-- ## Use {purrr} to apply this function to every element of the features list of the geoJSON object --><!-- geoJSON$features <- purrr::map(.x = geoJSON$features, give_id) --><!-- ``` --><!-- <!-- ======================================================= --><p>–&gt;
<!-- ### Maps - plot {  } --></p>
<!-- UNDER CONSTRUCTION -->
<!-- ```{r, echo=FALSE, eval=FALSE, out.width=c('95%'), out.height=c('500px'),warning=F} -->
<!-- plotly::plot_ly() %>%  -->
<!--   plotly::add_trace(                    #The main plot mapping functionn -->
<!--     type="choropleth", -->
<!--     geojson=geoJSON, -->
<!--     locations=df$Name,          #The column with the names (must match id) -->
<!--     z=df$Cumulative_incidence,  #The column with the incidence values -->
<!--     zmin=0, -->
<!--     zmax=57008, -->
<!--     colorscale="Viridis", -->
<!--     marker=list(line=list(width=0)) -->
<!--   ) %>% -->
<!--   colorbar(title = "Cases per million") %>% -->
<!--   layout(title = "Covid-19 cumulative incidence", -->
<!--                  geo = list(scope = 'africa')) %>%  -->
<!--   config(displaylogo = FALSE, modeBarButtonsToRemove = plotly_buttons_remove) -->
<!-- ``` -->
<!-- ======================================================= -->
</div>
<div id="resources-29" class="section level2" number="38.5">
<h2>
<span class="header-section-number">38.5</span> Recursos<a class="anchor" aria-label="anchor" href="#resources-29"><i class="fas fa-link"></i></a>
</h2>
<p>Plotly no es sólo para R, también funciona bien con Python (y realmente con cualquier lenguaje de ciencia de datos, ya que está construido en JavaScript). Puedes leer más sobre él en el <a href="https://plotly.com/r/">sitio web de plotly</a></p>

</div>
</div>



<p>Informes con R Markdown {#reports-with-r-markdown}</p>
<div class="inline-figure"><img src="images/markdown/rmarkdown_overview.png" width="100%" style="display: block; margin: auto;"></div>
<p>R Markdown es una herramienta ampliamente utilizada para crear documentos de salida automatizados, reproducibles y dignos de compartir, como por ejemplo, informes. Podés generar resultados estáticos o interactivos en Word, pdf, html, powerpoint y otros formatos.</p>
<p>Un script de R Markdown intercala código R y texto de tal manera que el script <em>se convierte en tu documento de salida</em>. Puedes crear un documento completo con formato, incluyendo texto narrativo (el texto puede ser dinámico y cambiar en función de sus datos), tablas, figuras, viñetas/números, bibliografías, etc.</p>
<p>Estos documentos pueden producirse para ser actualizados de forma rutinaria (por ejemplo, informes de vigilancia diarios) y/o ejecutarse sobre subconjuntos de datos (por ejemplo, informes para cada jurisdicción).</p>
<p>Otras páginas de este manual amplían este tema:</p>
<ul>
<li>La página <a href="organizing-routine-reports.html#organizing-routine-reports">Organización de informes de rutina</a> muestra cómo “rutinizar” la producción de informes con carpetas autogeneradas con marca de tiempo.</li>
<li>La página <a href="dashboards-with-r-markdown.html#dashboards-with-r-markdown">Dashboards con R Markdown</a> explica cómo formatear un informe de R Markdown como un cuadro de mando o tablero de control.</li>
</ul>
<p>Cabe destacar que el proyecto <a href="https://r4epis.netlify.app/">R4Epis</a> ha desarrollado plantillas de scripts R Markdown para los escenarios de brotes y encuestas de uso frcuente en lugares en donde MSF maneja proyectos.</p>
<!-- ======================================================= -->
<div id="preparation-31" class="section level2" number="38.6">
<h2>
<span class="header-section-number">38.6</span> Preparación<a class="anchor" aria-label="anchor" href="#preparation-31"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Antecedentes de R Markdown</strong></p>
<p>Explicamos algunos de los conceptos y paquetes involucrados:</p>
<ul>
<li>
<strong>Markdown</strong> es un “lenguaje” que permite escribir un documento en texto plano, que se puede convertir a html y otros formatos. No es específico de R. Los archivos escritos en Markdown tienen una extensión ‘.md’.</li>
<li>R <strong>Markdown</strong>: es una variación de markdown que <em>es específica de R</em> - te permite escribir un documento usando markdown para producir texto <em>y para integrar código R y mostrar sus resultados</em>. Los archivos R Markdown tienen la extensión ‘.Rmd’.</li>
<li>
<strong>rmarkdown - el paquete</strong>: Usado por R para convertir el archivo .Rmd en el tipo de documento de salida deseado. Su objetivo es convertir la sintaxis markdown (texto), por lo que también necesitamos…</li>
<li>
<strong>knitr</strong>: Este paquete de R leerá los trozos de código, los ejecutará y los “tejerá” dentro del documento. Así es como se incluyen las tablas y los gráficos junto al texto.</li>
<li>
<strong>Pandoc</strong>: Por último, pandoc convierte el documento de salida en word/pdf/powerpoint, etc. Es un software independiente de R, y viene instalado automáticamente con RStudio.</li>
</ul>
<p>En resumen, el proceso que ocurre <em>en segundo plano</em> (¡no es necesario que conozcas todos estos pasos!) consiste en alimentar el archivo .Rmd a <strong>knitr</strong>, que ejecuta los trozos de código R y crea un nuevo archivo .md (markdown) que incluye el código R y su salida renderizada. El archivo .md es entonces procesado por pandoc para crear el producto final: un documento de Microsoft Word, un archivo HTML, un documento powerpoint, un pdf, etc.</p>
<div class="inline-figure"><img src="images/markdown/0_rmd.png" width="100%" style="display: block; margin: auto;"></div>
<p>(fuente: <a href="https://rmarkdown.rstudio.com/authoring_quick_tour.html" class="uri">https://rmarkdown.rstudio.com/authoring_quick_tour.html</a>):</p>
<p><strong>Instalación</strong></p>
<p>Para crear una salida de R Markdown, necesitas tener instalado lo siguiente:</p>
<ul>
<li>El paquete <strong>rmarkdown</strong> (<strong>knitr</strong> también se instalará automáticamente)</li>
<li>Pandoc, que debería venir instalado con RStudio. Si no utilizas RStudio, podés descargar Pandoc aquí: <a href="http://pandoc.org" class="uri">http://pandoc.org</a> .</li>
<li>Si querés generar una salida en PDF (un poco más complicado), necesitarás instalar LaTeX. Para los usuarios de R Markdown que no hayan instalado LaTeX antes, recomendamos que instalen TinyTeX (<a href="https://yihui.name/tinytex/)https://yihui.name/tinytex/" class="uri">https://yihui.name/tinytex/)https://yihui.name/tinytex/</a>). Puedes utilizar los siguientes comandos:</li>
</ul>
<div class="sourceCode" id="cb1739"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tinytex</span><span class="op">)</span>     <span class="co"># install tinytex package</span>
<span class="fu">tinytex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytex/man/install_tinytex.html">install_tinytex</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># R command to install TinyTeX software</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="getting-started" class="section level2" number="38.7">
<h2>
<span class="header-section-number">38.7</span> Cómo empezar<a class="anchor" aria-label="anchor" href="#getting-started"><i class="fas fa-link"></i></a>
</h2>
<div id="instalar-el-paquete-r-rmarkdown-install-rmarkdown-r-package" class="section level3 unnumbered">
<h3>Instalar el paquete R rmarkdown {#install-rmarkdown-r-package}<a class="anchor" aria-label="anchor" href="#instalar-el-paquete-r-rmarkdown-install-rmarkdown-r-package"><i class="fas fa-link"></i></a>
</h3>
<p>Instalá el paquete R <strong>rmarkdown</strong>. En este manual destacamos p_load() de <strong>pacman</strong>, que instala el paquete si es necesario <em>y ademas</em> lo carga para su uso. También podés cargar los paquetes instalados con <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> de R <strong>base</strong>. Consultá la página sobre <a href="r-basics.html#r-basics">fundamentos de R</a> para obtener más información sobre los paquetes de R.</p>
<div class="sourceCode" id="cb1740"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">rmarkdown</span><span class="op">)</span></code></pre></div>
</div>
<div id="iniciar-un-nuevo-archivo-rmd-starting-a-new-rmd-file" class="section level3 unnumbered">
<h3>Iniciar un nuevo archivo Rmd {#starting-a-new-rmd-file}<a class="anchor" aria-label="anchor" href="#iniciar-un-nuevo-archivo-rmd-starting-a-new-rmd-file"><i class="fas fa-link"></i></a>
</h3>
<p>En RStudio, abrí un nuevo archivo R markdown, comenzando con ‘File’, luego ‘New file’ luego ‘R markdown…’.</p>
<div class="inline-figure"><img src="images/markdown/1_gettingstarted.png" width="50%" style="display: block; margin: auto;"></div>
<p>R Studio te dará algunas opciones de salida para elegir. En el ejemplo siguiente seleccionamos “HTML” porque queremos crear un documento html. El título y los nombres de los autores no son importantes. Si el tipo de documento de salida que desea no es uno de estos, no te preocupes - podés elegir cualquiera y cambiarlo en el script más tarde.</p>
<div class="inline-figure"><img src="images/markdown/1_gettingstartedB.png" width="50%" style="display: block; margin: auto;"></div>
<p>Esto abrirá un nuevo script .Rmd.</p>
</div>
<div id="es-importante-saber-important-to-know" class="section level3 unnumbered">
<h3>Es importante saber {#important-to-know}<a class="anchor" aria-label="anchor" href="#es-importante-saber-important-to-know"><i class="fas fa-link"></i></a>
</h3>
<p><strong>El directorio de trabajo</strong></p>
<p>El directorio de trabajo de un archivo markdown es el lugar donde se guarda el propio archivo Rmd. Por ejemplo, si el proyecto R está dentro de <code>~/Documents/projectX</code> y el archivo Rmd en sí está en una subcarpeta <code>~/Documents/projectX/markdownfiles/markdown.Rmd</code>, el código <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv("data.csv")</a></code> dentro del markdown buscará un archivo csv en la carpeta <code>markdownfiles</code>, y no en la carpeta raíz del proyecto donde los scripts dentro de los proyectos normalmente buscarían archivos de manera automática.</p>
<p>Para referirse a archivos en otro lugar, tendrá que utilizar la ruta completa del archivo o utilizar el paquete <strong>here</strong>. El paquete <strong>here</strong> establece el directorio de trabajo en la carpeta raíz del proyecto R y se explica en detalle en las páginas de <a href="r-projects.html#r-projects">proyectos R</a> e <a href="import-and-export.html#import-and-export">importación y exportación</a> de este manual. Por ejemplo, para importar un archivo llamado “data.csv” desde la carpeta <code>projectX</code>, el código sería <code><a href="https://rdrr.io/pkg/rio/man/import.html">import(here("data.csv"))</a></code>.</p>
<p>Ten en cuenta que no se recomienda el uso de <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> en los scripts de R Markdown - sólo se aplica al trozo de código en el que está escrito.</p>
<p><strong>Trabajar en una unidad versus tu ordenador</strong></p>
<p>Debido a que R Markdown puede tener problemas con pandoc cuando se ejecuta en una unidad de red compartida, se recomienda que la carpeta esté ubicada en tu máquina local, por ejemplo, en un proyecto dentro de ‘Mis Documentos’. Si utilizas Git (¡super recomendable!), esto te resultará familiar. Para más detalles, consulta las páginas del manual sobre <a href="r-on-network-drives.html#r-on-network-drives">R en unidades de red</a> y <a href="common-errors.html#common-errors">Errores y ayuda</a>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="r-markdown-components" class="section level2" number="38.8">
<h2>
<span class="header-section-number">38.8</span> Componentes de R Markdown<a class="anchor" aria-label="anchor" href="#r-markdown-components"><i class="fas fa-link"></i></a>
</h2>
<p>Un documento R Markdown puede ser editado en RStudio igual que un script estándar de R. Cuando se inicia un nuevo script de R Markdown, RStudio intenta ayudarnos mostrando una plantilla que explica las diferentes secciones de un script de R Markdown.</p>
<p>Lo que aparece a continuación es lo que veremos al iniciar un nuevo script Rmd destinado a producir un documento de salida en html (según la sección anterior).</p>
<div class="inline-figure"><img src="images/markdown/2_defaultRMD.png" width="100%" style="display: block; margin: auto;"></div>
<p>Como puedes ver, hay tres componentes básicos en un archivo Rmd: YAML, texto Markdown y trozos de código R.</p>
<p>Estos <em>crearán y se convertirán en la salida de su documento</em>. Consulta el siguiente diagrama:</p>
<div class="inline-figure"><img src="images/markdown/rmarkdown_translation.png" width="100%" height="150%" style="display: block; margin: auto;"></div>
<div id="metadatos-yaml-yaml-metadata" class="section level3 unnumbered">
<h3>Metadatos YAML {#yaml-metadata}<a class="anchor" aria-label="anchor" href="#metadatos-yaml-yaml-metadata"><i class="fas fa-link"></i></a>
</h3>
<p>Denominado ‘metadatos YAML’ o simplemente ‘YAML’, se encuentra en la parte superior del documento R Markdown. Esta sección del script le dirá a su archivo Rmd qué tipo de salida producir, preferencias de formato y otros metadatos como el título del documento, el autor y la fecha. Hay otros usos que no se mencionan aquí (pero a los que se hace referencia en ‘Producción del documento de salida’). Ten en cuenta que la sangría es importante; los tabuladores no se aceptan, pero los espacios sí.</p>
<p>Esta sección debe comenzar con una línea que contenga sólo tres guiones <code>---</code> y debe cerrar con una línea que contenga sólo tres guiones <code>---</code>. Los parámetros YAML vienen en pares <code>key:value</code>. La colocación de los dos puntos en YAML es importante - los pares <code>key:value</code> están separados por dos puntos (¡no por signos de igualdad!).</p>
<p>El YAML debe comenzar con los metadatos del documento. El orden de estos parámetros YAML primarios (sin sangría) no importa. Por ejemplo:</p>
<div class="sourceCode" id="cb1741"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1741-1"><a href="interactive-plots.html#cb1741-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"My document"</span></span>
<span id="cb1741-2"><a href="interactive-plots.html#cb1741-2" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Me"</span></span>
<span id="cb1741-3"><a href="interactive-plots.html#cb1741-3" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> </span><span class="st">"2021-11-22"</span></span></code></pre></div>
<p>Puedes utilizar código R en valores YAML escribiéndolo como código en línea (precedido por <code>r</code> entre comillas) pero también entre comillas (véase el ejemplo anterior para <code>date:</code>).</p>
<p>En la imagen de arriba, porque hemos seleccionado el tipo de documento de salida como html, podemos ver que el YAML dice <code>output: html_document</code>. Sin embargo, también podemos cambiar esto escribir <code>powerpoint_presentation</code> o <code>word_document</code> o incluso <code>pdf_document</code>.</p>
</div>
<div id="texto-text" class="section level3 unnumbered">
<h3>Texto {#text}<a class="anchor" aria-label="anchor" href="#texto-text"><i class="fas fa-link"></i></a>
</h3>
<p>Esta es la narrativa de t u documento, incluyendo los títulos y encabezados. Está escrito en el lenguaje “markdown”, que se utiliza en muchos otros programas.</p>
<p>A continuación se presentan las formas principales de escribir este texto. Podés consultar material de referencia más detallado disponible en R Markdown “cheatsheet” en el <a href="https://rstudio.com/resources/cheatsheets/">sitio web de RStudio</a>.</p>
<div id="nuevas-líneas" class="section level4 unnumbered">
<h4>Nuevas líneas<a class="anchor" aria-label="anchor" href="#nuevas-l%C3%ADneas"><i class="fas fa-link"></i></a>
</h4>
<p>En R Markdown, para iniciar una nueva línea, introducí *dos espacios** al final de la línea anterior y luego Enter/Return. Esto es una particularidad de R Markdown.</p>
</div>
<div id="formato-de-texto" class="section level4 unnumbered">
<h4>Formato de texto<a class="anchor" aria-label="anchor" href="#formato-de-texto"><i class="fas fa-link"></i></a>
</h4>
<p>Rodea el texto normal con estos caracteres para cambiar su apariencia en la salida.</p>
<ul>
<li>Guiones bajos (<code>_texto_</code>) o un asterisco simple (<code>*texto*</code>) para <em>poner en cursiva</em> (itálica)</li>
<li>Doble asterisco (<code>**texto**</code>) para el <strong>texto en negrita</strong>
</li>
<li>Comillas invertidas <code>(texto)</code> para mostrar el texto como código</li>
</ul>
<p>El aspecto real de la fuente puede establecerse utilizando plantillas específicas (especificadas en los metadatos YAML; ver sub-secciones de este capitulo).</p>
</div>
<div id="color" class="section level4 unnumbered">
<h4>Color<a class="anchor" aria-label="anchor" href="#color"><i class="fas fa-link"></i></a>
</h4>
<p>No existe un mecanismo sencillo para cambiar el color del texto en R Markdown. Como solución, <em>si tu salida es un archivo HTML</em>, es añadir una línea de codigo HTML en el texto de Markdown. El siguiente código HTML imprimirá una línea de texto en negrita roja.</p>
<div class="sourceCode" id="cb1742"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1742-1"><a href="interactive-plots.html#cb1742-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;span</span><span class="ot"> style=</span><span class="st">"color: red;"</span><span class="kw">&gt;</span>**_PELIGRO:_** Esto es una advertencia.<span class="kw">&lt;/span&gt;</span>  </span></code></pre></div>
<p><span style="color: red;"><strong><em>PELIGRO:</em></strong> Esto es una advertencia.</span></p>
</div>
<div id="títulos-y-encabezamientos" class="section level4 unnumbered">
<h4>Títulos y encabezamientos<a class="anchor" aria-label="anchor" href="#t%C3%ADtulos-y-encabezamientos"><i class="fas fa-link"></i></a>
</h4>
<p>Un símbolo de almohadilla (hash #) delante de un texto en un script de R Markdown crea un encabezado. Esto es diferente que en un trozo de código R en el script, en el que un símbolo de almohadilla permite comentar/anotar/desactivar, como en un script normal de R.</p>
<p>Los distintos niveles de encabezamiento se establecen con diferentes números de símbolos de almohadilla al comienzo de una nueva línea. Un solo símbolo de almohadilla genera un título o encabezamiento primario. Dos símbolos hash generan un encabezamiento de segundo nivel. Los encabezamientos de tercer y cuarto nivel pueden hacerse con más símbolos hash sucesivamente.</p>
<div class="sourceCode" id="cb1743"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1743-1"><a href="interactive-plots.html#cb1743-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Encabezamiento / título de primer nivel</span></span>
<span id="cb1743-2"><a href="interactive-plots.html#cb1743-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1743-3"><a href="interactive-plots.html#cb1743-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Encabezamiento de segundo nivel</span></span>
<span id="cb1743-4"><a href="interactive-plots.html#cb1743-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1743-5"><a href="interactive-plots.html#cb1743-5" aria-hidden="true" tabindex="-1"></a><span class="fu">### Encabezamiento de tercer nivel</span></span></code></pre></div>
</div>
<div id="viñetas-y-numeración" class="section level4 unnumbered">
<h4>Viñetas y numeración<a class="anchor" aria-label="anchor" href="#vi%C3%B1etas-y-numeraci%C3%B3n"><i class="fas fa-link"></i></a>
</h4>
<p>Utilizá asteriscos (<code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code>) para crear una lista de viñetas. Completá la frase anterior, introducí dos espacios, presioná Enter/Return <em>dos veces</em>, y luego comenzá tus viñetas. Incluí un espacio entre el asterisco y el texto de tu viñeta. Después de cada viñeta, introducí dos espacios y luego presioná Enter/Return. Las sub-viñetas funcionan de la misma manera pero con sangría. Los números funcionan de la misma manera, pero en lugar de un asterisco, escribí 1), 2), etc. El texto de tu script de R Markdown se vería como mostramos a continuación.</p>
<div class="sourceCode" id="cb1744"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1744-1"><a href="interactive-plots.html#cb1744-1" aria-hidden="true" tabindex="-1"></a>Aquí están mis viñetas (hay dos espacios después de los dos puntos):</span>
<span id="cb1744-2"><a href="interactive-plots.html#cb1744-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1744-3"><a href="interactive-plots.html#cb1744-3" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Viñeta 1 (seguida de dos espacios y Enter/Return)</span>
<span id="cb1744-4"><a href="interactive-plots.html#cb1744-4" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Viñeta 2 (seguida de dos espacios y Enter/Return)</span>
<span id="cb1744-5"><a href="interactive-plots.html#cb1744-5" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Sub-viñeta 1 (seguida de dos espacios y Enter/Return)</span>
<span id="cb1744-6"><a href="interactive-plots.html#cb1744-6" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Sub-viñeta 2 (seguida de dos espacios y Enter/Return)</span>
<span id="cb1744-7"><a href="interactive-plots.html#cb1744-7" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Subbalanceo 2 (seguido de dos espacios y Enter/Return)</span></code></pre></div>
</div>
<div id="comentar-el-texto" class="section level4 unnumbered">
<h4>Comentar el texto<a class="anchor" aria-label="anchor" href="#comentar-el-texto"><i class="fas fa-link"></i></a>
</h4>
<p>Puedes desactivar o “esconder” el texto de R Markdown del mismo modo que puede utilizar el “#” para desactivar una línea de código en un chunk de R. Simplemente resalta el texto y clica Ctrl+Mayús+c (Cmd+Mayús+c para Mac). El texto aparecerá rodeado de flechas y se volverá verde. No aparecerá en tu salida.</p>
<div class="inline-figure"><img src="images/markdown/rmarkdown_hide_text.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="trozos-de-código-chunks-code-chunks" class="section level3 unnumbered">
<h3>Trozos de código (chunks) {#code-chunks}<a class="anchor" aria-label="anchor" href="#trozos-de-c%C3%B3digo-chunks-code-chunks"><i class="fas fa-link"></i></a>
</h3>
<p>Las secciones del script que se dedican a ejecutar el código R se denominan “chunks” o trozos. Aquí es donde se pueden cargar paquetes, importar datos y realizar la gestión y visualización de datos propiamente dicha. Puede haber muchos trozos de código, por lo que puede ser de ayuda organizar tu código R en partes, quizás intercaladas con texto. Para tener en cuenta: estos trozos tendrán un color de fondo ligeramente diferente al de la parte narrativa del documento.</p>
<p>Cada trozo se abre con una línea que comienza con tres comillas invertidas y corchetes que contienen parámetros para el trozo (<code>{ }</code>). El trozo termina con otras tres comillas invertidas.</p>
<p>Puedes crear un nuevo fragmento escribiendo tú mismo las marcas, utilizando el atajo de teclado “Ctrl + Alt + i” (o Cmd + Shift + r en Mac), o clicando en el icono verde ‘insert a new code chunk’ en la parte superior de tu editor de scripts.</p>
<p>Algunas notas sobre el contenido de las corchetes <code>{ }</code>:</p>
<ul>
<li>Empiezan con una “r” para indicar que el nombre del idioma dentro del chunk es R</li>
<li>Después de la r puedes asignarle un “nombre” al chunk - no es necesario pero puede ayudarte a organizar tu trabajo. Ten en cuenta que si nombras tus chunks, debes usar SIEMPRE nombres únicos o de lo contrario R se quejará cuando intentes procesarlos.</li>
<li>Los corchetes pueden incluir también otras opciones, escritas como <code>tag=value</code>, como por ejemplo</li>
<li>
<code>eval = FALSE</code> para no ejecutar el código R
<ul>
<li>
<code>echo = FALSE</code> para no imprimir o esconder el código fuente de R del chunk en el documento de salida</li>
<li>
<code>warning = FALSE</code> para no imprimir las advertencias producidas por el código R</li>
<li>
<code>message = FALSE</code> para no imprimir ningún mensaje producido por el código R</li>
<li>
<code>include = TRUE/FALSE</code> para incluir (o no) los resultados generados por los trozos (por ejemplo, los gráficos) en el documento de salida</li>
<li>
<code>out.width =</code> y <code>out.height =</code> - asigna proporciones de ancho y largo, por ejemplo <code>out.width = "75%"</code>
</li>
<li>
<code>fig.align = "center"</code> ajusta cómo se alinea una figura en la página</li>
<li>
<code>fig.show = 'hold'</code> si tu chunk imprime múltiples figuras y querés imprimirlas una al lado de la otra usá también la función<code>out.width = c("33%", "67%")</code>. También podés establecer como <code>fig.show='asis'</code> para mostrarlas debajo del código que las genera, <code>'hide'</code> para ocultarlas, o <code>'animate'</code> para concatenar varias figuras en una animación.</li>
</ul>
</li>
<li>La cabecera de un trozo debe escribirse en <em>una sola línea</em>
</li>
<li>Intentá evitar puntos, barras bajas y espacios. Utiliza guiones ( - ) en su lugar si necesitas un separador.</li>
</ul>
<p>Leé más extensamente sobre las opciones de <strong>knitr</strong> <a href="https://yihui.org/knitr/options/">aquí</a>.</p>
<p>Algunas de estas opciones pueden configurarse usando los botones de configuración situados en la parte superior derecha del chunk. Aquí puedes especificar qué partes del chunk quieres incluir en el documento renderizado, es decir, el código, las salidas generadas y las advertencias. Estas preferencias aparecerán escritas como código dentro de los corchetes, por ejemplo, si especificás que querés mostrar sólo la salida (‘Show output only’) aparecerá <code>echo=FALSE</code> entre los corchetes.</p>
<div class="inline-figure"><img src="images/markdown/3_chunk.png" width="80%" style="display: block; margin: auto;"></div>
<p>También hay dos flechas en la parte superior derecha de cada trozo, que son útiles para ejecutar el código dentro de un trozo, o todo el código en trozos anteriores. Pasa el cursor por encima de estos iconos para ver lo que hacen.</p>
<p>Para que las opciones globales se apliquen a todos los chunks del script, podés configurar esto dentro del primer chunk de código R en el script. Por ejemplo, para sólo muestrar las salidas generadas por cada trozo de código y no el propio código, podés incluir este comando en el trozo de código R:</p>
<div class="sourceCode" id="cb1745"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<div id="código-r-en-el-texto" class="section level4 unnumbered">
<h4>Código R en el texto<a class="anchor" aria-label="anchor" href="#c%C3%B3digo-r-en-el-texto"><i class="fas fa-link"></i></a>
</h4>
<p>También se puede insertar un mínimo de código R entre comillas invertidas (back ticks) intercalado entre el texto narrativo. Dentro de las comillas invertidas, comenzá el código con la letra “r” y un espacio, para que RStudio sepa que debe evaluar el código como código R. Ver el siguiente ejemplo.</p>
<p>El ejemplo siguiente muestra múltiples niveles de encabezamiento, viñetas, y utiliza el código (<code><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date()</a></code>) para obtener y mostrar la fecha actual.</p>
<div class="inline-figure"><img src="images/markdown/2_text.png" width="80%" style="display: block; margin: auto;"></div>
<p>El ejemplo anterior es sencillo (muestra la fecha actual), pero utilizando la misma sintaxis puede mostrar valores producidos por un código R más complejo (por ejemplo, para calcular el mínimo, la mediana o el máximo de una columna). También podés integrar objetos R o valores que han sido creados en trozos de código R anteriores.</p>
<p>Como ejemplo, el siguiente script calcula la proporción de casos que tienen menos de 18 años, utilizando funciones <strong>tidyverse</strong>, y crea los objetos <code>less18</code>, <code>total</code> y <code>less18prop</code>. Este valor dinámico se inserta en el texto narrativo. Vemos cómo queda cuando se teje en un documento de Word.</p>
<div class="inline-figure"><img src="images/markdown/3_chunktext.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="imágenes-images" class="section level3 unnumbered">
<h3>Imágenes {images}<a class="anchor" aria-label="anchor" href="#im%C3%A1genes-images"><i class="fas fa-link"></i></a>
</h3>
<p>Hay dos maneras de incluir imágenes en R Markdown:</p>
<div class="sourceCode" id="cb1746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1746-1"><a href="interactive-plots.html#cb1746-1" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>[](<span class="st">"path/to/image.png"</span>)  </span></code></pre></div>
<p>Si el código anterior no funciona, probá utilizar <code><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">knitr::include_graphics()</a></code></p>
<div class="sourceCode" id="cb1747"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"path/to/image.png"</span><span class="op">)</span></code></pre></div>
<p>(recordá que podes declarar la ruta de tu archivo usando el paquete <strong>here</strong>)</p>
<div class="sourceCode" id="cb1748"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"path"</span>, <span class="st">"to"</span>, <span class="st">"image.png"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="tablas-tables" class="section level3 unnumbered">
<h3>Tablas {#tables}<a class="anchor" aria-label="anchor" href="#tablas-tables"><i class="fas fa-link"></i></a>
</h3>
<p>Creá una tabla utilizando guiones ( - ) y barras ( | ). El número de guiones entre las barras determina el número de espacios en la celda a patrir del cual el texto comienza a envolverse.</p>
<div class="sourceCode" id="cb1749"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1749-1"><a href="interactive-plots.html#cb1749-1" aria-hidden="true" tabindex="-1"></a>Column  1 |Column   2 |Column 3</span>
<span id="cb1749-2"><a href="interactive-plots.html#cb1749-2" aria-hidden="true" tabindex="-1"></a>----------|-----------|--------</span>
<span id="cb1749-3"><a href="interactive-plots.html#cb1749-3" aria-hidden="true" tabindex="-1"></a>Cell A    |Cell B     |Cell C</span>
<span id="cb1749-4"><a href="interactive-plots.html#cb1749-4" aria-hidden="true" tabindex="-1"></a>Cell D    |Cell E     |Cell F</span></code></pre></div>
<p>El código anterior produce la siguiente tabla:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Column 1</th>
<th>Column 2</th>
<th>Column 3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Cell A</td>
<td>Cell B</td>
<td>Cell C</td>
</tr>
<tr class="even">
<td>Cell D</td>
<td>Cell E</td>
<td>Cell F</td>
</tr>
</tbody>
</table></div>
</div>
<div id="secciones-con-pestañas-tabbed-sections" class="section level3 unnumbered">
<h3>Secciones con pestañas {#tabbed-sections}<a class="anchor" aria-label="anchor" href="#secciones-con-pesta%C3%B1as-tabbed-sections"><i class="fas fa-link"></i></a>
</h3>
<p>Para las salidas HTML, podés organizar las secciones con “pestañas”. Basta con añadir <code>.tabset</code> entre las llaves <code>{ }</code> que se colocan <em>después de un encabezamiento</em>. Todos los subtítulos debajo de ese encabezado (hasta el próximo encabezado del mismo nivel) aparecerán como pestañas en las que el usuario puedes clicar. Lee más <a href="https://bookdown.org/yihui/rmarkdown-cookbook/html-tabs.html">aquí</a></p>
<p><img src="images/markdown/tabbed_script.png" width="100%" style="display: block; margin: auto;"><img src="images/markdown/tabbed_view.gif" width="100%" style="display: block; margin: auto;"></p>
<p>Puedes añadir una opción adicional <code>.tabset-pills</code> después de <code>.tabset</code> para dar a las pestañas una apariencia “en forma de píldora”. Ten en cuenta que al ver la salida HTML con etiquetas, la funcionalidad de búsqueda Ctrl+f sólo buscará en las etiquetas “activas”, no en las ocultas.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="file-structure" class="section level2" number="38.9">
<h2>
<span class="header-section-number">38.9</span> Estructura de los archivos<a class="anchor" aria-label="anchor" href="#file-structure"><i class="fas fa-link"></i></a>
</h2>
<p>Hay varias maneras de estructurar el archivo de R Markdown y sus scripts de R asociados. Cada una tiene sus ventajas y desventajas:</p>
<ul>
<li>R Markdown autónomo - todo lo necesario para el informe se importa o se crea dentro del R Markdown
<ul>
<li>Ubicar otros archivos - Podés ejecutar scripts R externos con el comando <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> y utilizar sus salidas en el Rmd</li>
<li>Scripts hijos - un mecanismo alternativo para <code><a href="https://rdrr.io/r/base/source.html">source()</a></code><br>
</li>
</ul>
</li>
<li>Utilizar un “archivo de ejecución” - Ejecutar comandos en un script R <em>antes</em> de renderizar el R Markdown</li>
</ul>
<div id="rmd-autónomo-self-contained-rmd" class="section level3 unnumbered">
<h3>Rmd autónomo {#self-contained-rmd}<a class="anchor" aria-label="anchor" href="#rmd-aut%C3%B3nomo-self-contained-rmd"><i class="fas fa-link"></i></a>
</h3>
<p>Para un informe relativamente sencillo, puedes optar por organizar tu script de R Markdown de manera que sea “autosuficiente” y no implique utilizar ningún script externo.</p>
<p>Todo lo que se necesite para ejecutar el R Markdown se importa o se crea dentro del archivo Rmd, incluyendo todos los trozos de código y la carga de paquetes. Este enfoque “autosuficiente” es apropiado cuando no necesitás hacer mucho procesamiento de datos (por ejemplo, cuando se importa un archivo de datos limpio o semilimpio) y el procesamiento del R Markdown no tomará demasiado tiempo.</p>
<p>En este escenario, una organización lógica del script de R Markdown podría ser:</p>
<ol style="list-style-type: decimal">
<li>Establecer las opciones globales de <strong>knitr</strong>
</li>
<li>Cargar paquetes</li>
<li>Importar los datos</li>
<li>Procesar los datos</li>
<li>Generar resultados (tablas, gráficos, etc.)</li>
<li>Guardar los resultados, si procede (.csv, .png, etc.)</li>
</ol>
<div id="source-other-files" class="section level4 unnumbered">
<h4>Source other files<a class="anchor" aria-label="anchor" href="#source-other-files"><i class="fas fa-link"></i></a>
</h4>
<p>Una variación del enfoque “autocontenido” es hacer que los trozos de código R Markdown “originen” (ejecuten) otros scripts R. Esto puede hacer que tu script de R Markdown sea menos desordenado, más simple y más fácil de organizar. También puede ayudar si quieres mostrar las cifras finales al principio del informe. En este enfoque, el script de R Markdown final simplemente combina las salidas preprocesadas en un documento.</p>
<p>Una forma de hacerlo es proporcionando los scripts de R (ruta del archivo y nombre con extensión) al comando R <strong>base</strong> <code><a href="https://rdrr.io/r/base/source.html">source()</a></code>.</p>
<div class="sourceCode" id="cb1750"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"your-script.R"</span>, local <span class="op">=</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/knit_global.html">knit_global</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># or sys.source("your-script.R", envir = knitr::knit_global())</span></code></pre></div>
<p>Ten en cuenta que cuando se utiliza <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> <em>dentro</em> de R Markdown, los archivos externos se seguirán ejecutando durante el <em>curso del procesamiento de tu archivo Rmd</em>. Por lo tanto, cada script se ejecuta cada vez que se procesa el informe. Por lo tanto, tener estos comandos <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> <em>dentro del R Markdown</em> no acelera el tiempo de ejecución, ni ayuda mucho a la depuración, ya que el error producido todavía se imprimirá al producir el R Markdown.</p>
<p>Una alternativa es utilizar la opción <code>child =</code> <strong>knitr</strong>. EXPLICAR MÁS PARA HACER</p>
<p>Debes ser consciente de los distintos <em>entorno</em> de R. Los objetos creados dentro de un entorno no estarán necesariamente disponibles para el entorno utilizado por R Markdown.</p>
</div>
</div>
<div id="ejecutar-archivo-runfile" class="section level3 unnumbered">
<h3>Ejecutar archivo {#runfile}<a class="anchor" aria-label="anchor" href="#ejecutar-archivo-runfile"><i class="fas fa-link"></i></a>
</h3>
<p>Este enfoque implica utilizar el script de R que contiene el comando(s) <code>render()</code> para preprocesar los objetos que se introducen en el R markdown.</p>
<p>Por ejemplo, puede cargar los paquetes, cargar y limpiar los datos, e incluso crear los gráficos de interés antes de <code>render()</code>. Estos pasos pueden ocurrir en el script de R, o en otros scripts que se originan. Siempre y cuando estos comandos ocurran en la misma sesión de RStudio y los objetos se guarden en el entorno, los objetos pueden ser llamados dentro del contenido de Rmd. Entonces el propio R markdown sólo se utilizará para el paso final - para producir la salida con todos los objetos pre-procesados. Esto es mucho más fácil de depurar si algo va mal.</p>
<p>Este enfoque es útil por las siguientes razones:</p>
<ul>
<li>Mensajes de error más informativos - estos mensajes serán generados por el script de R, no por el R Markdown. Los errores de R Markdown tienden a decirle qué trozo tuvo un problema, pero no le dirán qué línea.</li>
<li>Si procede, puede ejecutar pasos de procesamiento largos antes del comando <code>render()</code> - se ejecutarán sólo una vez.</li>
</ul>
<p>En el ejemplo siguiente, tenemos un script de R separado en el que preprocesamos un objeto de <code>datos</code> en el entorno de R y luego procesamos “create_output.Rmd” usando <code>render()</code>.</p>
<div class="sourceCode" id="cb1751"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"datafile.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span>       <span class="co"># Load data and save to environment</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">hospital</span>, <span class="va">weight</span><span class="op">)</span>          <span class="co"># Select limited columns</span>

<span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>input <span class="op">=</span> <span class="st">"create_output.Rmd"</span><span class="op">)</span>   <span class="co"># Create Rmd file</span></code></pre></div>
</div>
<div id="estructura-de-carpetas-folder-structure" class="section level3 unnumbered">
<h3>Estructura de carpetas {#folder-structure}<a class="anchor" aria-label="anchor" href="#estructura-de-carpetas-folder-structure"><i class="fas fa-link"></i></a>
</h3>
<p>El flujo de trabajo también se refiere a la estructura general de las carpetas, como tener una carpeta de ‘salida’ para los documentos y figuras creados, y carpetas de ‘datos’ o ‘entradas’ para los datos depurados. No entramos en más detalles aquí, pero echa un vistazo a la página de <a href="organizing-routine-reports.html#organizing-routine-reports">organización de los informes rutinarios</a>.</p>
</div>
</div>
<div id="producing-the-document" class="section level2" number="38.10">
<h2>
<span class="header-section-number">38.10</span> Producir el documento<a class="anchor" aria-label="anchor" href="#producing-the-document"><i class="fas fa-link"></i></a>
</h2>
<p>Puedes elaborar el documento de las siguientes maneras:</p>
<ul>
<li>Manualmente clicando sobre el botón “Knit” en la parte superior del editor de scripts de RStudio (rápido y fácil)</li>
<li>Ejecutar el comando <code>render()</code> (ejecutado fuera del script de R Markdown)</li>
</ul>
<div id="opción-1-botón-knit-option-1-knit-button" class="section level3 unnumbered">
<h3>Opción 1: botón “Knit” {#option-1-knit-button}<a class="anchor" aria-label="anchor" href="#opci%C3%B3n-1-bot%C3%B3n-knit-option-1-knit-button"><i class="fas fa-link"></i></a>
</h3>
<p>Cuando tengas el archivo Rmd abierto, clica el botón ‘Knit’ en la parte superior del archivo.</p>
<p>R Studio le mostrará el progreso dentro de una pestaña ‘R Markdown’ cerca de su consola R. El documento se abrirá automáticamente cuando esté completo.</p>
<p>El documento se guardará en la misma carpeta que su script de R markdown, y con el mismo nombre de archivo (aparte de la extensión). Obviamente, esto no es ideal para el control de versiones (se sobreescribirá cada vez que se haga un punto, a menos que se mueva manualmente), ya que entonces puede que tengas que renombrar el archivo (por ejemplo, añadir una fecha).</p>
<p>Este es el botón de acceso directo de RStudio para la función <code>render()</code> de <strong>rmarkdown</strong>. Este enfoque sólo es compatible con un R markdown autocontenido, donde todos los componentes necesarios existen o se originan dentro del archivo.</p>
<div class="inline-figure"><img src="images/markdown/4_progress.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="opción-2-comando-render-option-2-render-command" class="section level3 unnumbered">
<h3>Opción 2: comando <code>render()</code> {#option-2-render-command}<a class="anchor" aria-label="anchor" href="#opci%C3%B3n-2-comando-render-option-2-render-command"><i class="fas fa-link"></i></a>
</h3>
<p>Otra forma de producir su salida de R Markdown es ejecutar la función <code>render()</code> (del paquete <strong>rmarkdown</strong>). Debe ejecutar este comando <em>fuera</em> del script de R Markdown, ya sea en un script de R separado (a menudo llamado “archivo de ejecución”), o como un comando independiente en la consola de R.</p>
<div class="sourceCode" id="cb1752"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>input <span class="op">=</span> <span class="st">"my_report.Rmd"</span><span class="op">)</span></code></pre></div>
<p>Al igual que con “knit”, la configuración por defecto guardará la salida Rmd en la misma carpeta que el script Rmd, con el mismo nombre de archivo (aparte de la extensión del archivo). Por ejemplo, “mi_informe.Rmd” cuando se procese creará “mi_informe.docx” si se procesa en un documento de Word. Sin embargo, al usar <code>render()</code> tiene la opción de usar diferentes configuraciones. <code>render()</code> puede aceptar argumentos que incluyen:</p>
<ul>
<li>
<code>output_format =</code> Este es el formato de salida al que se va a convertir (por ejemplo, <code>"html_document"</code>, <code>"pdf_document"</code>, <code>"word_document"</code>, o <code>"all"</code>). También puede especificar esto en el YAML dentro del script de R Markdown.</li>
<li>
<code>output_file =</code> Este es el nombre del archivo de salida (y la ruta del archivo). Se puede crear a través de funciones de R como <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> o <code>str_glue()</code> como se demuestra a continuación.</li>
<li>
<code>output_dir =</code>Este es un directorio de salida (carpeta) para guardar el archivo. Esto le permite elegir una alternativa distinta al directorio en el que se guarda el archivo Rmd.</li>
<li>
<code>output_options =</code> Puedes proporcionar una lista de opciones que anulen las del YAML del script (por ejemplo )</li>
<li>
<code>output_yaml =</code> Puedes proporcionar la ruta a un archivo .yml que contenga las especificaciones YAML</li>
<li>
<code>params =</code> Ver la sección de parámetros más abajo</li>
<li>Ver la lista completa <a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">aquí</a>
</li>
</ul>
<p>Como ejemplo, para mejorar el control de versiones, el siguiente comando guardará el archivo de salida dentro de una subcarpeta ‘outputs’, con la fecha actual en el nombre del archivo. Para crear el nombre del archivo, se utiliza la función <code>str_glue()</code> del paquete <strong>stringr</strong> para “pegar” las cadenas estáticas (escritas sin formato) con el código dinámico de R (escrito entre llaves). Por ejemplo, si es 10 de abril de 2021, el nombre del archivo de abajo será “Informe_2021-04-10.docx”. Consulta la página sobre <a href="characters-and-strings.html#characters-and-strings">Caracteres y cadenas</a> para obtener más detalles sobre <code>str_glue()</code>.</p>
<div class="sourceCode" id="cb1753"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>
  input <span class="op">=</span> <span class="st">"create_output.Rmd"</span>,
  output_file <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"outputs/Report_{Sys.Date()}.docx"</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>A medida que el archivo se procesa, la consola de RStudio mostrará el progreso hasta el 100%, y un mensaje final para indicar que se ha completado.</p>
</div>
<div id="opción-3-paquete-reportfactory-options-3-reportfactory-package" class="section level3 unnumbered">
<h3>Opción 3: paquete <strong>reportfactory</strong> {#options-3-reportfactory-package}<a class="anchor" aria-label="anchor" href="#opci%C3%B3n-3-paquete-reportfactory-options-3-reportfactory-package"><i class="fas fa-link"></i></a>
</h3>
<p>El paquete de R <strong>reportfactory</strong> ofrece un método alternativo de organización y compilación de informes R Markdown <em>para situaciones en las que se ejecutan informes de forma rutinaria (por ejemplo, diariamente, semanalmente…).</em> Facilita la compilación de múltiples archivos R Markdown y la organización de sus resultados. En esencia, proporciona una “fábrica” desde la que se pueden ejecutar los informes R Markdown, obtener automáticamente carpetas con fecha y hora para los resultados, y tener un control de versiones “ligero”.</p>
<p>Lea más sobre este flujo de trabajo en la página sobre la <a href="organizing-routine-reports.html#organizing-routine-reports">organización de los informes de rutina</a>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="parameterised-reports" class="section level2" number="38.11">
<h2>
<span class="header-section-number">38.11</span> Informes parametrizados<a class="anchor" aria-label="anchor" href="#parameterised-reports"><i class="fas fa-link"></i></a>
</h2>
<p>Puedes utilizar la parametrización para hacer que un informe sea dinámico, de forma que pueda ejecutarse con una configuración específica (por ejemplo, una fecha o lugar concretos o con determinadas opciones de tejido). A continuación, nos centramos en los aspectos básicos, pero hay más <a href="https://bookdown.org/yihui/rmarkdown/parameterized-reports.html">detalles en línea</a> sobre los informes parametrizados.</p>
<p>Utilizando linelist del ébola como ejemplo, digamos que queremos ejecutar un informe de vigilancia estándar para cada hospital cada día. Mostramos cómo se puede hacer esto usando parámetros.</p>
<p><em>Importante: los informes dinámicos también son posibles sin la estructura formal de parámetros (sin params:), utilizando simples objetos R en un script adyacente de R. Esto se explica al final de esta sección.</em></p>
<div id="establecer-parámetros-setting-parameters" class="section level3 unnumbered">
<h3>Establecer parámetros {#setting-parameters}<a class="anchor" aria-label="anchor" href="#establecer-par%C3%A1metros-setting-parameters"><i class="fas fa-link"></i></a>
</h3>
<p>Tienes varias opciones para especificar los valores de los parámetros para tu salida de R Markdown.</p>
<div id="opción-1-establecer-parámetros-dentro-de-yaml" class="section level4 unnumbered">
<h4>Opción 1: Establecer parámetros dentro de YAML<a class="anchor" aria-label="anchor" href="#opci%C3%B3n-1-establecer-par%C3%A1metros-dentro-de-yaml"><i class="fas fa-link"></i></a>
</h4>
<p>Edite el YAML para incluir una opción <code>params</code>:, con declaraciones sangradas para cada parámetro que desee definir. En este ejemplo creamos los parámetros <code>date</code> y <code>hospital</code>, para los que especificamos valores. Estos valores están sujetos a cambios cada vez que se ejecuta el informe. Si utiliza el botón “Knit” para producir la salida, los parámetros tendrán estos valores por defecto. Del mismo modo, si utiliza <code>render()</code> los parámetros tendrán estos valores por defecto a menos que se especifique lo contrario en el comando <code>render()</code>.</p>
<div class="sourceCode" id="cb1754"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1754-1"><a href="interactive-plots.html#cb1754-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1754-2"><a href="interactive-plots.html#cb1754-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Informe de vigilancia</span></span>
<span id="cb1754-3"><a href="interactive-plots.html#cb1754-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb1754-4"><a href="interactive-plots.html#cb1754-4" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb1754-5"><a href="interactive-plots.html#cb1754-5" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">date</span><span class="kw">:</span><span class="at"> 2021-04-10</span></span>
<span id="cb1754-6"><a href="interactive-plots.html#cb1754-6" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">hospital</span><span class="kw">:</span><span class="at"> Hospital Central</span></span>
<span id="cb1754-7"><a href="interactive-plots.html#cb1754-7" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<p>En el fondo, estos valores de los parámetros están contenidos en una lista de sólo lectura llamada <code>params</code>. Así, puedes insertar los valores de los parámetros en el código de R como lo haría con otro objeto/valor de R en tu entorno. Simplemente escriba <code>params$</code> seguido del nombre del parámetro. Por ejemplo <code>params$hospital</code> para representar el nombre del hospital (“Hospital Central” por defecto).</p>
<p>Ten en cuenta que los parámetros también pueden tener valores <code>true</code> o <code>false</code>, y por lo tanto estos pueden ser incluidos en sus opciones de <strong>knitr</strong> para un chunk de R. Por ejemplo, puedes establecer <code>{r, eval=params$run}</code> en lugar de <code>{r, eval=FALSE}</code>, y ahora si el chunk se ejecuta o no depende del valor de un parámetro run:.</p>
<p>Ten en cuenta que para los parámetros que son fechas, serán introducidos como una cadena. Por lo tanto, para que <code>params$date</code> se interprete en el código de R, es probable que tenga que ser envuelto con <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code> o una función similar para convertir al tipo Date.</p>
</div>
<div id="opción-2-establecer-los-parámetros-dentro-de-render" class="section level4 unnumbered">
<h4>Opción 2: Establecer los parámetros dentro de <code>render()</code><a class="anchor" aria-label="anchor" href="#opci%C3%B3n-2-establecer-los-par%C3%A1metros-dentro-de-render"><i class="fas fa-link"></i></a>
</h4>
<p>Como se ha mencionado anteriormente, como alternativa a clicar el botón “Knit” para producir la salida es ejecutar la función <code>render()</code> desde un script independiente. En este último caso, se pueden especificar los parámetros a utilizar con el argumento <code>params =</code> de <code>render()</code>.</p>
<p>Ten en cuenta que los valores de los parámetros proporcionados aquí <em>sobrescribirán</em> sus valores por defecto si se escriben en el YAML. Escribimos los valores entre comillas ya que en este caso deben ser definidos como valores de carácter/cadena.</p>
<p>El siguiente comando renderiza “surveillance_report.Rmd”, especifica un nombre de archivo de salida dinámico y una carpeta, y proporciona un <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> de dos parámetros y sus valores al argumento <code>params =</code>.</p>
<div class="sourceCode" id="cb1755"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>
  input <span class="op">=</span> <span class="st">"surveillance_report.Rmd"</span>,  
  output_file <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"outputs/Report_{Sys.Date()}.docx"</span><span class="op">)</span>,
  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>date <span class="op">=</span> <span class="st">"2021-04-10"</span>, hospital  <span class="op">=</span> <span class="st">"Central Hospital"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="opción-3-establecer-los-parámetros-mediante-una-interfaz-gráfica-de-usuario" class="section level4 unnumbered">
<h4>Opción 3: Establecer los parámetros mediante una interfaz gráfica de usuario<a class="anchor" aria-label="anchor" href="#opci%C3%B3n-3-establecer-los-par%C3%A1metros-mediante-una-interfaz-gr%C3%A1fica-de-usuario"><i class="fas fa-link"></i></a>
</h4>
<p>Para obtener una sensación más interactiva, también puedes utilizar la interfaz gráfica de usuario (GUI) para seleccionar manualmente los valores de los parámetros. Para ello, podemos clicar en el menú desplegable situado junto al botón ‘Knit’ y elegir ‘Knit with parameters’.</p>
<p>Aparecerá una ventana emergente que permitirá introducir los valores de los parámetros establecidos en el YAML del documento.</p>
<div class="inline-figure"><img src="images/markdown/5_parametersGUI.png" width="50%" style="display: block; margin: auto;"></div>
<p>Puedes lograr lo mismo a través de un comando <code>render()</code> especificando <code>params = "ask"</code>, como se demuestra a continuación.</p>
<div class="sourceCode" id="cb1756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1756-1"><a href="interactive-plots.html#cb1756-1" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(</span>
<span id="cb1756-2"><a href="interactive-plots.html#cb1756-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">input =</span> <span class="st">"surveillance_report.Rmd"</span>,  </span>
<span id="cb1756-3"><a href="interactive-plots.html#cb1756-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_file =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">"outputs/Report_{Sys.Date()}.docx"</span>),</span>
<span id="cb1756-4"><a href="interactive-plots.html#cb1756-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">params =</span> “ask”)</span></code></pre></div>
<p>Sin embargo, la introducción de valores en esta ventana emergente está sujeta a errores y faltas de ortografía. Es posible que prefiera añadir restricciones a los valores que se pueden introducir a través de los menús desplegables. Puedes hacerlo añadiendo en el YAML varias especificaciones para cada entrada <code>params:</code>.</p>
<ul>
<li>
<code>label:</code> es como el título para ese menú desplegable en particular</li>
<li>
<code>value:</code> es el valor por defecto (inicial)</li>
<li>
<code>input:</code> establecer <code>select</code> para el menú desplegable<br>
</li>
<li>
<code>choices:</code> Indique los valores elegibles en el menú desplegable</li>
</ul>
<p>A continuación, estas especificaciones están escritas para el parámetro <code>hospital</code></p>
<div class="sourceCode" id="cb1757"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1757-1"><a href="interactive-plots.html#cb1757-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1757-2"><a href="interactive-plots.html#cb1757-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Surveillance report</span></span>
<span id="cb1757-3"><a href="interactive-plots.html#cb1757-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb1757-4"><a href="interactive-plots.html#cb1757-4" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb1757-5"><a href="interactive-plots.html#cb1757-5" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">date</span><span class="kw">:</span><span class="at"> 2021-04-10</span></span>
<span id="cb1757-6"><a href="interactive-plots.html#cb1757-6" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">hospital</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb1757-7"><a href="interactive-plots.html#cb1757-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">label</span><span class="kw">:</span><span class="at"> “Town:”</span></span>
<span id="cb1757-8"><a href="interactive-plots.html#cb1757-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">value</span><span class="kw">:</span><span class="at"> Central Hospital</span></span>
<span id="cb1757-9"><a href="interactive-plots.html#cb1757-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">input</span><span class="kw">:</span><span class="at"> select</span></span>
<span id="cb1757-10"><a href="interactive-plots.html#cb1757-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">choices</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">Central Hospital</span><span class="kw">,</span><span class="at"> Military Hospital</span><span class="kw">,</span><span class="at"> Port Hospital</span><span class="kw">,</span><span class="at"> St. Mark</span><span class="st">'s Maternity Hospital (SMMH)]</span></span>
<span id="cb1757-11"><a href="interactive-plots.html#cb1757-11" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span></code></pre></div>
<p>Al procesarlo (con el botón ‘knit with parameters’ o con <code>render()</code>), la ventana emergente tendrá opciones desplegables para seleccionarlos.</p>
<div class="inline-figure"><img src="images/markdown/5_parametersGUIB.png" width="50%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="ejemplo-parametrizado-parameterized-example" class="section level3 unnumbered">
<h3>Ejemplo parametrizado {#parameterized-example}<a class="anchor" aria-label="anchor" href="#ejemplo-parametrizado-parameterized-example"><i class="fas fa-link"></i></a>
</h3>
<p>El siguiente código crea parámetros para <code>date</code> y <code>hospital</code>, que se utilizan en el R Markdown como <code>params$date</code> y <code>params$hospital</code>, respectivamente.</p>
<p>En la salida del informe resultante, vea cómo los datos se filtran al hospital específico, y el título del gráfico se refiere al hospital y a la fecha correctos. En este caso utilizamos el archivo “linelist_cleaned.rds”, pero sería especialmente adecuado que la propia lista de líneas tuviera también un sello de fecha para alinearse con la fecha parametrizada.</p>
<div class="inline-figure"><img src="images/markdown/6_Rmdexample.png" width="100%" style="display: block; margin: auto;"></div>
<p>Si se procesa esto se obtiene la salida final con la fuente y el diseño por defecto.</p>
<div class="inline-figure"><img src="images/markdown/6_RmdexampleB.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="parametrización-sin-parámetros-parameterisation-without-params" class="section level3 unnumbered">
<h3>Parametrización sin parámetros {#parameterisation-without-params}<a class="anchor" aria-label="anchor" href="#parametrizaci%C3%B3n-sin-par%C3%A1metros-parameterisation-without-params"><i class="fas fa-link"></i></a>
</h3>
<p>Si estás procesazando un archivo R Markdown con <code>render()</code> desde un script separado, puede realmente crear el impacto de la parametrización sin usar la funcionalidad params:.</p>
<p>Por ejemplo, en el <em>script de R</em> que contiene el comando render(), puedes simplemente definir <code>hospital</code> y <code>date</code> como dos objetos R (valores) antes del comando <code>render()</code>. En el R Markdown, no sería necesario tener una sección <code>params:</code> en el YAML, y nos referiríamos al objeto <code>date</code> en lugar de <code>params$date</code> y a <code>hospital</code> en lugar de <code>params$hospital</code>.</p>
<div class="sourceCode" id="cb1758"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This is a R script that is separate from the R Markdown</span>

<span class="co"># define R objects</span>
<span class="va">hospital</span> <span class="op">&lt;-</span> <span class="st">"Central Hospital"</span>
<span class="va">date</span> <span class="op">&lt;-</span> <span class="st">"2021-04-10"</span>

<span class="co"># Render the R markdown</span>
<span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>input <span class="op">=</span> <span class="st">"create_output.Rmd"</span><span class="op">)</span> </code></pre></div>
<p>Seguir este enfoque significa que no se puede procesar con “knit with parameters”, ni utilizar la interfaz gráfica , ni incluir opciones de procesamiento dentro de los parámetros. Sin embargo, permite simplificar el código, lo que puede ser ventajoso.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="looping-reports" class="section level2" number="38.12">
<h2>
<span class="header-section-number">38.12</span> Informes en bucle<a class="anchor" aria-label="anchor" href="#looping-reports"><i class="fas fa-link"></i></a>
</h2>
<p>Es posible que queramos ejecutar un informe varias veces, variando los parámetros de entrada, para producir un informe para cada jurisdicción/unidad. Esto puede hacerse utilizando herramientas para la <em>iteración</em>, que se explican en detalle en la página sobre <a href="iteration-loops-and-lists.html#iteration-loops-and-lists">Iteración, bucles y listas</a>. Las opciones incluyen el paquete <strong>purrr</strong>, o el uso de un <em>bucle for</em> como se explica a continuación.</p>
<p>A continuación, utilizamos un simple <em>bucle for</em> para generar un informe de vigilancia para todos los hospitales de interés. Esto se hace con un solo comando (en lugar de cambiar manualmente el parámetro del hospital uno por uno). El comando para generar los informes debe existir en un script separado <em>fuera</em> del informe Rmd. Este script también contendrá objetos definidos para “hacer un bucle” - la fecha de hoy, y un vector de nombres de hospitales para hacer un bucle.</p>
<div class="sourceCode" id="cb1759"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hospitals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Central Hospital"</span>,
                <span class="st">"Military Hospital"</span>, 
                <span class="st">"Port Hospital"</span>,
                <span class="st">"St. Mark's Maternity Hospital (SMMH)"</span><span class="op">)</span> </code></pre></div>
<p>We then feed these values one-at-a-time into the <code>render()</code> command using a loop, which runs the command once for each value in the <code>hospitals</code> vector. The letter <code>i</code> represents the index position (1 through 4) of the hospital currently being used in that iteration, such that <code>hospital_list[1]</code> would be “Central Hospital”. This information is supplied in two places in the <code>render()</code> command:</p>
<ol style="list-style-type: decimal">
<li>To the file name, such that the file name of the first iteration if produced on 10th April 2021 would be “Report_Central Hospital_2021-04-10.docx”, saved in the ‘output’ subfolder of the working directory.<br>
</li>
<li>To <code>params =</code> such that the Rmd uses the hospital name internally whenever the <code>params$hospital</code> value is called (e.g. to filter the dataset to the particular hospital only). In this example, four files would be created - one for each hospital.</li>
</ol>
<div class="sourceCode" id="cb1760"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">hospitals</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>
    input <span class="op">=</span> <span class="st">"surveillance_report.Rmd"</span>,
    output_file <span class="op">=</span> <span class="fu">str_glue</span><span class="op">(</span><span class="st">"output/Report_{hospitals[i]}_{Sys.Date()}.docx"</span><span class="op">)</span>,
    params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>hospital  <span class="op">=</span> <span class="va">hospitals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>       </code></pre></div>
<!-- In the scenario where you are f not using this strict form of parameterisation but saving objects to the environment, as discussed at the end of the parameterisation section, the render function would look like this: -->
<!-- ```md -->
<!-- for(i in 1:length(hospital_list)){ -->
<!-- rmarkdown::render("surveillance_report.Rmd", -->
<!--                   output_file = paste0("output/Report_", hospital_list[i], refdate, ".docx") -->
<!-- }        -->
<!-- ``` -->
<!-- The text within the markdown would then need to refer to `hospital_list[i]` and `refdate`.  -->
<!-- ======================================================= -->
</div>
<div id="templates" class="section level2" number="38.13">
<h2>
<span class="header-section-number">38.13</span> Plantillas<a class="anchor" aria-label="anchor" href="#templates"><i class="fas fa-link"></i></a>
</h2>
<p>Utilizando un documento de plantilla que contenga cualquier formato deseado, puede ajustar la estética del aspecto de la salida Rmd. Puedes crear, por ejemplo, un archivo de MS Word o Powerpoint que contenga páginas/diapositivas con las dimensiones, marcas de agua, fondos y fuentes deseadas.</p>
<div id="documentos-en-word-word-documents" class="section level3 unnumbered">
<h3>Documentos en Word {#word-documents}<a class="anchor" aria-label="anchor" href="#documentos-en-word-word-documents"><i class="fas fa-link"></i></a>
</h3>
<p>Para crear una plantilla, inicia un nuevo documento de Word (o utiliza uno ya existente con el formato que le convenga), y edita las fuentes definiendo los Estilos. En el Estilo, los encabezados 1, 2 y 3 se refieren a los distintos niveles de encabezado de markdown (<code># Header 1</code>, <code>## Header 2</code> and <code>### Header 3</code> respectivamente). Clica con el botón derecho en el estilo y clica en ‘modificar’ para cambiar el formato de la fuente, así como el párrafo (por ejemplo, podés introducir saltos de página antes de ciertos estilos que pueden ayudar con el espaciado). Otros aspectos del documento de Word, como los márgenes, el tamaño de la página, los encabezados, etc., pueden modificarse como un documento de Word normal en el que se trabaja directamente.</p>
<div class="inline-figure"><img src="images/markdown/7_template.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="powerpoint-documents" class="section level3" number="38.13.1">
<h3>
<span class="header-section-number">38.13.1</span> Documentos en Powerpoint<a class="anchor" aria-label="anchor" href="#powerpoint-documents"><i class="fas fa-link"></i></a>
</h3>
<p>Como en el caso anterior, crea un nuevo conjunto de diapositivas o utiliza un archivo PowerPoint existente con el formato deseado. Para seguir editando, clica en “Ver” y “Patrón de diapositivas”. Desde aquí puede cambiar la apariencia de la diapositiva “maestra” editando el formato del texto en los cuadros de texto, así como las dimensiones del fondo/página para la página en general.</p>
<div class="inline-figure"><img src="images/markdown/8_ppttemplate.PNG" width="100%" style="display: block; margin: auto;"></div>
<p>Desgraciadamente, la edición de archivos PowerPoint es algo menos flexible:</p>
<ul>
<li>Un encabezado de primer nivel (<code># Header 1</code>) se convertirá automáticamente en el título de una nueva diapositiva,</li>
<li>El texto del <code># Header 2</code> no aparecerá como subtítulo, sino como texto dentro del cuadro de texto principal de la diapositiva (a menos que encuentre una manera de maniplar la vista del Patrón).</li>
<li>Los gráficos y las tablas resultantes irán automáticamente a nuevas diapositivas. Tendrá que combinarlos, por ejemplo con la función <strong>patchwork</strong> para combinar ggplots, para que aparezcan en la misma página. Vea esta <a href="https://mattherman.info/blog/ppt-patchwork/">entrada del blog</a> sobre el uso del paquete patchwork para poner múltiples imágenes en una diapositiva.</li>
</ul>
<p>En el <a href="https://davidgohel.github.io/officer/">paquete <strong>oficcer </strong></a> encontrará una herramienta para trabajar más a fondo con las presentaciones de PowerPoint.</p>
</div>
<div id="integración-de-plantillas-en-el-yaml-integrating-templates-into-the-yaml" class="section level3 unnumbered">
<h3>Integración de plantillas en el YAML {#integrating-templates-into-the-yaml}<a class="anchor" aria-label="anchor" href="#integraci%C3%B3n-de-plantillas-en-el-yaml-integrating-templates-into-the-yaml"><i class="fas fa-link"></i></a>
</h3>
<p>Una vez preparada la plantilla, el detalle de la misma puede añadirse en el YAML del Rmd debajo de la línea ‘output’ y debajo de donde se especifica el tipo de documento (que va a una línea separada en sí). Ten en cuenta que <code>reference_doc</code> se puede utilizar para las plantillas de diapositivas de PowerPoint.</p>
<p>Lo más fácil es guardar la plantilla en la misma carpeta en la que está el archivo Rmd (como en el ejemplo siguiente), o en una subcarpeta dentro de ella</p>
<div class="sourceCode" id="cb1761"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1761-1"><a href="interactive-plots.html#cb1761-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1761-2"><a href="interactive-plots.html#cb1761-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Surveillance report</span></span>
<span id="cb1761-3"><a href="interactive-plots.html#cb1761-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb1761-4"><a href="interactive-plots.html#cb1761-4" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">word_document</span><span class="kw">:</span></span>
<span id="cb1761-5"><a href="interactive-plots.html#cb1761-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">reference_docx</span><span class="kw">:</span><span class="at"> </span><span class="st">"template.docx"</span></span>
<span id="cb1761-6"><a href="interactive-plots.html#cb1761-6" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb1761-7"><a href="interactive-plots.html#cb1761-7" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">date</span><span class="kw">:</span><span class="at"> 2021-04-10</span></span>
<span id="cb1761-8"><a href="interactive-plots.html#cb1761-8" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">hospital</span><span class="kw">:</span><span class="at"> Central Hospital</span></span>
<span id="cb1761-9"><a href="interactive-plots.html#cb1761-9" aria-hidden="true" tabindex="-1"></a><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb1761-10"><a href="interactive-plots.html#cb1761-10" aria-hidden="true" tabindex="-1"></a><span class="at"> </span></span>
<span id="cb1761-11"><a href="interactive-plots.html#cb1761-11" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
</div>
<div id="formateo-de-archivos-html-formatting-html-files" class="section level3 unnumbered">
<h3>Formateo de archivos HTML {#formatting-html-files}<a class="anchor" aria-label="anchor" href="#formateo-de-archivos-html-formatting-html-files"><i class="fas fa-link"></i></a>
</h3>
<p>Los archivos HTML no utilizan plantillas, pero pueden tener los estilos configurados dentro del YAML. Los HTML son documentos interactivos, y son particularmente flexibles. Aquí cubrimos algunas opciones básicas.</p>
<ul>
<li><p>Tabla de contenidos: Podemos añadir una tabla de contenidos con <code>toc: true</code> a continuación, y también especificar que permanezca visible (“flotante”) al desplazarse, con <code>toc_float: true</code>.</p></li>
<li><p>Temas: Podemos referirnos a algunos temas prefabricados, que provienen de una biblioteca de temas de Bootswatch. En el siguiente ejemplo utilizamos cerulean. Otras opciones son: journal, flatly, darkly, readable, spacelab, united, cosmo, lumen, paper, sandstone, simplex y yeti.</p></li>
<li><p>Resaltar: Configurando esto se cambia el aspecto del texto resaltado (por ejemplo, el código dentro de los trozos que se muestran). Los estilos soportados son default, tango, pygments, kate, monochrome, espresso, zenburn, haddock, breezedark y textmate.</p></li>
</ul>
<p>He aquí un ejemplo de cómo integrar las opciones anteriores en el YAML.</p>
<div class="sourceCode" id="cb1762"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1762-1"><a href="interactive-plots.html#cb1762-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1762-2"><a href="interactive-plots.html#cb1762-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"HTML example"</span></span>
<span id="cb1762-3"><a href="interactive-plots.html#cb1762-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span></span>
<span id="cb1762-4"><a href="interactive-plots.html#cb1762-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html_document</span><span class="kw">:</span></span>
<span id="cb1762-5"><a href="interactive-plots.html#cb1762-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1762-6"><a href="interactive-plots.html#cb1762-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc_float</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1762-7"><a href="interactive-plots.html#cb1762-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> cerulean</span></span>
<span id="cb1762-8"><a href="interactive-plots.html#cb1762-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">highlight</span><span class="kw">:</span><span class="at"> kate</span></span>
<span id="cb1762-9"><a href="interactive-plots.html#cb1762-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb1762-10"><a href="interactive-plots.html#cb1762-10" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<p>A continuación se muestran dos ejemplos de salidas HTML que tienen ambas tablas de contenido flotantes, pero diferentes estilos de tema y resaltado seleccionados:</p>
<div class="inline-figure"><img src="images/markdown/9_html.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="dynamic-content" class="section level2" number="38.14">
<h2>
<span class="header-section-number">38.14</span> Contenido dinámico<a class="anchor" aria-label="anchor" href="#dynamic-content"><i class="fas fa-link"></i></a>
</h2>
<p>En una salida HTML, el contenido de tu informe puede ser dinámico. A continuación, algunos ejemplos:</p>
<div id="tablas-tables-1" class="section level3 unnumbered">
<h3>Tablas {#tables-1}<a class="anchor" aria-label="anchor" href="#tablas-tables-1"><i class="fas fa-link"></i></a>
</h3>
<p>En un informe HTML, se puede imprimir un dataframe / tibbles de manera que el contenido sea dinámico, con filtros y barras de desplazamiento. Hay varios paquetes que ofrecen esta capacidad.</p>
<p>Para hacer esto con el paquete <strong>DT</strong>, como se utiliza a lo largo de este manual, se puede insertar un trozo de código como este:</p>
<div class="inline-figure"><img src="images/markdown/10_dynamictable.png" width="100%" style="display: block; margin: auto;"></div>
<p>La función <code>datatable()</code> imprimirá el dataframe proporcionado como una tabla dinámica para el lector. Puedes establecer <code>rownames = FALSE</code> para simplificar el extremo izquierdo de la tabla. <code>filter = "top"</code> proporciona un filtro sobre cada columna. En el argumento <code><a href="https://rdrr.io/r/base/options.html">option()</a></code> proporciona una lista de otras especificaciones. A continuación incluimos dos: <code>pageLength = 5</code> establece el número de filas que aparecen como 5 (las filas restantes se pueden ver paginando a través de flechas), y <code>scrollX=TRUE</code> habilita una barra de desplazamiento en la parte inferior de la tabla (para las columnas que se extienden demasiado a la derecha).</p>
<p>Si tu conjunto de datos es muy grande, considera la posibilidad de mostrar sólo las X filas superiores envolviendo el dataframe en <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
</div>
<div id="widgets-html-html-widgets" class="section level3 unnumbered">
<h3>#Widgets HTML {#html-widgets}<a class="anchor" aria-label="anchor" href="#widgets-html-html-widgets"><i class="fas fa-link"></i></a>
</h3>
<p>Los <a href="http://www.htmlwidgets.org/">widgets HTML para R</a> son un tipo especial de paquetes de R que permiten una mayor interactividad utilizando bibliotecas de JavaScript. Puedes incrustarlos en salidas HTML R Markdown.</p>
<p>Algunos ejemplos comunes de estos widgets son:</p>
<ul>
<li>Plotly (utilizado en la página de este manual y en la página de [Plots interativos])</li>
<li>visNetwork (utilizado en la página de <a href="transmission-chains.html#transmission-chains">cadenas de transmisión de</a> este manual)</li>
<li>Leaflet (Folleto) (utilizado en la página de <a href="#gis-basics">fundamentos del SIG</a> de este manual)</li>
<li>dygraphs (útil para mostrar interactivamente los datos de las series temporales)</li>
<li>DT (<code>datatable()</code>) (se utiliza para mostrar tablas dinámicas con filtro, ordenación, etc.)</li>
</ul>
<p>La función <code><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly()</a></code> de <strong>plotly</strong> es particularmente fácil de usar. Consulta la página de <a href="dashboards-with-r-markdown.html#interactive-plots-1">gráficos interactivos</a>.</p>
</div>
</div>
<div id="resources" class="section level2" number="38.15">
<h2>
<span class="header-section-number">38.15</span> Recursos<a class="anchor" aria-label="anchor" href="#resources"><i class="fas fa-link"></i></a>
</h2>
<p>Puedes encontrar más información en:</p>
<ul>
<li><a href="https://bookdown.org/yihui/rmarkdown/" class="uri">https://bookdown.org/yihui/rmarkdown/</a></li>
<li><a href="https://rmarkdown.rstudio.com/articles_intro.html" class="uri">https://rmarkdown.rstudio.com/articles_intro.html</a></li>
</ul>
<p>Una buena explicación de markdown vs knitr vs Rmarkdown está aquí: <a href="https://stackoverflow.com/questions/40563479/relationship-between-r-markdown-knitr-pandoc-and-bookdown" class="uri">https://stackoverflow.com/questions/40563479/relationship-between-r-markdown-knitr-pandoc-and-bookdown</a></p>

</div>
<div class="chapter-nav">
<div class="prev"><a href="phylogenetic-trees-1.html"><span class="header-section-number">37</span> Árboles filogenéticos</a></div>
<div class="next"><a href="organizing-routine-reports.html"><span class="header-section-number">39</span> Borrador. Organización de informes rutinarios</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#interactive-plots"><span class="header-section-number">38</span> Gráficos interactivos</a></li>
<li>
<a class="nav-link" href="#preparation-30"><span class="header-section-number">38.1</span> Preparación</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#load-packages-26"><span class="header-section-number">38.1.1</span> Cargar paquetes</a></li>
<li><a class="nav-link" href="#start-with-a-ggplot"><span class="header-section-number">38.1.2</span> Comienza con un ggplot()</a></li>
<li><a class="nav-link" href="#import-data-24"><span class="header-section-number">38.1.3</span> Importar datos</a></li>
</ul>
</li>
<li><a class="nav-link" href="#plot-with-ggplotly"><span class="header-section-number">38.2</span> Trazar con ggplotly()</a></li>
<li>
<a class="nav-link" href="#modifications"><span class="header-section-number">38.3</span> Modificaciones</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#file-size"><span class="header-section-number">38.3.1</span> Tamaño del archivo</a></li>
<li><a class="nav-link" href="#botones-buttons"><span class="header-section-number">38.3.2</span> Botones {buttons}</a></li>
</ul>
</li>
<li><a class="nav-link" href="#heat-tiles"><span class="header-section-number">38.4</span> Gráficos de calor</a></li>
<li><a class="nav-link" href="#resources-29"><span class="header-section-number">38.5</span> Recursos</a></li>
<li><a class="nav-link" href="#preparation-31"><span class="header-section-number">38.6</span> Preparación</a></li>
<li>
<a class="nav-link" href="#getting-started"><span class="header-section-number">38.7</span> Cómo empezar</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#instalar-el-paquete-r-rmarkdown-install-rmarkdown-r-package">Instalar el paquete R rmarkdown {#install-rmarkdown-r-package}</a></li>
<li><a class="nav-link" href="#iniciar-un-nuevo-archivo-rmd-starting-a-new-rmd-file">Iniciar un nuevo archivo Rmd {#starting-a-new-rmd-file}</a></li>
<li><a class="nav-link" href="#es-importante-saber-important-to-know">Es importante saber {#important-to-know}</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#r-markdown-components"><span class="header-section-number">38.8</span> Componentes de R Markdown</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#metadatos-yaml-yaml-metadata">Metadatos YAML {#yaml-metadata}</a></li>
<li><a class="nav-link" href="#texto-text">Texto {#text}</a></li>
<li><a class="nav-link" href="#trozos-de-c%C3%B3digo-chunks-code-chunks">Trozos de código (chunks) {#code-chunks}</a></li>
<li><a class="nav-link" href="#im%C3%A1genes-images">Imágenes {images}</a></li>
<li><a class="nav-link" href="#tablas-tables">Tablas {#tables}</a></li>
<li><a class="nav-link" href="#secciones-con-pesta%C3%B1as-tabbed-sections">Secciones con pestañas {#tabbed-sections}</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#file-structure"><span class="header-section-number">38.9</span> Estructura de los archivos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#rmd-aut%C3%B3nomo-self-contained-rmd">Rmd autónomo {#self-contained-rmd}</a></li>
<li><a class="nav-link" href="#ejecutar-archivo-runfile">Ejecutar archivo {#runfile}</a></li>
<li><a class="nav-link" href="#estructura-de-carpetas-folder-structure">Estructura de carpetas {#folder-structure}</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#producing-the-document"><span class="header-section-number">38.10</span> Producir el documento</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#opci%C3%B3n-1-bot%C3%B3n-knit-option-1-knit-button">Opción 1: botón “Knit” {#option-1-knit-button}</a></li>
<li><a class="nav-link" href="#opci%C3%B3n-2-comando-render-option-2-render-command">Opción 2: comando render() {#option-2-render-command}</a></li>
<li><a class="nav-link" href="#opci%C3%B3n-3-paquete-reportfactory-options-3-reportfactory-package">Opción 3: paquete reportfactory {#options-3-reportfactory-package}</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#parameterised-reports"><span class="header-section-number">38.11</span> Informes parametrizados</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#establecer-par%C3%A1metros-setting-parameters">Establecer parámetros {#setting-parameters}</a></li>
<li><a class="nav-link" href="#ejemplo-parametrizado-parameterized-example">Ejemplo parametrizado {#parameterized-example}</a></li>
<li><a class="nav-link" href="#parametrizaci%C3%B3n-sin-par%C3%A1metros-parameterisation-without-params">Parametrización sin parámetros {#parameterisation-without-params}</a></li>
</ul>
</li>
<li><a class="nav-link" href="#looping-reports"><span class="header-section-number">38.12</span> Informes en bucle</a></li>
<li>
<a class="nav-link" href="#templates"><span class="header-section-number">38.13</span> Plantillas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#documentos-en-word-word-documents">Documentos en Word {#word-documents}</a></li>
<li><a class="nav-link" href="#powerpoint-documents"><span class="header-section-number">38.13.1</span> Documentos en Powerpoint</a></li>
<li><a class="nav-link" href="#integraci%C3%B3n-de-plantillas-en-el-yaml-integrating-templates-into-the-yaml">Integración de plantillas en el YAML {#integrating-templates-into-the-yaml}</a></li>
<li><a class="nav-link" href="#formateo-de-archivos-html-formatting-html-files">Formateo de archivos HTML {#formatting-html-files}</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#dynamic-content"><span class="header-section-number">38.14</span> Contenido dinámico</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#tablas-tables-1">Tablas {#tables-1}</a></li>
<li><a class="nav-link" href="#widgets-html-html-widgets">#Widgets HTML {#html-widgets}</a></li>
</ul>
</li>
<li><a class="nav-link" href="#resources"><span class="header-section-number">38.15</span> Recursos</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>
</div>
  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>El manual de R para la Epidemiología</strong>" was written by El equipo del manual. It was last built on 2021-11-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
