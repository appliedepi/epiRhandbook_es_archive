<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Borrador. Trabajando con Fechas | El manual de R para Epi’s</title>
<meta name="author" content="El equipo del manual">
<meta name="description" content="Trabajar con fechas en R requiere más atención que trabajar con otros tipos de objetos. A continuación, ofrecemos algunas herramientas y ejemplos para hacer este proceso menos doloroso. Por...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="9 Borrador. Trabajando con Fechas | El manual de R para Epi’s">
<meta property="og:type" content="book">
<meta property="og:description" content="Trabajar con fechas en R requiere más atención que trabajar con otros tipos de objetos. A continuación, ofrecemos algunas herramientas y ejemplos para hacer este proceso menos doloroso. Por...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Borrador. Trabajando con Fechas | El manual de R para Epi’s">
<meta name="twitter:description" content="Trabajar con fechas en R requiere más atención que trabajar con otros tipos de objetos. A continuación, ofrecemos algunas herramientas y ejemplos para hacer este proceso menos doloroso. Por...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.25/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.9/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-2.5.1/plotly-basic-2.5.1.min.js"></script><script src="libs/plotly-cartesian-2.5.1/plotly-cartesian-2.5.1.min.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-9.3.1/highcharts.js"></script><script src="libs/highcharts-9.3.1/highcharts-3d.js"></script><script src="libs/highcharts-9.3.1/highcharts-more.js"></script><script src="libs/highcharts-9.3.1/modules/stock.js"></script><script src="libs/highcharts-9.3.1/modules/map.js"></script><script src="libs/highcharts-9.3.1/modules/data.js"></script><script src="libs/highcharts-9.3.1/modules/exporting.js"></script><script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script><script src="libs/highcharts-9.3.1/modules/drilldown.js"></script><script src="libs/highcharts-9.3.1/modules/item-series.js"></script><script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-9.3.1/modules/annotations.js"></script><script src="libs/highcharts-9.3.1/modules/export-data.js"></script><script src="libs/highcharts-9.3.1/modules/funnel.js"></script><script src="libs/highcharts-9.3.1/modules/heatmap.js"></script><script src="libs/highcharts-9.3.1/modules/treemap.js"></script><script src="libs/highcharts-9.3.1/modules/sankey.js"></script><script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script><script src="libs/highcharts-9.3.1/modules/organization.js"></script><script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script><script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script><script src="libs/highcharts-9.3.1/modules/sunburst.js"></script><script src="libs/highcharts-9.3.1/modules/vector.js"></script><script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script><script src="libs/highcharts-9.3.1/modules/xrange.js"></script><script src="libs/highcharts-9.3.1/modules/tilemap.js"></script><script src="libs/highcharts-9.3.1/modules/venn.js"></script><script src="libs/highcharts-9.3.1/modules/gantt.js"></script><script src="libs/highcharts-9.3.1/modules/timeline.js"></script><script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script><script src="libs/highcharts-9.3.1/modules/bullet.js"></script><script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script><script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script><script src="libs/highcharts-9.3.1/modules/lollipop.js"></script><script src="libs/highcharts-9.3.1/modules/series-label.js"></script><script src="libs/highcharts-9.3.1/plugins/motion.js"></script><script src="libs/highcharts-9.3.1/custom/reset.js"></script><script src="libs/highcharts-9.3.1/modules/boost.js"></script><script src="libs/highchart-binding-0.9.4/highchart.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">El manual de R para Epi’s</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Acerca de este libro</li>
<li><a class="" href="editorial-and-technical-notes.html"><span class="header-section-number">1</span> Notas editoriales y técnicas</a></li>
<li><a class="" href="download-handbook-and-data.html"><span class="header-section-number">2</span> Descargando el manual y los datos</a></li>
<li class="book-part">Aspectos básicos</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> Fundamentos de R</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transición a R</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">5</span> Paquetes recomendados</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> Proyectos en R</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">7</span> Importación y exportación</a></li>
<li class="book-part">Gestión de datos</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Limpieza de datos y funciones básicas</a></li>
<li><a class="active" href="working-with-dates.html"><span class="header-section-number">9</span> Borrador. Trabajando con Fechas</a></li>
<li><a class="" href="characters-and-strings.html"><span class="header-section-number">10</span> Caracteres y cadenas</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">11</span> Factores</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">12</span> Pivotar datos</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">13</span> Agrupar datos</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">14</span> Unir datos</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> Borrador. De-duplicación</a></li>
<li><a class="" href="iteration-loops-and-lists.html"><span class="header-section-number">16</span> Borrador. Iteración, bucles y listas</a></li>
<li class="book-part">Análisis</li>
<li><a class="" href="descriptive-tables.html"><span class="header-section-number">17</span> Tablas descriptivas</a></li>
<li><a class="" href="simple-statistical-tests.html"><span class="header-section-number">18</span> Tests estadísticos sencillos</a></li>
<li><a class="" href="univariate-and-multivariable-regression.html"><span class="header-section-number">19</span> Borrador. Regresión univariante y multivariable</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Borrador. Valores faltantes</a></li>
<li><a class="" href="standardised-rates.html"><span class="header-section-number">21</span> Borrador. Tasas estandarizadas</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">22</span> Borrador. Medias Móviles</a></li>
<li><a class="" href="time-series-and-outbreak-detection.html"><span class="header-section-number">23</span> Borrador. Series temporales y detección de brotes</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">24</span> Borrador. Modelización de epidemias</a></li>
<li><a class="" href="contact-tracing-1.html"><span class="header-section-number">25</span> Borrador. Rastreo de contactos</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">26</span> Borrador. Análisis de encuestas</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">27</span> Borrador. Análisis de supervivencia</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">28</span> Conceptos básicos de los SIG</a></li>
<li class="book-part">Visualización de datos</li>
<li><a class="" href="tables-for-presentation.html"><span class="header-section-number">29</span> Tablas para presentaciones</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">30</span> Conceptos básicos de ggplot</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">31</span> Consejos de ggplot</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">32</span> Curvas epidémicas</a></li>
<li><a class="" href="demographic-pyramids-and-likert-scales.html"><span class="header-section-number">33</span> Pirámides de población y escalas de Likert</a></li>
<li><a class="" href="heat-plots.html"><span class="header-section-number">34</span> Gráficos de calor</a></li>
<li><a class="" href="diagrams-and-charts.html"><span class="header-section-number">35</span> Diagramas y gráficos</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">36</span> Borrador. Análisis de combinaciones</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">37</span> Borrador. Cadenas de transmisión</a></li>
<li><a class="" href="phylogenetic-trees-1.html"><span class="header-section-number">38</span> Árboles filogenéticos</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">39</span> Gráficos interactivos</a></li>
<li class="book-part">Informes y Dashboards</li>
<li><a class="" href="reports-with-r-markdown.html"><span class="header-section-number">40</span> Informes con R Markdown</a></li>
<li><a class="" href="organizing-routine-reports.html"><span class="header-section-number">41</span> Organización de informes rutinarios</a></li>
<li><a class="" href="dashboards-with-r-markdown.html"><span class="header-section-number">42</span> Borrador. Dashboards con R Markdown</a></li>
<li><a class="" href="dashboards-with-shiny.html"><span class="header-section-number">43</span> Borrador. Dashboards con Shiny</a></li>
<li class="book-part">Miscelánea</li>
<li><a class="" href="writing-functions-1.html"><span class="header-section-number">44</span> Escribir funciones</a></li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">45</span> Borrador. Interacciones con directorios</a></li>
<li><a class="" href="version-control-and-collaboration-with-git-and-github.html"><span class="header-section-number">46</span> Control de versiones y colaboración con Git y Github</a></li>
<li><a class="" href="common-errors.html"><span class="header-section-number">47</span> Errores comunes</a></li>
<li><a class="" href="getting-help.html"><span class="header-section-number">48</span> Cómo obtener ayuda</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">49</span> Borrador. R en redes locales</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">50</span> Borrador. data.table</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="working-with-dates" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Borrador. Trabajando con Fechas<a class="anchor" aria-label="anchor" href="#working-with-dates"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/Dates_500x500.png" width="50%" style="display: block; margin: auto;"></div>
<p>Trabajar con fechas en R requiere más atención que trabajar con otros tipos de objetos. A continuación, ofrecemos algunas herramientas y ejemplos para hacer este proceso menos doloroso. Por suerte, las fechas pueden manejarse fácilmente con la práctica y con un conjunto de paquetes útiles como <strong>lubridate</strong>.</p>
<p>Al importar los datos en bruto, R suele interpretar las fechas como objetos de carácter, lo que significa que no pueden utilizarse para operaciones generales con fechas, como la creación de series temporales y el cálculo de intervalos de tiempo. Para hacer las cosas más difíciles, hay muchas maneras de formatear una fecha y debes ayudar a R a saber qué parte de una fecha representa qué (mes, día, hora, etc.).</p>
<p>Las fechas en R son su propio tipo de objeto - el tipo Date. Hay que tener en cuenta que también hay un tipo que almacena objetos con fecha y hora. Los objetos fecha-hora se denominan formalmente tipos <code>POSIXt</code>, <code>POSIXct</code>, o <code>POSIXlt</code> (la diferencia no es importante). Estos objetos se denominan informalmente tipos <em>datetime</em>.</p>
<ul>
<li>Es importante hacer que R reconozca cuando una columna contiene fechas.</li>
<li>Las fechas son un tipo de objeto y pueden ser difíciles de trabajar.</li>
<li>Aquí presentamos varias formas de convertir columnas de fecha al tipo Date.</li>
</ul>
<!-- ======================================================= --><div id="preparation" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Preparación<a class="anchor" aria-label="anchor" href="#preparation"><i class="fas fa-link"></i></a>
</h2>
<div id="cargar-paquetes" class="section level3 unnumbered">
<h3>Cargar paquetes<a class="anchor" aria-label="anchor" href="#cargar-paquetes"><i class="fas fa-link"></i></a>
</h3>
<p>Este trozo de código muestra la carga de paquetes necesaria para esta página. En este manual destacamos <code><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load()</a></code> de <strong>pacman</strong>, que instala el paquete si es necesario <em>y</em> lo carga para su uso. También puedes cargar los paquetes instalados con <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> de R <strong>base</strong>. Consulta la página sobre los <a href="r-basics.html#r-basics">Fundamentos de R</a> para obtener más información sobre los paquetes de R.</p>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Ccomprueba si el paquete está instalado, lo instala si es necesario y lo carga para la sesión actual.</span>


<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span>
  <span class="va">lubridate</span>,  <span class="co"># general package for handling and converting dates  </span>
  <span class="va">linelist</span>,   <span class="co"># has function to "guess" messy dates</span>
  <span class="va">aweek</span>,      <span class="co"># another option for converting dates to weeks, and weeks to dates</span>
  <span class="va">zoo</span>,        <span class="co"># additional date/time functions</span>
  <span class="va">tidyverse</span>,  <span class="co"># data management and visualization  </span>
  <span class="va">rio</span><span class="op">)</span>        <span class="co"># data import/export</span></code></pre></div>
</div>
<div id="importar-datos" class="section level3 unnumbered">
<h3>Importar datos<a class="anchor" aria-label="anchor" href="#importar-datos"><i class="fas fa-link"></i></a>
</h3>
<p>Importamos los datos de casos de una epidemia de ébola simulada. Si deseas descargar los datos para seguirlos paso a paso, consulta las instrucciones en la página de <a href="download-handbook-and-data.html#download-handbook-and-data">descarga de manuales y datos</a>. Asumimos que el archivo está en el directorio de trabajo, por lo que no se especifican subcarpetas en esta ruta de archivo.</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_cleaned.xlsx"</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="current-date" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Fecha actual<a class="anchor" aria-label="anchor" href="#current-date"><i class="fas fa-link"></i></a>
</h2>
<p>Puedes obtener la fecha actual del “sistema” o la fecha-hora del sistema de tu ordenador haciendo lo siguiente con R <strong>base</strong>.</p>
<div class="sourceCode" id="cb314"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get the system date - this is a DATE class</span>
<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2022-10-20"</code></pre>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get the system time - this is a DATETIME class</span>
<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2022-10-20 08:54:22 CDT"</code></pre>
<p>Con el paquete <strong>lubridate</strong> también se pueden devolver con <code>today()</code> y <code>now()</code>, respectivamente. <code><a href="https://rdrr.io/r/base/date.html">date()</a></code> devuelve la fecha y la hora actuales con los nombres del día de la semana y del mes.</p>
<!-- ======================================================= -->
</div>
<div id="convert-to-date" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Convertir en fecha<a class="anchor" aria-label="anchor" href="#convert-to-date"><i class="fas fa-link"></i></a>
</h2>
<p>Después de importar unos datos a R, los valores de las columnas de fecha pueden tener el aspecto de “1989/12/30”, “05/06/2014” o “13 Ene 2020”. En estos casos, es probable que R siga tratando estos valores como valores de carácter. Hay que <em>decirle</em> a R que estos valores son fechas… y cuál es el formato de la fecha (qué parte es Día, cuál es Mes, cuál es Año, etc).</p>
<p>Una vez dicho esto, R convierte estos valores al tipo Date. En segundo plano, R almacenará las fechas como números (el número de días desde su fecha “origen” 1 Ene 1970). No interactuarás con el número de la fecha a menudo, pero esto permite a R tratar las fechas como variables continuas y permitir operaciones especiales como el cálculo de la distancia entre las fechas.</p>
<p>Por defecto, los valores del tipo Date en R se muestran como AAAA-MM-DD. Más adelante en esta sección discutiremos cómo cambiar la visualización de los valores de fecha.</p>
<p>A continuación presentamos dos enfoques para convertir una columna de valores de carácter al tipo Date.</p>
<p><span style="color: darkgreen;"><strong><em>CONSEJO:</em></strong>: Puedes comprobar el tipo actual de una columna con la función <code><a href="https://rdrr.io/r/base/class.html">class()</a></code>de R <strong>base</strong>, como <code><a href="https://rdrr.io/r/base/class.html">class(linelist$date_onset)</a></code>.</span></p>
<div id="r-base" class="section level3 unnumbered">
<h3>R <strong>base</strong><a class="anchor" aria-label="anchor" href="#r-base"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code> es la función estándar de R <strong>base</strong> para convertir un objeto o una columna en el tipo Date (nótese la “D” en mayúscula).</p>
<p>El uso de <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code> requiere que:</p>
<ul>
<li>Se especifique el formato <strong>existente</strong> de la fecha de carácter en bruto o la fecha de origen si se suministran las fechas como números (véase la sección sobre las fechas de Excel)</li>
<li>Si se utiliza en una columna de caracteres, todos los valores de fecha deben tener el mismo formato exacto (si no es el caso, pruebe con <code>guess_dates()</code> del paquete <strong>linelist</strong>)</li>
</ul>
<p>En <strong>primer</strong> lugar, comprueba el tipo de la columna con <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> de R <strong>base</strong> . Si no estás seguro o estás confundido sobre el tipo de datos (por ejemplo, ve “POSIXct”, etc.) puede ser más fácil convertir primero la columna al tipo Character con <code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code>, y luego convertirla al tipo Date.</p>
<p>En <strong>segundo</strong> lugar, dentro de la función <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code>, utiliza el argumento <code>format =</code> para indicar a R el formato <em>actual</em> de los componentes de la fecha con caracteres - qué caracteres se refieren al mes, al día y al año, y cómo están separados. Si sus valores ya están en uno de los formatos de fecha estándar de R (“AAAA-MM-DD” o “AAAA/MM/DD”) el argumento <code>format =</code> no es necesario.</p>
<p>Para usar <code>format =</code>, escribe una cadena de caracteres (entre comillas) que represente el formato <em>actual</em> de la fecha utilizando las abreviaturas especiales “strptime” que aparecen a continuación. Por ejemplo, si las fechas de caracteres están actualmente en el formato “DD/MM/AAAA”, como “24/04/1968”, entonces usarías <code>format = "%d/%m/%Y"</code> para convertir los valores en fechas. <strong>Es necesario poner el formato entre comillas. ¡Y no olvides las barras o guiones!</strong>.</p>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Convert to class date</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">date_of_onset</span>, format <span class="op">=</span> <span class="st">"%d/%m/%Y"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>La mayoría de las abreviaturas de strptime se enumeran a continuación. Puedes ver la lista completa ejecutando <code><a href="https://rdrr.io/r/base/strptime.html">?strptime</a></code>.</p>
<p>%d = Número del día del mes (5, 17, 28, etc.)
%j = Número del día del año (día juliano 001-366)
%a = Día de la semana abreviado (lunes, martes, miércoles, etc.)
%A = Día de la semana completo (lunes, martes, etc.) %w = Número del día de la semana (0-6, el domingo es 0)
%u = Número del día de la semana (1-7, el lunes es 1)
%W = Número de la semana (00-53, el lunes es el comienzo de la semana)
%U = Número de la semana (01-53, el domingo es el comienzo de la semana)
%m = Número del mes (p. ej. 01, 02, 03, 04)
%b = Mes abreviado (enero, febrero, etc.)
%B = Mes completo (enero, febrero, etc.)
%y = Año de 2 dígitos (p. ej. 89)
%Y = Año de 4 dígitos (p. ej. 1989)
%h = Horas (reloj de 24 horas)
%m = Minutos
%s = Segundos
%z = Desplazamiento respecto a GMT
%Z = Huso horario (carácter)</p>
<p><span style="color: darkgreen;"><strong><em>CONSEJO:</em></strong> El argumento <code>format =</code> de <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code> <em>no</em> le dice a R el formato que quiere que tengan las fechas, sino cómo identificar las partes de la fecha tal y como son <em>antes</em> de ejecutar el comando.</span></p>
<p><span style="color: darkgreen;"><strong><em>CONSEJO:</em></strong> Asegúrate que en el argumento <code>format =</code> se utiliza el mismo <em>separador de partes de fechas</em> (por ejemplo, /, -, o espacio) que está en tus fechas.</span></p>
<p>Una vez que los valores están en el tipo Fecha, R los mostrará por defecto en el formato estándar, que es AAAA-MM-DD.</p>
</div>
<div id="lubridate" class="section level3 unnumbered">
<h3>
<strong>lubridate</strong><a class="anchor" aria-label="anchor" href="#lubridate"><i class="fas fa-link"></i></a>
</h3>
<p>La conversión de objetos de carácter a fechas puede facilitarse utilizando el paquete <strong>lubridate</strong>. Se trata de un paquete <strong>tidyverse</strong> diseñado para hacer que el trabajo con fechas y horas sea más sencillo y consistente que en R <strong>base</strong>. Por estas razones, el paquete <strong>lubridate</strong> se considera a menudo el estándar de oro para las fechas y la hora, y se recomienda siempre que se trabaje con ellas.</p>
<p>El paquete <strong>lubridate</strong> proporciona varias funciones de ayuda diferentes diseñadas para convertir objetos de caracteres en fechas de una manera intuitiva y más indulgente que especificando el formato en <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code>. Estas funciones son específicas para el formato de fecha aproximado, pero permiten una variedad de separadores, y sinónimos para las fechas (por ejemplo, 01 vs Jan vs Enero) - se denominan según las abreviaturas de los formatos de fecha.</p>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install/load lubridate </span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span></code></pre></div>
<p>La flexibilidad de la función <code>ymd()</code> convierte de forma flexible los valores de fecha suministrados como <strong>año, luego mes y luego día</strong>.</p>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read date in year-month-day format</span>
<span class="fu">ymd</span><span class="op">(</span><span class="st">"2020-10-11"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-10-11"</code></pre>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ymd</span><span class="op">(</span><span class="st">"20201011"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-10-11"</code></pre>
<p>La función <code>mdy()</code> convierte de forma flexible los valores de fecha suministrados como <strong>mes, luego día y luego año</strong>.</p>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read date in month-day-year format</span>
<span class="fu">mdy</span><span class="op">(</span><span class="st">"10/11/2020"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-10-11"</code></pre>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mdy</span><span class="op">(</span><span class="st">"Oct 11 20"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-10-11"</code></pre>
<p>La función <code>dmy()</code> convierte de forma flexible los valores de fecha suministrados como <strong>día, luego mes y luego año.</strong></p>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read date in day-month-year format</span>
<span class="fu">dmy</span><span class="op">(</span><span class="st">"11 10 2020"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-10-11"</code></pre>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">dmy</span><span class="op">(</span><span class="st">"11 October 2020"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-10-11"</code></pre>
<!-- The `as.character()` and `as.Date()` commands can optionally be combined as:   -->
<!-- ```{r eval=F} -->
<!-- linelist_cleaned$date_of_onset <- as.Date(as.character(linelist_cleaned$date_of_onset), format = "%d/%m/%Y") -->
<!-- ``` -->
<p>Si se utilizan pipes, la conversión de una columna de caracteres a fechas con <strong>lubridate</strong> podría tener este aspecto:</p>
<div class="sourceCode" id="cb332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Una vez completado, puedes ejecutar <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> para verificar el tipo de la columna</p>
<div class="sourceCode" id="cb333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Check the class of the column</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span>  </code></pre></div>
<p>Una vez que los valores están en el tipo Fecha, R los mostrará por defecto en el formato estándar, que es AAAA-MM-DD.</p>
<p>Ten en cuenta que las funciones anteriores funcionan mejor con años de 4 dígitos. Los años de 2 dígitos pueden producir resultados inesperados, ya que <strong>lubridate</strong> intenta adivinar el siglo.</p>
<p>Para convertir un año de 2 dígitos en un año de 4 dígitos (todos en el mismo siglo) puedes convertirlo a tipo carácter y luego combinar los dígitos existentes con un prefijo usando <code>str_glue()</code> del paquete <strong>stringr</strong>. Ver <a href="characters-and-strings.html#characters-and-strings">Caracteres y cadenas</a>. A continuación, convierte a fecha.</p>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">two_digit_years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"15"</span>, <span class="st">"15"</span>, <span class="st">"16"</span>, <span class="st">"17"</span><span class="op">)</span>
<span class="fu">str_glue</span><span class="op">(</span><span class="st">"20{two_digit_years}"</span><span class="op">)</span></code></pre></div>
<pre><code>## 2015
## 2015
## 2016
## 2017</code></pre>
</div>
<div id="combinar-columnas" class="section level3 unnumbered">
<h3>Combinar columnas<a class="anchor" aria-label="anchor" href="#combinar-columnas"><i class="fas fa-link"></i></a>
</h3>
<p>Puedes utilizar las funciones de <strong>lubridate</strong> <code>make_date()</code> y <code>make_datetime()</code> para combinar varias columnas numéricas en una columna de fecha. Por ejemplo, si tiene columnas numéricas <code>onset_day</code>, <code>onset_month</code> y <code>onset_year</code> en el dataframe <code>linelist</code>:</p>
<div class="sourceCode" id="cb336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>onset_date <span class="op">=</span> <span class="fu">make_date</span><span class="op">(</span>year <span class="op">=</span> <span class="va">onset_year</span>, month <span class="op">=</span> <span class="va">onset_month</span>, day <span class="op">=</span> <span class="va">onset_day</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="excel-dates" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Fechas en Excel<a class="anchor" aria-label="anchor" href="#excel-dates"><i class="fas fa-link"></i></a>
</h2>
<p>En el fondo, la mayoría de los programas informáticos almacenan las fechas como números. R almacena las fechas desde un origen del 1 de enero de 1970. Así, si ejecutas <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric(as.Date("1970-01-01"))</a></code> obtendrás <code>0</code>.</p>
<p>Microsoft Excel almacena las fechas con un origen dependiendo del sistema operativo, del 30 de diciembre de 1899 (Windows) o del 1 de enero de 1904 (Mac). Consulta esta <a href="https://docs.microsoft.com/en-us/office/troubleshoot/excel/1900-and-1904-date-system">guía de Microsoft</a> para obtener más información.</p>
<p>Las fechas de Excel suelen importarse a R como estos valores numéricos en lugar de como caracteres. Si los datos que has importado de Excel muestran las fechas como números o caracteres como “41369”… utiliza <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code> (o la función <code>as_date()</code> de <strong>lubridate</strong>) para convertirlas, pero <strong>en lugar de suministrar un “formato” como el anterior, suministra la fecha de origen de Excel</strong> al argumento <code>origin =</code> .</p>
<p>Esto no funcionará si la fecha de Excel se almacena en R como de tipo carácter, ¡así que asegúrate de que el número es de tipo numérico!.</p>
<p><span style="color: black;"><strong><em>NOTA:</em></strong> Debes proporcionar la fecha de origen en el formato de fecha por defecto de R (“AAAA-MM-DD”).</span></p>
<div class="sourceCode" id="cb337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># An example of providing the Excel 'origin date' when converting Excel number dates</span>
<span class="va">data_cleaned</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># ensure class is numeric</span>
  <span class="fu">mutate</span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">date_onset</span>, origin <span class="op">=</span> <span class="st">"1899-12-30"</span><span class="op">)</span><span class="op">)</span> <span class="co"># convert to date using Excel origin</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="messy-dates" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Fechas desordenadas<a class="anchor" aria-label="anchor" href="#messy-dates"><i class="fas fa-link"></i></a>
</h2>
<p>La función <code>guess_dates()</code> del paquete <strong>linelist</strong> intenta leer una columna de fecha “desordenada” que contiene fechas en muchos formatos diferentes y convertir las fechas a un formato estándar. <a href="https://www.repidemicsconsortium.org/linelist/reference/guess_dates.html">Puedes leer más en línea sobre <code>guess_dates()</code></a>. Si <code>guess_dates()</code> aún no está disponible en CRAN para R 4.0.2, intenta instalarlo mediante <code><a href="https://rdrr.io/pkg/pacman/man/p_load_gh.html">pacman::p_load_gh("reconhub/linelist")</a></code>.</p>
<p>Por ejemplo <code>guess_dates</code> vería un vector de las siguientes fechas de caracteres “03 Ene 2018”, “07/03/1982”, y “08/20/85” y las convertiría al tipo Date como <code>2018-01-03</code>, <code>1982-03-07</code>, y <code>1985-08-20</code>.</p>
<div class="sourceCode" id="cb338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">linelist</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/linelist/man/guess_dates.html">guess_dates</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"03 Jan 2018"</span>,
                        <span class="st">"07/03/1982"</span>,
                        <span class="st">"08/20/85"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2018-01-03" "1982-03-07" "1985-08-20"</code></pre>
<p>Algunos argumentos opcionales para <code>guess_dates()</code> que puede incluir son:</p>
<ul>
<li>
<code>error_tolerance</code> - Proporción de entradas que no pueden ser identificadas como fechas a tolerar (por defecto 0,1 o 10%)</li>
<li>
<code>last_date</code> - la última fecha válida (por defecto, la fecha actual)</li>
<li>
<code>first_date</code> - la primera fecha válida. Por defecto, cincuenta años antes de last_date.</li>
</ul>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="working-with-dates.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># An example using guess_dates on the column dater_onset</span></span>
<span id="cb340-2"><a href="working-with-dates.html#cb340-2" aria-hidden="true" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span>                 <span class="co"># the dataset is called linelist</span></span>
<span id="cb340-3"><a href="working-with-dates.html#cb340-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb340-4"><a href="working-with-dates.html#cb340-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_onset =</span> linelist<span class="sc">::</span><span class="fu">guess_dates</span>(  <span class="co"># the guess_dates() from package "linelist"</span></span>
<span id="cb340-5"><a href="working-with-dates.html#cb340-5" aria-hidden="true" tabindex="-1"></a>      date_onset,</span>
<span id="cb340-6"><a href="working-with-dates.html#cb340-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">error_tolerance =</span> <span class="fl">0.1</span>,</span>
<span id="cb340-7"><a href="working-with-dates.html#cb340-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">first_date =</span> <span class="st">"2016-01-01"</span></span>
<span id="cb340-8"><a href="working-with-dates.html#cb340-8" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="working-with-date-time-class" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> Trabajar con el tipo fecha-hora<a class="anchor" aria-label="anchor" href="#working-with-date-time-class"><i class="fas fa-link"></i></a>
</h2>
<p>Como se mencionó anteriormente, R también soporta un tipo <code>datetime</code> - una columna que contiene información de fecha <strong>y</strong> hora. Al igual que con el tipo Date, a menudo es necesario convertirlas de objetos <code>character</code> a objetos <code>datetime</code>.</p>
<div id="convertir-fechas-con-horas" class="section level3 unnumbered">
<h3>Convertir fechas con horas<a class="anchor" aria-label="anchor" href="#convertir-fechas-con-horas"><i class="fas fa-link"></i></a>
</h3>
<p>Un objeto <code>datetime</code> estándar se formatea con la fecha en primer lugar, seguida de un componente de tiempo - por ejemplo, <em>01 Ene 2020, 16:30</em>. Al igual que con las fechas, hay muchas maneras de formatearlas, y hay numerosos niveles de precisión (horas, minutos, segundos) que se pueden suministrar.</p>
<p>Por suerte, también existen funciones de ayuda <strong>de lubridate</strong> para ayudar a convertir estas cadenas en objetos <code>datetime</code>. Estas funciones son extensiones de las funciones de ayuda a la fecha, con <code>_h</code> (sólo se suministran las horas), <code>_hm</code> (se suministran las horas y los minutos), o <code>_hms</code> (se suministran las horas, los minutos y los segundos) añadidas al final (por ejemplo, <code>dmy_hms()</code>). Se pueden utilizar como se indica:</p>
<p>Convertir <code>datetime</code> con sólo horas a objeto <code>datetime</code></p>
<div class="sourceCode" id="cb341"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ymd_h</span><span class="op">(</span><span class="st">"2020-01-01 16hrs"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-01-01 16:00:00 UTC"</code></pre>
<div class="sourceCode" id="cb343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ymd_h</span><span class="op">(</span><span class="st">"2020-01-01 4PM"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-01-01 04:00:00 UTC"</code></pre>
<p>Convertir <code>datetime</code> con horas y minutos a objeto <code>datetime</code></p>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">dmy_hm</span><span class="op">(</span><span class="st">"01 January 2020 16:20"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-01-01 16:20:00 UTC"</code></pre>
<p>Convertir <code>datetime</code> con horas, minutos y segundos a objeto <code>datetime</code></p>
<div class="sourceCode" id="cb347"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mdy_hms</span><span class="op">(</span><span class="st">"01 January 2020, 16:20:40"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-01-20 16:20:40 UTC"</code></pre>
<p>Puedes indicar la zona horaria, pero se ignora. Consulta la sección más adelante en esta página sobre las zonas horarias.</p>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mdy_hms</span><span class="op">(</span><span class="st">"01 January 2020, 16:20:40 PST"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-01-20 16:20:40 UTC"</code></pre>
<p>Cuando se trabaja con un dataframe, las columnas de fecha y hora pueden combinarse para crear una columna de fecha y hora utilizando <code>str_glue()</code>del paquete <strong>stringr</strong> y una función apropiada de <strong>lubridate</strong>. Consulta la página sobre <a href="characters-and-strings.html#characters-and-strings">Caracteres y cadenas</a> para obtener detalles sobre <strong>stringr</strong>.</p>
<p>En este ejemplo, el dataframe <code>linelist</code> tiene una columna con formato “horas:minutos”. Para convertirla en una fecha, hay que seguir algunos pasos:</p>
<ol style="list-style-type: decimal">
<li>Crea una columna de tiempo de admisión “limpia” con los valores faltantes rellenados con la mediana de la columna. Hacemos esto porque <strong>lubridate</strong> no opera con valores faltantes. Combínala con la columna <code>date_hospitalisation</code> y utiliza la función <code>ymd_hm()</code> para convertirla.</li>
</ol>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="working-with-dates.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># packages</span></span>
<span id="cb351-2"><a href="working-with-dates.html#cb351-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, lubridate, stringr)</span>
<span id="cb351-3"><a href="working-with-dates.html#cb351-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-4"><a href="working-with-dates.html#cb351-4" aria-hidden="true" tabindex="-1"></a><span class="co"># time_admission is a column in hours:minutes</span></span>
<span id="cb351-5"><a href="working-with-dates.html#cb351-5" aria-hidden="true" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span></span>
<span id="cb351-6"><a href="working-with-dates.html#cb351-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb351-7"><a href="working-with-dates.html#cb351-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># when time of admission is not given, assign the median admission time</span></span>
<span id="cb351-8"><a href="working-with-dates.html#cb351-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb351-9"><a href="working-with-dates.html#cb351-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_admission_clean =</span> <span class="fu">ifelse</span>(</span>
<span id="cb351-10"><a href="working-with-dates.html#cb351-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(time_admission),         <span class="co"># if time is missing</span></span>
<span id="cb351-11"><a href="working-with-dates.html#cb351-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(time_admission),        <span class="co"># assign the median</span></span>
<span id="cb351-12"><a href="working-with-dates.html#cb351-12" aria-hidden="true" tabindex="-1"></a>      time_admission                 <span class="co"># if not missing keep as is</span></span>
<span id="cb351-13"><a href="working-with-dates.html#cb351-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb351-14"><a href="working-with-dates.html#cb351-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb351-15"><a href="working-with-dates.html#cb351-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># use str_glue() to combine date and time columns to create one character column</span></span>
<span id="cb351-16"><a href="working-with-dates.html#cb351-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and then use ymd_hm() to convert it to datetime</span></span>
<span id="cb351-17"><a href="working-with-dates.html#cb351-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb351-18"><a href="working-with-dates.html#cb351-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_time_of_admission =</span> <span class="fu">str_glue</span>(<span class="st">"{date_hospitalisation} {time_admission_clean}"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb351-19"><a href="working-with-dates.html#cb351-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ymd_hm</span>()</span>
<span id="cb351-20"><a href="working-with-dates.html#cb351-20" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="convertir-sólo-horas" class="section level3 unnumbered">
<h3>Convertir sólo horas<a class="anchor" aria-label="anchor" href="#convertir-s%C3%B3lo-horas"><i class="fas fa-link"></i></a>
</h3>
<p>Si tus datos contienen sólo un carácter de tiempo (horas y minutos), puedes convertirlos y manipularlos como tiempos utilizando <code><a href="https://rdrr.io/r/base/strptime.html">strptime()</a></code> desde R <strong>base</strong>. Por ejemplo, para obtener la diferencia entre dos de estos horas:</p>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># raw character times</span>
<span class="va">time1</span> <span class="op">&lt;-</span> <span class="st">"13:45"</span> 
<span class="va">time2</span> <span class="op">&lt;-</span> <span class="st">"15:20"</span>

<span class="co"># Times converted to a datetime class</span>
<span class="va">time1_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="va">time1</span>, format <span class="op">=</span> <span class="st">"%H:%M"</span><span class="op">)</span>
<span class="va">time2_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="va">time2</span>, format <span class="op">=</span> <span class="st">"%H:%M"</span><span class="op">)</span>

<span class="co"># Difference is of class "difftime" by default, here converted to numeric hours </span>
<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">time2_clean</span> <span class="op">-</span> <span class="va">time1_clean</span><span class="op">)</span>   <span class="co"># difference in hours</span></code></pre></div>
<pre><code>## [1] 1.583333</code></pre>
<p>Sin embargo, ten en cuenta que si no se proporciona un valor de fecha, se asume que la fecha es hoy. Para combinar una cadena de fecha y una cadena de hora, observa cómo se usa <strong>stringr</strong> en la sección anterior. Puedes leer más sobre <code><a href="https://rdrr.io/r/base/strptime.html">strptime()</a></code> <a href="https://rdrr.io/r/base/strptime.html">aquí</a>.</p>
<p>Para convertir números de un solo dígito a dos dígitos (por ejemplo, para “rellenar” las horas o los minutos con ceros a la izquierda para conseguir 2 dígitos), consulta la <a href="characters-and-strings.html#str_pad">sección “Longitud de relleno” de la página Caracteres y cadenas</a>.</p>
</div>
<div id="extraer-fracciones-de-hora" class="section level3 unnumbered">
<h3>Extraer fracciones de hora<a class="anchor" aria-label="anchor" href="#extraer-fracciones-de-hora"><i class="fas fa-link"></i></a>
</h3>
<p>Puedes extraer elementos de una hora con <code>hour()</code>, <code>minute()</code>, o <code>second()</code> de <strong>lubridate</strong>.</p>
<p>He aquí un ejemplo de extracción de la hora y posterior clasificación como parte del día. Comenzamos con la columna <code>time_admission</code>, que es de tipo Carácter en formato “HH:MM”. En primer lugar, se utiliza <code><a href="https://rdrr.io/r/base/strptime.html">strptime()</a></code> como se ha descrito anteriormente para convertir los caracteres en <code>tipo datetime</code>. A continuación, se extrae la hora con <code>hour()</code>, devolviendo un número del 0 al 24. Por último, se crea una columna <code>time_period</code> utilizando la lógica con <code>case_when()</code> para clasificar las filas en Mañana/Tarde/Anochecer/Noche en función de su hora de entrada.</p>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>hour_admit <span class="op">=</span> <span class="fu">hour</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="va">time_admission</span>, format <span class="op">=</span> <span class="st">"%H:%M"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>time_period <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
    <span class="va">hour_admit</span> <span class="op">&gt;</span> <span class="fl">06</span> <span class="op">&amp;</span> <span class="va">hour_admit</span> <span class="op">&lt;</span> <span class="fl">12</span> <span class="op">~</span> <span class="st">"Morning"</span>,
    <span class="va">hour_admit</span> <span class="op">&gt;=</span> <span class="fl">12</span> <span class="op">&amp;</span> <span class="va">hour_admit</span> <span class="op">&lt;</span> <span class="fl">17</span> <span class="op">~</span> <span class="st">"Afternoon"</span>,
    <span class="va">hour_admit</span> <span class="op">&gt;=</span> <span class="fl">17</span> <span class="op">&amp;</span> <span class="va">hour_admit</span> <span class="op">&lt;</span> <span class="fl">21</span> <span class="op">~</span> <span class="st">"Evening"</span>,
    <span class="va">hour_admit</span> <span class="op">&gt;=</span><span class="fl">21</span> <span class="op">|</span> <span class="va">hour_admit</span> <span class="op">&lt;=</span> <span class="fl">6</span> <span class="op">~</span> <span class="st">"Night"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Para saber más sobre <code>case_when()</code>, consulta la página sobre <a href="cleaning-data-and-core-functions.html#cleaning-data-and-core-functions">Limpieza de datos y funciones básicas</a>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="working-with-dates-1" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Trabajar con fechas<a class="anchor" aria-label="anchor" href="#working-with-dates-1"><i class="fas fa-link"></i></a>
</h2>
<p><code>lubridate</code> también puede utilizarse para otras funciones, como la <strong>extracción de aspectos de una fecha/hora</strong>, <strong>realización de cálculos aritméticos de fechas</strong> o <strong>cálculo de intervalos de fechas</strong></p>
<p>Aquí definimos una fecha que se utilizará para los ejemplos:</p>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create object of class Date</span>
<span class="va">example_date</span> <span class="op">&lt;-</span> <span class="fu">ymd</span><span class="op">(</span><span class="st">"2020-03-01"</span><span class="op">)</span></code></pre></div>
<div id="extraer-los-componentes-de-la-fecha" class="section level3 unnumbered">
<h3>Extraer los componentes de la fecha<a class="anchor" aria-label="anchor" href="#extraer-los-componentes-de-la-fecha"><i class="fas fa-link"></i></a>
</h3>
<p>Puedes extraer aspectos comunes como el mes, el día, el día de la semana:</p>
<div class="sourceCode" id="cb356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">month</span><span class="op">(</span><span class="va">example_date</span><span class="op">)</span>  <span class="co"># month number</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">day</span><span class="op">(</span><span class="va">example_date</span><span class="op">)</span>    <span class="co"># day (number) of the month</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">wday</span><span class="op">(</span><span class="va">example_date</span><span class="op">)</span>   <span class="co"># day number of the week (1-7)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>También puede extraer componentes de tiempo de un objeto o columna <code>datetime</code>. Esto puede ser útil si quieres ver la distribución de los tiempos de admisión.</p>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_datetime</span> <span class="op">&lt;-</span> <span class="fu">ymd_hm</span><span class="op">(</span><span class="st">"2020-03-01 14:45"</span><span class="op">)</span>

<span class="fu">hour</span><span class="op">(</span><span class="va">example_datetime</span><span class="op">)</span>     <span class="co"># extract hour</span>
<span class="fu">minute</span><span class="op">(</span><span class="va">example_datetime</span><span class="op">)</span>   <span class="co"># extract minute</span>
<span class="fu">second</span><span class="op">(</span><span class="va">example_datetime</span><span class="op">)</span>   <span class="co"># extract second</span></code></pre></div>
<p>Hay varias opciones para recuperar las semanas. Consulta la sección sobre semanas epidemiológicas más abajo.</p>
<p>Ten en cuenta que si deseas <em>mostrar</em> una fecha de una forma determinada (por ejemplo, “enero de 2020” o “jueves 20 de marzo” o “semana 20 de 1977”) puedes hacerlo de forma más flexible, tal y como se describe en la sección sobre Visualización de fechas.</p>
</div>
<div id="fecha-matemática" class="section level3 unnumbered">
<h3>Fecha matemática<a class="anchor" aria-label="anchor" href="#fecha-matem%C3%A1tica"><i class="fas fa-link"></i></a>
</h3>
<p>Puedes añadir ciertos números de días o semanas utilizando su respectiva función de <strong>lubridate</strong>.</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add 3 days to this date</span>
<span class="va">example_date</span> <span class="op">+</span> <span class="fu">days</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-03-04"</code></pre>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add 7 weeks and subtract two days from this date</span>
<span class="va">example_date</span> <span class="op">+</span> <span class="fu">weeks</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span> <span class="op">-</span> <span class="fu">days</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2020-04-17"</code></pre>
</div>
<div id="intervalos-de-fechas" class="section level3 unnumbered">
<h3>Intervalos de fechas<a class="anchor" aria-label="anchor" href="#intervalos-de-fechas"><i class="fas fa-link"></i></a>
</h3>
<p>La diferencia entre las fechas se puede calcular mediante:</p>
<ol style="list-style-type: decimal">
<li>Asegúrate que ambas fechas son del mismo tipo</li>
<li>Utiliza la resta para devolver la diferencia “difftime” entre las dos fechas</li>
<li>Si es necesario, convierte el resultado en tipo numéricoa para realizar los cálculos matemáticos posteriores</li>
</ol>
<p>A continuación se calcula y muestra el intervalo entre dos fechas. Se pueden encontrar intervalos utilizando el símbolo de resta “menos” en los valores que son de tipo Fecha. Ten en cuenta, sin embargo, que el tipo del valor devuelto es “difftime”, como se muestra a continuación, y debe ser convertido a numérico.</p>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># find the interval between this date and Feb 20 2020 </span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="va">example_date</span> <span class="op">-</span> <span class="fu">ymd</span><span class="op">(</span><span class="st">"2020-02-20"</span><span class="op">)</span>
<span class="va">output</span>    <span class="co"># print</span></code></pre></div>
<pre><code>## Time difference of 10 days</code></pre>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "difftime"</code></pre>
<p>Para realizar operaciones posteriores sobre un “difftime”, conviértelo en numérico con <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code>.</p>
<p>Todo esto puede unirse para trabajar con datos, por ejemplo:</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">lubridate</span>, <span class="va">tidyverse</span><span class="op">)</span>   <span class="co"># load packages</span>

<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span>
  
  <span class="co"># convert date of onset from character to date objects by specifying dmy format</span>
  <span class="fu">mutate</span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu">dmy</span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span>,
         date_hospitalisation <span class="op">=</span> <span class="fu">dmy</span><span class="op">(</span><span class="va">date_hospitalisation</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="co"># filter out all cases without onset in march</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">month</span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span>
    
  <span class="co"># find the difference in days between onset and hospitalisation</span>
  <span class="fu">mutate</span><span class="op">(</span>days_onset_to_hosp <span class="op">=</span> <span class="va">date_hospitalisation</span> <span class="op">-</span> <span class="va">date_of_onset</span><span class="op">)</span></code></pre></div>
<p>En un contexto de dataframe, si falta alguna de las fechas anteriores, la operación fallará para esa fila. El resultado será un NA en lugar de un valor numérico. Cuando utilices esta columna para los cálculos, asegúrate de establecer el argumento <code>na.rm</code> = en TRUE. Por ejemplo:</p>
<div class="sourceCode" id="cb372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate the median number of days to hospitalisation for all cases where data are available</span>
<span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">linelist_delay</span><span class="op">$</span><span class="va">days_onset_to_hosp</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="date-display" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> Visualización de fechas<a class="anchor" aria-label="anchor" href="#date-display"><i class="fas fa-link"></i></a>
</h2>
<p>Una vez que las fechas son del tipo correcto, a menudo se desea mostrarlas de forma diferente, por ejemplo para que se muestren como “lunes 05 de enero” en lugar de “2018-01-05”. También puedes querer ajustar la visualización para agrupar las filas por los elementos de fecha mostrados, por ejemplo, para agrupar por mes-año.</p>
<div id="format" class="section level3 unnumbered">
<h3>
<code>format()</code><a class="anchor" aria-label="anchor" href="#format"><i class="fas fa-link"></i></a>
</h3>
<p>Ajusta la visualización de la fecha con la función <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> de R <strong>base</strong>. Esta función acepta una cadena de caracteres (entre comillas) que especifica el formato de salida <em>deseado</em> en las abreviaturas strptime “%” (la misma sintaxis que se utiliza en <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code>). A continuación se muestran las abreviaturas más comunes.</p>
<p>Nota: el uso de <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> convertirá los valores al tipo Character, por lo que generalmente se utiliza hacia el final de un análisis o sólo para fines de visualización. Puedes ver la lista completa ejecutando <code><a href="https://rdrr.io/r/base/strptime.html">?strptime</a></code>.</p>
<p>%d = Número del día del mes (5, 17, 28, etc.)
%j = Número del día del año (día juliano 001-366)
%a = Día de la semana abreviado (lunes, martes, miércoles, etc.)
%A = Día de la semana completo (lunes, martes, etc.)
%w = Número del día de la semana (0-6, el domingo es 0)
%u = Número del día de la semana (1-7, el lunes es 1)
%W = Número de la semana (00-53, el lunes es el comienzo de la semana)
%U = Número de la semana (01-53, el domingo es el comienzo de la semana)
%m = Número del mes (p. ej. 01, 02, 03, 04)
%b = Mes abreviado (enero, febrero, etc.)
%B = Mes completo (enero, febrero, etc.)
%y = Año de 2 dígitos (p. ej. 89)
%Y = Año de 4 dígitos (p. ej. 1989)
%h = Horas (reloj de 24 horas)
%m = Minutos
%s = Segundos
%z = Desplazamiento respecto a GMT
%Z = Huso horario (carácter)</p>
<p>Un ejemplo de formato de la fecha de hoy:</p>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># today's date, with formatting</span>
<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%d %B %Y"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "20 octubre 2022"</code></pre>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># easy way to get full date and time (default formatting)</span>
<span class="fu"><a href="https://rdrr.io/r/base/date.html">date</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Thu Oct 20 08:54:23 2022"</code></pre>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># formatted combined date, time, and time zone using str_glue() function</span>
<span class="fu">str_glue</span><span class="op">(</span><span class="st">"{format(Sys.Date(), format = '%A, %B %d %Y, %z  %Z, ')}{format(Sys.time(), format = '%H:%M:%S')}"</span><span class="op">)</span></code></pre></div>
<pre><code>## jueves, octubre 20 2022, +0000  UTC, 08:54:23</code></pre>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using format to display weeks</span>
<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y Week %W"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2022 Week 42"</code></pre>
<p>Ten en cuenta que si utilizas <code>str_glue()</code>, dentro de las comillas dobles ” sólo debes utilizar comillas simples (como arriba).</p>
</div>
<div id="mes-año" class="section level3 unnumbered">
<h3>Mes-Año<a class="anchor" aria-label="anchor" href="#mes-a%C3%B1o"><i class="fas fa-link"></i></a>
</h3>
<p>Para convertir una columna de fecha al formato mes-año, te sugerimos que utilice la función <code>as.yearmon()</code> del paquete <strong>zoo</strong>. Esto convierte la fecha al tipo “yearmon” y mantiene el orden correcto. Por el contrario, usar <code><a href="https://rdrr.io/r/base/format.html">format(columna, "%Y %B")</a></code> convertirá al tipo Carácter y ordenará los valores alfabéticamente (incorrectamente).</p>
<p>A continuación, se crea una nueva columna <code>yearmonth</code> a partir de la columna <code>date_onset</code>, utilizando la función as.yearmon()`. La ordenación por defecto (correcta) de los valores resultantes se muestra en la tabla.</p>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create new column </span>
<span class="va">test_zoo</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
     <span class="fu">mutate</span><span class="op">(</span>yearmonth <span class="op">=</span> <span class="fu">zoo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.yearmon</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span><span class="op">)</span>

<span class="co"># print table</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">test_zoo</span><span class="op">$</span><span class="va">yearmon</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## abr. 2014 may. 2014 jun. 2014 jul. 2014 ago. 2014 sep. 2014 oct. 2014 
##         7        64       100       226       528      1070      1112 
## nov. 2014 dic. 2014 ene. 2015 feb. 2015 mar. 2015 abr. 2015 
##       763       562       431       306       277       186</code></pre>
<p>Por el contrario, se puede ver cómo sólo utilizando <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> se consigue el formato de visualización deseado, pero no el orden correcto.</p>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create new column</span>
<span class="va">test_format</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
     <span class="fu">mutate</span><span class="op">(</span>yearmonth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="st">"%b %Y"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># print table</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">test_format</span><span class="op">$</span><span class="va">yearmon</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## abr. 2014 abr. 2015 ago. 2014 dic. 2014 ene. 2015 feb. 2015 jul. 2014 
##         7       186       528       562       431       306       226 
## jun. 2014 mar. 2015 may. 2014 nov. 2014 oct. 2014 sep. 2014 
##       100       277        64       763      1112      1070</code></pre>
<p>Nota: si estás trabajando con <code>ggplot()</code> y quieres ajustar sólo cómo se <em>muestran</em> las fechas, puede ser suficiente proporcionar un formato strptime al argumento <code>date_labels =</code> en <code>scale_x_date()</code> - puedes utilizar <code>"%b %Y"</code> o <code>"%Y %b"</code>. Consulta la página de <a href="ggplot-tips.html#ggplot-tips">consejos de ggplot</a>.</p>
<p><strong>zoo</strong> también ofrece la función <code>as.yearqtr()</code>, y puedes usar <code>scale_x_yearmon()</code> cuando uses <code>ggplot()</code>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="dates_epi_wks" class="section level2" number="9.9">
<h2>
<span class="header-section-number">9.9</span> Semanas epidemiológicas<a class="anchor" aria-label="anchor" href="#dates_epi_wks"><i class="fas fa-link"></i></a>
</h2>
<div id="lubridate-1" class="section level3 unnumbered">
<h3>
<strong>lubridate</strong><a class="anchor" aria-label="anchor" href="#lubridate-1"><i class="fas fa-link"></i></a>
</h3>
<p>Consulta la página sobre <a href="grouping-data.html#grouping-data">Agrupar datos</a> para ver ejemplos más extensos de agrupación de datos por fecha. A continuación describimos brevemente la agrupación de datos por semanas.</p>
<p>Generalmente recomendamos utilizar la función <code>floor_date()</code> de <strong>lubridate</strong>, con el argumento <code>unit = "week"</code>. Esto redondea la fecha hacia abajo al “inicio” de la semana, como se define por el argumento <code>week_start =</code>. El inicio de la semana por defecto es el 1 (para los lunes), pero se puede especificar cualquier día de la semana como inicio (por ejemplo, el 7 para los domingos). <code>floor_date()</code> es versátil y se puede utilizar para redondear hacia abajo a otras unidades de tiempo estableciendo <code>unit =</code> “second”, “minute”, “hour”, “day”, “month”, o “year”.</p>
<p>El valor devuelto es la fecha de inicio de la semana, en tipo Date. El tipo <code>Date</code> es útil a la hora de representar los datos, ya que serán fácilmente reconocidos y ordenados correctamente por <code>ggplot()</code>.</p>
<p>Si sólo tienes interés en ajustar las fechas para que <em>se muestren</em> por semanas en un gráfico, consulta la sección de esta página sobre Visualización de fechas. Por ejemplo, al representar una epicurva puedes formatear la visualización de la fecha proporcionando la nomenclatura strptime “%” deseada. Por ejemplo, utiliza “%Y-%W” o “%Y-%U” para devolver el año y el número de semana (dado el comienzo de la semana del lunes o del domingo, respectivamente).</p>
</div>
<div id="recuentos-semanales" class="section level3 unnumbered">
<h3>Recuentos semanales<a class="anchor" aria-label="anchor" href="#recuentos-semanales"><i class="fas fa-link"></i></a>
</h3>
<p>Consulta la página sobre <a href="grouping-data.html#grouping-data">Agrupar datos</a> para obtener una explicación detallada de la agrupación de datos con <code>count()</code>, <code>group_by()</code>, and <code>summarise()</code>. A continuación se muestra un breve ejemplo.</p>
<ol style="list-style-type: decimal">
<li><p>Crear una nueva columna “semana” con <code>mutate()</code>, utilizando <code>floor_date()</code> con <code>unit = "week"</code></p></li>
<li><p>Obtener el recuento de filas (casos) por semana con <code>count()</code>; filtra los casos a los que les falte la fecha</p></li>
<li><p>Termina con <code>complete()</code> de <strong>tidyr</strong> para asegurarte que <em>todas</em> las semanas aparecen en los datos - incluso las que no tienen filas/casos. Por defecto, los valores de recuento para cualquier fila “nueva” son NA, pero puedes hacerlos 0 con el argumento <code>fill =</code>, que espera una lista con nombre (abajo, <code>n</code> es el nombre de la columna de recuentos).</p></li>
</ol>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Make aggregated dataset of weekly case counts</span>
<span class="va">weekly_counts</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">drop_na</span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span> <span class="op">%&gt;%</span>             <span class="co"># remove cases missing onset date</span>
  <span class="fu">mutate</span><span class="op">(</span>weekly_cases <span class="op">=</span> <span class="fu">floor_date</span><span class="op">(</span>   <span class="co"># make new column, week of onset</span>
    <span class="va">date_onset</span>,
    unit <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>            
  <span class="fu">count</span><span class="op">(</span><span class="va">weekly_cases</span><span class="op">)</span> <span class="op">%&gt;%</span>           <span class="co"># group data by week and count rows per group (creates column 'n')</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html">complete</a></span><span class="op">(</span>                  <span class="co"># ensure all weeks are present, even those with no cases reported</span>
    weekly_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span>          <span class="co"># re-define the "weekly_cases" column as a complete sequence,</span>
      from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">weekly_cases</span><span class="op">)</span>,       <span class="co"># from the minimum date</span>
      to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">weekly_cases</span><span class="op">)</span>,         <span class="co"># to the maxiumum date</span>
      by <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span>,                   <span class="co"># by weeks</span>
    fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>             <span class="co"># fill-in NAs in the n counts column with 0</span></code></pre></div>
<p>Aquí están las primeras filas del dataframe resultante:</p>
<div id="htmlwidget-525025dd9d2139dd1069" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-525025dd9d2139dd1069">{"x":{"filter":"none","vertical":false,"data":[["2014-04-06","2014-04-13","2014-04-20","2014-04-27","2014-05-04","2014-05-11","2014-05-18","2014-05-25","2014-06-01","2014-06-08","2014-06-15","2014-06-22","2014-06-29","2014-07-06","2014-07-13","2014-07-20","2014-07-27","2014-08-03","2014-08-10","2014-08-17"],[1,1,4,4,12,14,14,21,21,18,30,23,31,35,55,58,80,86,114,122]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>weekly_cases<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="alternativas-a-epiweek" class="section level3 unnumbered">
<h3>Alternativas a Epiweek<a class="anchor" aria-label="anchor" href="#alternativas-a-epiweek"><i class="fas fa-link"></i></a>
</h3>
<p>Ten en cuenta que <strong>lubridate</strong> también tiene las funciones <code>week()</code>, <code>epiweek()</code>, e <code>isoweek()</code>, cada una de las cuales tiene fechas de inicio ligeramente diferentes y otros matices. Sin embargo, en términos generales, <code>floor_date()</code> debería ser todo lo que necesitas. Puedes leer más detalles de estas funciones introduciendo ?week en la consola o leyendo la documentación <a href="https://www.rdocumentation.org/packages/lubridate/versions/1.7.4/topics/week">aquí</a>.</p>
<p>Puedes usar del paquete <strong>aweek</strong> para establecer semanas epidemiológicas. Puedes leer más sobre él <a href="https://www.repidemicsconsortium.org/aweek/">en el sitio web de RECON</a>. Tiene las funciones <code>date2week()</code> y <code>week2date()</code> en las que se puede establecer el día de inicio de la semana con <code>week_start = "Monday"</code>. Este paquete es el más fácil si se desea obtener resultados del tipo “week” (por ejemplo, “2020-W12”). Otra ventaja de <strong>aweek</strong> es que cuando <code>date2week()</code> se aplica a una columna de fecha, la columna devuelta (formato de semana) es automáticamente del tipo Factor e incluye niveles para todas las semanas en el lapso de tiempo (esto evita el paso extra de <code>complete()</code> descrito anteriormente). Sin embargo, <strong>aweek</strong> no tiene la funcionalidad de redondear fechas a otras unidades de tiempo como meses, años, etc.</p>
<p>Otra alternativa para las series temporales que también funciona bien para mostrar un formato de “semana” (“2020 W12”) es <code>yearweek()</code> del paquete <strong>tsibble</strong>, como se demuestra en la página sobre <a href="time-series-and-outbreak-detection.html#time-series-and-outbreak-detection">series temporales y detección de brotes</a>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="converting-datestime-zones" class="section level2" number="9.10">
<h2>
<span class="header-section-number">9.10</span> Conversión de fechas/zonas horarias<a class="anchor" aria-label="anchor" href="#converting-datestime-zones"><i class="fas fa-link"></i></a>
</h2>
<p>Cuando los datos están presentes en diferentes husos horarios, a menudo puede ser importante normalizar estos datos en un huso horario unificado. Esto puede suponer un reto adicional, ya que el componente de zona horaria de los datos debe codificarse manualmente en la mayoría de los casos.</p>
<p>En R, cada objeto <em>datetime</em> tiene un componente de zona horaria. Por defecto, todos los objetos <code>datetime</code> llevarán la zona horaria local para el ordenador que se está utilizando - esto es generalmente específico para una <em>ubicación</em> en lugar de una zona horaria, ya que las zonas horarias a menudo cambian en los lugares debido al horario de verano. No es posible compensar con precisión las zonas horarias sin un componente de tiempo de una fecha, ya que el evento que representa una columna de fecha no puede ser atribuido a un tiempo específico, y por lo tanto los cambios de tiempo medidos en horas no pueden ser razonablemente contabilizados.</p>
<p>Para tratar las zonas horarias, hay una serie de funciones de ayuda en lubridate que pueden utilizarse para cambiar la zona horaria de un objeto <code>datetime</code> de la zona horaria local a una zona horaria diferente. Las zonas horarias se establecen atribuyendo una zona horaria válida de la base de datos tz al objeto <code>datetime</code>. <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">Aquí</a> se puede encontrar una lista de éstas - si la ubicación que se está utilizando en los datos no está en esta lista, las grandes ciudades cercanas en la zona horaria están disponibles y sirven para el mismo propósito.</p>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># assign the current time to a column</span>
<span class="va">time_now</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">time_now</span></code></pre></div>
<pre><code>## [1] "2022-10-20 08:54:24 CDT"</code></pre>
<div class="sourceCode" id="cb388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use with_tz() to assign a new timezone to the column, while CHANGING the clock time</span>
<span class="va">time_london_real</span> <span class="op">&lt;-</span> <span class="fu">with_tz</span><span class="op">(</span><span class="va">time_now</span>, <span class="st">"Europe/London"</span><span class="op">)</span>

<span class="co"># use force_tz() to assign a new timezone to the column, while KEEPING the clock time</span>
<span class="va">time_london_local</span> <span class="op">&lt;-</span> <span class="fu">force_tz</span><span class="op">(</span><span class="va">time_now</span>, <span class="st">"Europe/London"</span><span class="op">)</span>


<span class="co"># note that as long as the computer that was used to run this code is NOT set to London time,</span>
<span class="co"># there will be a difference in the times </span>
<span class="co"># (the number of hours difference from the computers time zone to london)</span>
<span class="va">time_london_real</span> <span class="op">-</span> <span class="va">time_london_local</span></code></pre></div>
<pre><code>## Time difference of 6 hours</code></pre>
<p>Esto puede parecer muy abstracto, y a menudo no es necesario si el usuario no está trabajando a través de zonas horarias.</p>
<!-- ======================================================= -->
</div>
<div id="lagging-and-leading-calculations" class="section level2" number="9.11">
<h2>
<span class="header-section-number">9.11</span> Cálculos de retardo y de avance<a class="anchor" aria-label="anchor" href="#lagging-and-leading-calculations"><i class="fas fa-link"></i></a>
</h2>
<p><code>lead()</code> y <code><a href="https://rdrr.io/r/stats/lag.html">lag()</a></code> son funciones del paquete <strong>dplyr</strong> que ayudan a encontrar los valores anteriores (retardados) o posteriores (principales) en un vector, normalmente un vector numérico o de fechas. Esto es útil cuando se hacen cálculos de cambio/diferencia entre unidades de tiempo.`</p>
<p>Supongamos que se quiere calcular la diferencia de casos entre una semana actual y la anterior. Los datos se proporcionan inicialmente en recuentos semanales, como se muestra a continuación.</p>
<div id="htmlwidget-ae92049efda7bd481dce" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ae92049efda7bd481dce">{"x":{"filter":"none","vertical":false,"data":[["2019-06-23","2019-06-30","2019-07-07","2019-07-14","2019-07-21","2019-07-28","2019-08-04","2019-08-11","2019-08-18","2019-08-25","2019-09-01","2019-09-08","2019-09-15","2019-09-22","2019-09-29","2019-10-06","2019-10-13","2019-10-20","2019-10-27","2019-11-03","2019-11-10","2019-11-17","2019-11-24","2019-12-01","2019-12-08","2019-12-15","2019-12-22","2019-12-29"],[0,25,59,90,65,79,41,47,31,32,28,28,76,41,70,90,124,278,371,329,177,69,77,97,100,39,19,0]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>week_start<\/th>\n      <th>cases_wk<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p><strong>Al utilizar lag() o lead(), el orden de las filas en el dataframe es muy importante. - presta atención a si tus fechas/números son ascendentes o descendentes</strong></p>
<p>En primer lugar, crea una nueva columna que contenga el valor de la semana anterior (retardada).</p>
<ul>
<li><p>Controla el número de unidades hacia atrás/adelante con n = (debe ser un entero no negativo)</p></li>
<li><p>Utiliza <code>default =</code> para definir el valor colocado en las filas no existentes (por ejemplo, la primera fila para la que no hay un valor retardado). Por defecto es <code>NA</code>.</p></li>
<li><p>Utiliza <code>order_by = TRUE</code> si tus filas no están ordenadas por su columna de referencia</p></li>
</ul>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts</span> <span class="op">&lt;-</span> <span class="va">counts</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>cases_prev_wk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">cases_wk</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-955df19fbd122202e80e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-955df19fbd122202e80e">{"x":{"filter":"none","vertical":false,"data":[["2019-06-23","2019-06-30","2019-07-07","2019-07-14","2019-07-21","2019-07-28","2019-08-04","2019-08-11","2019-08-18","2019-08-25","2019-09-01","2019-09-08","2019-09-15","2019-09-22","2019-09-29","2019-10-06","2019-10-13","2019-10-20","2019-10-27","2019-11-03","2019-11-10","2019-11-17","2019-11-24","2019-12-01","2019-12-08","2019-12-15","2019-12-22","2019-12-29"],[0,25,59,90,65,79,41,47,31,32,28,28,76,41,70,90,124,278,371,329,177,69,77,97,100,39,19,0],[null,0,25,59,90,65,79,41,47,31,32,28,28,76,41,70,90,124,278,371,329,177,69,77,97,100,39,19]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>week_start<\/th>\n      <th>cases_wk<\/th>\n      <th>cases_prev_wk<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>A continuación, crea una nueva columna que sea la diferencia entre las dos columnas de los casos:</p>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts</span> <span class="op">&lt;-</span> <span class="va">counts</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>cases_prev_wk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">cases_wk</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
         case_diff <span class="op">=</span> <span class="va">cases_wk</span> <span class="op">-</span> <span class="va">cases_prev_wk</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-01e54d12f2136b0752a2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-01e54d12f2136b0752a2">{"x":{"filter":"none","vertical":false,"data":[["2019-06-23","2019-06-30","2019-07-07","2019-07-14","2019-07-21","2019-07-28","2019-08-04","2019-08-11","2019-08-18","2019-08-25","2019-09-01","2019-09-08","2019-09-15","2019-09-22","2019-09-29","2019-10-06","2019-10-13","2019-10-20","2019-10-27","2019-11-03","2019-11-10","2019-11-17","2019-11-24","2019-12-01","2019-12-08","2019-12-15","2019-12-22","2019-12-29"],[0,25,59,90,65,79,41,47,31,32,28,28,76,41,70,90,124,278,371,329,177,69,77,97,100,39,19,0],[null,0,25,59,90,65,79,41,47,31,32,28,28,76,41,70,90,124,278,371,329,177,69,77,97,100,39,19],[null,25,34,31,-25,14,-38,6,-16,1,-4,0,48,-35,29,20,34,154,93,-42,-152,-108,8,20,3,-61,-20,-19]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>week_start<\/th>\n      <th>cases_wk<\/th>\n      <th>cases_prev_wk<\/th>\n      <th>case_diff<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Puedes leer más sobre <code>lead()</code> y <code><a href="https://rdrr.io/r/stats/lag.html">lag()</a></code> en <a href="https://dplyr.tidyverse.org/reference/lead-lag.html">esta documentación aquí</a> o introduciendo <code><a href="https://rdrr.io/r/stats/lag.html">?lag</a></code> en tu consola.</p>
<!-- ======================================================= -->
</div>
<div id="resources-2" class="section level2" number="9.12">
<h2>
<span class="header-section-number">9.12</span> Recursos<a class="anchor" aria-label="anchor" href="#resources-2"><i class="fas fa-link"></i></a>
</h2>
<p>Página de lubridate** <a href="https://lubridate.tidyverse.org/">tidyverse</a></p>
<p>Página de <strong>lubridate</strong> RStudio <a href="https://rawgit.com/rstudio/cheatsheets/master/lubridate.pdf">cheatsheet</a></p>
<p>R for Data Science en español sobre [fechas y horas]<a href="https://es.r4ds.hadley.nz/fechas-y-horas.html" class="uri">https://es.r4ds.hadley.nz/fechas-y-horas.html</a></p>
<p><a href="https://www.statmethods.net/input/dates.html">Tutorial en línea</a></p>
<p><a href="https://www.r-bloggers.com/2013/08/date-formats-in-r/">Formatos de fecha</a>]</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Limpieza de datos y funciones básicas</a></div>
<div class="next"><a href="characters-and-strings.html"><span class="header-section-number">10</span> Caracteres y cadenas</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#working-with-dates"><span class="header-section-number">9</span> Borrador. Trabajando con Fechas</a></li>
<li>
<a class="nav-link" href="#preparation"><span class="header-section-number">9.1</span> Preparación</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cargar-paquetes">Cargar paquetes</a></li>
<li><a class="nav-link" href="#importar-datos">Importar datos</a></li>
</ul>
</li>
<li><a class="nav-link" href="#current-date"><span class="header-section-number">9.2</span> Fecha actual</a></li>
<li>
<a class="nav-link" href="#convert-to-date"><span class="header-section-number">9.3</span> Convertir en fecha</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#r-base">R base</a></li>
<li><a class="nav-link" href="#lubridate">lubridate</a></li>
<li><a class="nav-link" href="#combinar-columnas">Combinar columnas</a></li>
</ul>
</li>
<li><a class="nav-link" href="#excel-dates"><span class="header-section-number">9.4</span> Fechas en Excel</a></li>
<li><a class="nav-link" href="#messy-dates"><span class="header-section-number">9.5</span> Fechas desordenadas</a></li>
<li>
<a class="nav-link" href="#working-with-date-time-class"><span class="header-section-number">9.6</span> Trabajar con el tipo fecha-hora</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#convertir-fechas-con-horas">Convertir fechas con horas</a></li>
<li><a class="nav-link" href="#convertir-s%C3%B3lo-horas">Convertir sólo horas</a></li>
<li><a class="nav-link" href="#extraer-fracciones-de-hora">Extraer fracciones de hora</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#working-with-dates-1"><span class="header-section-number">9.7</span> Trabajar con fechas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#extraer-los-componentes-de-la-fecha">Extraer los componentes de la fecha</a></li>
<li><a class="nav-link" href="#fecha-matem%C3%A1tica">Fecha matemática</a></li>
<li><a class="nav-link" href="#intervalos-de-fechas">Intervalos de fechas</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#date-display"><span class="header-section-number">9.8</span> Visualización de fechas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#format">format()</a></li>
<li><a class="nav-link" href="#mes-a%C3%B1o">Mes-Año</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#dates_epi_wks"><span class="header-section-number">9.9</span> Semanas epidemiológicas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#lubridate-1">lubridate</a></li>
<li><a class="nav-link" href="#recuentos-semanales">Recuentos semanales</a></li>
<li><a class="nav-link" href="#alternativas-a-epiweek">Alternativas a Epiweek</a></li>
</ul>
</li>
<li><a class="nav-link" href="#converting-datestime-zones"><span class="header-section-number">9.10</span> Conversión de fechas/zonas horarias</a></li>
<li><a class="nav-link" href="#lagging-and-leading-calculations"><span class="header-section-number">9.11</span> Cálculos de retardo y de avance</a></li>
<li><a class="nav-link" href="#resources-2"><span class="header-section-number">9.12</span> Recursos</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>El manual de R para Epi’s</strong>" was written by El equipo del manual. It was last built on 2022-10-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
