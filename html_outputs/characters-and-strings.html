<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>10 Caracteres y cadenas | EpiRhandbook en español</title>
<meta name="author" content="El equipo del manual">
<meta name="description" content="Esta página muestra el uso del paquete stringr para evaluar y manejar valores de caracteres, también denominados “cadenas” (“strings”). Combinar, ordenar, dividir, organizar - str_c(), str_glue(),...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="10 Caracteres y cadenas | EpiRhandbook en español">
<meta property="og:type" content="book">
<meta property="og:description" content="Esta página muestra el uso del paquete stringr para evaluar y manejar valores de caracteres, también denominados “cadenas” (“strings”). Combinar, ordenar, dividir, organizar - str_c(), str_glue(),...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="10 Caracteres y cadenas | EpiRhandbook en español">
<meta name="twitter:description" content="Esta página muestra el uso del paquete stringr para evaluar y manejar valores de caracteres, también denominados “cadenas” (“strings”). Combinar, ordenar, dividir, organizar - str_c(), str_glue(),...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.24/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.9/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-2.5.1/plotly-basic-2.5.1.min.js"></script><script src="libs/plotly-cartesian-2.5.1/plotly-cartesian-2.5.1.min.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-9.3.1/highcharts.js"></script><script src="libs/highcharts-9.3.1/highcharts-3d.js"></script><script src="libs/highcharts-9.3.1/highcharts-more.js"></script><script src="libs/highcharts-9.3.1/modules/stock.js"></script><script src="libs/highcharts-9.3.1/modules/map.js"></script><script src="libs/highcharts-9.3.1/modules/data.js"></script><script src="libs/highcharts-9.3.1/modules/exporting.js"></script><script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script><script src="libs/highcharts-9.3.1/modules/drilldown.js"></script><script src="libs/highcharts-9.3.1/modules/item-series.js"></script><script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-9.3.1/modules/annotations.js"></script><script src="libs/highcharts-9.3.1/modules/export-data.js"></script><script src="libs/highcharts-9.3.1/modules/funnel.js"></script><script src="libs/highcharts-9.3.1/modules/heatmap.js"></script><script src="libs/highcharts-9.3.1/modules/treemap.js"></script><script src="libs/highcharts-9.3.1/modules/sankey.js"></script><script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script><script src="libs/highcharts-9.3.1/modules/organization.js"></script><script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script><script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script><script src="libs/highcharts-9.3.1/modules/sunburst.js"></script><script src="libs/highcharts-9.3.1/modules/vector.js"></script><script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script><script src="libs/highcharts-9.3.1/modules/xrange.js"></script><script src="libs/highcharts-9.3.1/modules/tilemap.js"></script><script src="libs/highcharts-9.3.1/modules/venn.js"></script><script src="libs/highcharts-9.3.1/modules/gantt.js"></script><script src="libs/highcharts-9.3.1/modules/timeline.js"></script><script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script><script src="libs/highcharts-9.3.1/modules/bullet.js"></script><script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script><script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script><script src="libs/highcharts-9.3.1/modules/lollipop.js"></script><script src="libs/highcharts-9.3.1/modules/series-label.js"></script><script src="libs/highcharts-9.3.1/plugins/motion.js"></script><script src="libs/highcharts-9.3.1/custom/reset.js"></script><script src="libs/highcharts-9.3.1/modules/boost.js"></script><script src="libs/highchart-binding-0.9.4/highchart.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QXDW878QLX"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QXDW878QLX');
    </script>
</head>
<body>
<div class="alert alert-info alert-dismissible">
      <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
      <strong>¿Necesita ayuda para aprender R?</strong> Inscríbase en Applied Epi's <a href="https://www.appliedepi.org/live/" class="alert-link">curso de introducción a R</a>, pruebe nuestro <a href="https://www.appliedepi.org/tutorial/" class="alert-link">tutoriales gratuitos de R</a>, hacer un post en nuestro <a href="https://community.appliedepi.org/" class="alert-link">Foro comunitario de preguntas y respuestas</a>, o pregunte por nuestro <a href="mailto:contact@appliedepi.org" class="alert-link">R Servicio de asistencia técnica</a>.
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style_bs4.css">
<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EpiRhandbook en español</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Acerca de este libro</li>
<li><a class="" href="editorial-and-technical-notes.html"><span class="header-section-number">1</span> Notas editoriales y técnicas</a></li>
<li><a class="" href="download-handbook-and-data.html"><span class="header-section-number">2</span> Descargando el manual y los datos</a></li>
<li class="book-part">Aspectos básicos</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> Fundamentos de R</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transición a R</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">5</span> Paquetes recomendados</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> Proyectos en R</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">7</span> Importación y exportación</a></li>
<li class="book-part">Gestión de datos</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Limpieza de datos y funciones básicas</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Trabajando con Fechas</a></li>
<li><a class="active" href="characters-and-strings.html"><span class="header-section-number">10</span> Caracteres y cadenas</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">11</span> Factores</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">12</span> Pivotar datos</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">13</span> Agrupar datos</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">14</span> Unir datos</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplicación</a></li>
<li><a class="" href="iteration-loops-and-lists.html"><span class="header-section-number">16</span> Iteración, bucles y listas</a></li>
<li class="book-part">Análisis</li>
<li><a class="" href="descriptive-tables.html"><span class="header-section-number">17</span> Tablas descriptivas</a></li>
<li><a class="" href="simple-statistical-tests.html"><span class="header-section-number">18</span> Tests estadísticos sencillos</a></li>
<li><a class="" href="univariate-and-multivariable-regression.html"><span class="header-section-number">19</span> Regresión univariante y multivariable</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Valores faltantes</a></li>
<li><a class="" href="standardised-rates.html"><span class="header-section-number">21</span> Tasas estandarizadas</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">22</span> Medias Móviles</a></li>
<li><a class="" href="time-series-and-outbreak-detection.html"><span class="header-section-number">23</span> Series temporales y detección de brotes</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">24</span> Modelización de epidemias</a></li>
<li><a class="" href="contact-tracing-1.html"><span class="header-section-number">25</span> Rastreo de contactos</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">26</span> Análisis de encuestas</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">27</span> Análisis de supervivencia</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">28</span> Conceptos básicos de los SIG</a></li>
<li class="book-part">Visualización de datos</li>
<li><a class="" href="tables-for-presentation.html"><span class="header-section-number">29</span> Tablas para presentaciones</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">30</span> Conceptos básicos de ggplot</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">31</span> Consejos de ggplot</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">32</span> Curvas epidémicas</a></li>
<li><a class="" href="demographic-pyramids-and-likert-scales.html"><span class="header-section-number">33</span> Pirámides de población y escalas de Likert</a></li>
<li><a class="" href="heat-plots.html"><span class="header-section-number">34</span> Gráficos de calor</a></li>
<li><a class="" href="diagrams-and-charts.html"><span class="header-section-number">35</span> Diagramas y gráficos</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">36</span> Análisis de combinaciones</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">37</span> Cadenas de transmisión</a></li>
<li><a class="" href="phylogenetic-trees-1.html"><span class="header-section-number">38</span> Árboles filogenéticos</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">39</span> Gráficos interactivos</a></li>
<li class="book-part">Informes y Dashboards</li>
<li><a class="" href="reports-with-r-markdown.html"><span class="header-section-number">40</span> Informes con R Markdown</a></li>
<li><a class="" href="organizing-routine-reports.html"><span class="header-section-number">41</span> Organización de informes rutinarios</a></li>
<li><a class="" href="dashboards-with-r-markdown.html"><span class="header-section-number">42</span> Dashboards con R Markdown</a></li>
<li><a class="" href="dashboards-with-shiny.html"><span class="header-section-number">43</span> Dashboards con Shiny</a></li>
<li class="book-part">Miscelánea</li>
<li><a class="" href="writing-functions-1.html"><span class="header-section-number">44</span> Escribir funciones</a></li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">45</span> Interacciones con directorios</a></li>
<li><a class="" href="version-control-and-collaboration-with-git-and-github.html"><span class="header-section-number">46</span> Control de versiones y colaboración con Git y Github</a></li>
<li><a class="" href="common-errors.html"><span class="header-section-number">47</span> Errores comunes</a></li>
<li><a class="" href="getting-help.html"><span class="header-section-number">48</span> Cómo obtener ayuda</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">49</span> R en redes locales</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">50</span> Data Table</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="characters-and-strings" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Caracteres y cadenas<a class="anchor" aria-label="anchor" href="#characters-and-strings"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/Characters_Strings_1500x500.png" width="100%"></div>
<p>Esta página muestra el uso del paquete <strong>stringr</strong> para evaluar y manejar valores de caracteres, también denominados “cadenas” (“strings”).</p>
<ol style="list-style-type: decimal">
<li><p>Combinar, ordenar, dividir, organizar - <code>str_c()</code>, <code>str_glue()</code>, <code>str_order()</code>, <code>str_split()</code><br></p></li>
<li>
<p>Limpiar y normalizar</p>
<ul>
<li>Ajustar la longitud - <code>str_pad()</code>, <code>str_trunc()</code>, <code>str_wrap()</code><br>
</li>
<li>Cambiar mayúsculas y minúsculas - <code>str_to_upper()</code>, <code>str_to_title()</code>, <code>str_to_lower()</code>, <code>str_to_sentence()</code><br>
</li>
</ul>
</li>
<li><p>Evaluar y extraer por posición - <code>str_length()</code>, <code>str_sub()</code>, <code>word()</code><br></p></li>
<li>
<p>Patrones</p>
<ul>
<li>Detectar y localizar - <code>str_detect()</code>, <code>str_subset()</code>, <code>str_match()</code>, <code>str_extract()</code><br>
</li>
<li>Modificar y reemplazar - <code>str_sub()</code>, <code>str_replace_all()</code><br>
</li>
</ul>
</li>
<li><p>Expresiones regulares (“regex”)</p></li>
</ol>
<p>Para facilitar la visualización, la mayoría de los ejemplos se muestran actuando sobre un vector de caracteres definido brevemente, aunque pueden adaptarse fácilmente a una columna dentro de un dataframe.</p>
<p>Esta <a href="https://cran.r-project.org/web/packages/stringr/vignettes/stringr.html">viñeta de stringr</a> proporcionó gran parte de la inspiración para esta página.</p>
<!-- ======================================================= -->
<div id="preparation-1" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Preparación<a class="anchor" aria-label="anchor" href="#preparation-1"><i class="fas fa-link"></i></a>
</h2>
<div id="cargar-paquetes-1" class="section level3 unnumbered">
<h3>Cargar paquetes<a class="anchor" aria-label="anchor" href="#cargar-paquetes-1"><i class="fas fa-link"></i></a>
</h3>
<p>Instala o carga el paquete <strong>stringr</strong> y otros paquetes de <strong>tidyverse</strong>.</p>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install/load packages</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span></span>
<span>  <span class="va">stringr</span>,    <span class="co"># many functions for handling strings</span></span>
<span>  <span class="va">tidyverse</span>,  <span class="co"># for optional data manipulation</span></span>
<span>  <span class="va">tools</span><span class="op">)</span>      <span class="co"># alternative for converting to title case</span></span></code></pre></div>
</div>
<div id="importar-datos-1" class="section level3 unnumbered">
<h3>Importar datos<a class="anchor" aria-label="anchor" href="#importar-datos-1"><i class="fas fa-link"></i></a>
</h3>
<p>Importar datos</p>
<p>En esta página haremos referencia de vez en cuando a la lista limpia de casos de una epidemia de ébola simulada. Si quieres seguir el proceso, <a href="https://github.com/epirhandbook/Epi_R_handbook/raw/master/data/case_linelists/linelist_cleaned.rds">clica para descargar linelist “limpio”</a> (como archivo .rds). Importa los datos con la función <code>import()</code> del paquete <strong>rio</strong> (maneja muchos tipos de archivos como .xlsx, .csv, .rds - consulta la página de <a href="import-and-export.html#import-and-export">importación y exportación</a> para más detalles).</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import case linelist </span></span>
<span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="st">"linelist_cleaned.rds"</span><span class="op">)</span></span></code></pre></div>
<p>A continuación se muestran las primeras 50 filas del listado.</p>
<div id="htmlwidget-b92a8feb22671943c4c8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b92a8feb22671943c4c8">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1399075200000\" data-max=\"1406419200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1399939200000\" data-max=\"1407024000000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1400025600000\" data-max=\"1407110400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1400371200000\" data-max=\"1410566400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"67\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"67\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-29&quot;,&quot;30-49&quot;,&quot;50-69&quot;,&quot;70+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-24&quot;,&quot;25-29&quot;,&quot;30-34&quot;,&quot;35-39&quot;,&quot;40-44&quot;,&quot;45-49&quot;,&quot;50-54&quot;,&quot;55-59&quot;,&quot;60-64&quot;,&quot;65-69&quot;,&quot;70-74&quot;,&quot;75-79&quot;,&quot;80-84&quot;,&quot;85+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-13.2697246824573\" data-max=\"-13.209391925612\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"8.45171855856465\" data-max=\"8.48802917129884\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"100\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"11\" data-max=\"241\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"20\" data-max=\"24\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35.9\" data-max=\"38\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"428.994082840237\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca","2978ac","57a565","fc15ef","2eaa9a","bbfa93","c97dd9","f50e8a","3a7673","7f5a01","ddddee","99e8fa","567136","9371a9","bc2adf","403057","8bd1e8","f327be","42e1a9","90e5fe","959170","8ebf6e","e56412","6d788e","a47529","67be4e","da8ecb","148f18","2cb9a5","f5c142","70a9fe","3ad520","062638","c76676","baacc1","497372","23e499","38cc4a","3789ee","c71dcd","6b70f0"],[4,4,2,3,3,3,4,4,4,4,4,4,6,5,6,9,10,8,7,6,7,6,8,6,10,8,6,12,5,8,7,9,11,5,8,5,6,11,7,9,7,8,9,12,13,9,8,10,8,7],["2014-05-08",null,null,"2014-05-04","2014-05-18","2014-05-03","2014-05-22","2014-05-28",null,null,"2014-05-30","2014-05-28","2014-06-14","2014-06-07","2014-06-09",null,null,null,"2014-06-23","2014-06-18","2014-06-24",null,null,"2014-07-03",null,"2014-07-10","2014-06-14",null,"2014-06-18","2014-06-29","2014-07-02","2014-07-12","2014-07-12","2014-06-13","2014-07-15","2014-06-20",null,null,"2014-07-20",null,"2014-07-12","2014-07-19","2014-07-18","2014-07-18","2014-07-27",null,"2014-07-19","2014-07-26","2014-07-24",null],["2014-05-13","2014-05-13","2014-05-16","2014-05-18","2014-05-21","2014-05-22","2014-05-27","2014-06-02","2014-06-05","2014-06-05","2014-06-06","2014-06-13","2014-06-16","2014-06-17","2014-06-18","2014-06-19","2014-06-22","2014-06-23","2014-06-25","2014-06-26","2014-06-28","2014-07-02","2014-07-08","2014-07-09","2014-07-09","2014-07-10","2014-07-12","2014-07-12","2014-07-13","2014-07-13","2014-07-14","2014-07-15","2014-07-16","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-22","2014-07-22","2014-07-24","2014-07-24","2014-07-25","2014-07-25","2014-07-27","2014-07-29","2014-07-30",null,"2014-08-01","2014-08-02","2014-08-03"],["2014-05-15","2014-05-14","2014-05-18","2014-05-20","2014-05-22","2014-05-23","2014-05-29","2014-06-03","2014-06-06","2014-06-07","2014-06-08","2014-06-15","2014-06-17","2014-06-17","2014-06-20","2014-06-19","2014-06-23","2014-06-24","2014-06-27","2014-06-28","2014-06-29","2014-07-03","2014-07-09","2014-07-09","2014-07-11","2014-07-11","2014-07-13","2014-07-14","2014-07-14","2014-07-13","2014-07-14","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-20","2014-07-20","2014-07-22","2014-07-24","2014-07-26","2014-07-24","2014-07-27","2014-07-25","2014-07-27","2014-07-31","2014-08-01","2014-08-03","2014-08-02","2014-08-02","2014-08-04"],[null,"2014-05-18","2014-05-30",null,"2014-05-29","2014-05-24","2014-06-01","2014-06-07","2014-06-18","2014-06-09","2014-06-15",null,"2014-07-09",null,"2014-06-30","2014-07-11","2014-07-01","2014-06-25","2014-07-06","2014-07-02","2014-07-09","2014-07-07","2014-07-20",null,"2014-07-22","2014-07-16","2014-07-14","2014-07-20","2014-07-16","2014-07-19","2014-07-27","2014-07-19",null,"2014-07-26","2014-08-14","2014-08-01","2014-07-23","2014-08-28","2014-07-28","2014-07-19",null,"2014-08-03",null,null,null,"2014-08-06","2014-08-21","2014-09-13","2014-08-04",null],[null,"Recover","Recover",null,"Recover","Recover","Recover","Death","Recover","Death","Death","Death","Recover","Recover",null,"Recover",null,null,"Death","Death","Recover",null,null,null,"Death",null,"Death","Death",null,"Death","Recover","Death","Recover","Death","Recover",null,"Death","Recover","Recover","Death",null,null,"Death","Death","Death","Death","Recover",null,"Death","Death"],["m","f","m","f","m","f","f","f","m","f","m","m","m","f","f","m","f","f","f","f","m","m","f","m","f","m","m","f","m","f","f","f","m","m","f","m","f","f","f","m","f","m","f","m","m","f","m","f","m","m"],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14],["years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years"],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14],["0-4","0-4","50-69","15-19","0-4","15-19","15-19","0-4","50-69","20-29","10-14","30-49","15-19","5-9","5-9","10-14","30-49","15-19","10-14","10-14","15-19","50-69","10-14","20-29","5-9","0-4","30-49","5-9","50-69","10-14","10-14","20-29","20-29","30-49","0-4","10-14","0-4","15-19","20-29","30-49","5-9","10-14","10-14","0-4","10-14","0-4","0-4","20-29","20-29","10-14"],["0-4","0-4","55-59","15-19","0-4","15-19","15-19","0-4","60-64","25-29","10-14","40-44","15-19","5-9","5-9","10-14","35-39","15-19","10-14","10-14","15-19","50-54","10-14","25-29","5-9","0-4","30-34","5-9","65-69","10-14","10-14","20-24","20-24","45-49","0-4","10-14","0-4","15-19","20-24","35-39","5-9","10-14","10-14","0-4","10-14","0-4","0-4","20-24","25-29","10-14"],["Other","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital","Military Hospital","Port Hospital","Missing","Missing","Missing","Missing","Port Hospital","Military Hospital","Missing","Missing","Other","Port Hospital","Port Hospital","Port Hospital","Missing","Other","Port Hospital","Port Hospital","St. Mark's Maternity Hospital (SMMH)","Missing","Other","Missing","St. Mark's Maternity Hospital (SMMH)","Military Hospital","Port Hospital","Central Hospital","Military Hospital","Central Hospital","Missing","Military Hospital","Other","Missing","Missing","Port Hospital","Port Hospital","Port Hospital","Missing","Central Hospital","Military Hospital","Other","Other","Other","Missing","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","Missing"],[-13.2157351064963,-13.2152339775486,-13.212910703914,-13.2363711169728,-13.2228638912441,-13.222625321098,-13.2331547837254,-13.2320975453153,-13.2225511595637,-13.2572163655863,-13.2206286746001,-13.253989309478,-13.2385127873491,-13.209391925612,-13.2157278814899,-13.2243437095992,-13.2336087079551,-13.21422143145,-13.2339681355349,-13.2535640411465,-13.2250089377786,-13.2160657166043,-13.2680671272333,-13.2266742923612,-13.2160179088168,-13.2482584611565,-13.2156319199566,-13.2142410663192,-13.2614879104088,-13.2452992638476,-13.2630592726116,-13.2343341712241,-13.2199077448676,-13.2227293309912,-13.2343062806506,-13.218781651651,-13.2483677722899,-13.2097478342339,-13.2680867723786,-13.2587535457526,-13.262635786914,-13.2697246824573,-13.2209026809759,-13.2330734719715,-13.2680923666905,-13.2547212675054,-13.2573683214693,-13.2137356012883,-13.2175973322257,-13.2486407324245],[8.46897295100924,8.45171855856465,8.46481700596819,8.4754761613651,8.46082377490923,8.46183062600728,8.46272931462646,8.46144367534271,8.46191259217774,8.47292327643506,8.48401630165138,8.45837125340844,8.47761705512509,8.47570184950483,8.47779946878972,8.47145134147474,8.47804840685363,8.48528034195779,8.46957530395867,8.45957352078114,8.47404889511544,8.48802917129884,8.473437335922,8.48408263734462,8.46242233645879,8.47026822126572,8.46398447480533,8.4641347894342,8.45623094629607,8.48334624336805,8.47493999153642,8.47832062438022,8.4693933891765,8.48480589906514,8.47121232619015,8.48438437371817,8.48466158574339,8.47714159984428,8.46238127010609,8.45568597813113,8.4632880274758,8.47940722413856,8.46353857052336,8.46178968158864,8.47508713872833,8.45825808128071,8.4532568143863,8.4732571907655,8.47911586641933,8.48480340615605],["f547d6",null,null,"f90f5f","11f8ea","aec8ec","893f25","133ee7",null,null,"996f3a","133ee7","37a6f6","9f6884","4802b1",null,null,null,"a75c7f","8e104d","ab634e",null,null,"b799eb",null,"5d9e4d","a15e13",null,"ea3740","beb26e","567136","894024","36e2e7","a2086d","7baf73","eb2277",null,null,"d6584f",null,"312ecf","52ea64","cfd79c","d145b7","174288",null,"53608c","3b096b","f5c142",null],["other",null,null,"other","other","other","other","other",null,null,"other","other","other","other","other",null,null,null,"other","other","other",null,null,"other",null,"other","other",null,"other","funeral","other","funeral","other","other","other","funeral",null,null,"other",null,"other","other","other","other","other",null,"funeral","other","other",null],[27,25,91,41,36,56,47,0,86,69,67,84,68,44,34,66,78,47,53,47,71,86,53,69,38,46,68,37,100,56,50,57,65,72,29,69,37,48,54,71,47,61,47,35,53,16,13,59,69,67],[48,59,238,135,71,116,87,11,226,174,112,186,174,90,91,152,214,137,117,131,150,241,131,161,80,69,188,66,233,142,110,182,164,214,26,157,39,154,133,168,100,125,123,67,134,31,36,125,183,169],[22,22,21,23,23,21,21,22,22,22,22,22,22,21,23,22,23,21,22,23,21,23,21,24,23,22,24,23,20,24,24,20,24,21,22,21,23,22,23,23,23,22,23,22,22,22,23,22,22,22],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","no","no","no","no","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","yes","no",null,"no","no","no","yes","no",null,"no","no","yes",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","yes","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes",null,"yes","yes","yes","yes","yes",null,"yes","yes","yes",null,null,"yes","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","yes","yes","yes","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","yes","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"yes","yes",null,"no","no",null,"no","no","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","no","yes","no","no","no","yes","no","no","no",null,"no","yes","no","no","no",null,"no","no","no",null,null,"no","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","no","yes","yes","yes",null],[36.8,36.9,36.9,36.8,36.9,37.6,37.3,37,36.4,35.9,36.5,36.9,36.5,37.1,36.5,37.3,37,38,38,36,37,36.7,36.9,36.5,37,36.5,37.6,36.6,36.6,36.2,36.4,37.1,37.5,37.5,37.4,36.9,36.4,37.3,37,37.8,36.5,37.5,36.7,37,37.3,36.6,36.5,36.6,37.6,36.8],[null,"09:36","16:48","11:22","12:60","14:13","14:33","09:25","11:16","10:55","16:03","11:14","12:42","11:06","09:10","08:45",null,"15:41","13:34","18:58","12:43","16:33","14:29","07:18","08:11","16:32","16:17","07:32","17:45",null,"13:24","14:43","02:33","11:36","17:28","16:27",null,"20:49",null,"11:38","14:25","13:42","21:22","13:33","19:06","17:14","20:09",null,"10:23","09:09"],[117.1875,71.8184429761563,16.0652496292635,22.4965706447188,71.4144019043841,41.6171224732461,62.0953890870657,0,16.8376536925366,22.7903289734443,53.4119897959184,24.2802636142907,22.4600343506408,54.320987654321,41.0578432556455,28.5664819944598,17.0320552013276,25.0412914912888,38.7172182043977,27.3876813705495,31.5555555555556,14.8069075945662,30.8839811199813,26.6193433895297,59.375,96.6183574879227,19.2394748755093,84.9403122130395,18.4199377406104,27.7722674072605,41.3223140495868,17.2080666586161,24.1671624033314,15.7218971089178,428.994082840237,27.9930220292912,243.261012491782,20.2395007589813,30.527446435638,25.15589569161,47,39.04,31.0661643201798,77.9683671196257,29.5165961238583,166.493236212279,100.308641975309,37.76,20.6037803457852,23.458562375267],[2,1,2,2,1,1,2,1,1,2,2,2,1,0,2,0,1,1,2,2,1,1,1,0,2,1,1,2,1,0,0,2,1,1,2,2,1,0,2,2,0,2,0,0,2,2,null,1,0,1]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,8,10,14,15,18,19,20,26,28,29]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
</div>
<div id="unite-split-and-arrange" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Unir, dividir y ordenar<a class="anchor" aria-label="anchor" href="#unite-split-and-arrange"><i class="fas fa-link"></i></a>
</h2>
<p>Esta sección abarca:</p>
<ul>
<li><p>Uso de <code>str_c()</code>, <code>str_glue()</code>, y <code>unite()</code> para combinar cadenas</p></li>
<li><p>Uso de <code>str_order()</code> para ordenar las cadenas</p></li>
<li><p>Uso de <code>str_split()</code> y <code>separate()</code> para dividir cadenas</p></li>
</ul>
<!-- ======================================================= --><div id="combinar-cadenas" class="section level3 unnumbered">
<h3>Combinar cadenas<a class="anchor" aria-label="anchor" href="#combinar-cadenas"><i class="fas fa-link"></i></a>
</h3>
<p>Para combinar o concatenar varias cadenas en una sola, sugerimos utilizar <code>str_c</code> de <strong>stringr</strong>. Si tienes valores de caracteres distintos para combinar, simplemente proporciónalos como argumentos únicos, separados por comas.</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_c</span><span class="op">(</span><span class="st">"String1"</span>, <span class="st">"String2"</span>, <span class="st">"String3"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "String1String2String3"</code></pre>
<p>El argumento <code>sep =</code> inserta un valor de carácter entre cada uno de los argumentos proporcionados (por ejemplo, insertando una coma, un espacio o una nueva línea <code>"\n"</code>)</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_c</span><span class="op">(</span><span class="st">"String1"</span>, <span class="st">"String2"</span>, <span class="st">"String3"</span>, sep <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "String1, String2, String3"</code></pre>
<p>El argumento <code>collapse =</code> es relevante si estás introduciendo múltiples <em>vectores</em> como argumentos a <code>str_c()</code>. Se utiliza para separar los elementos de lo que sería un vector de salida, de forma que el vector de salida sólo tenga un elemento de carácter largo.</p>
<p>El ejemplo siguiente muestra la combinación de dos vectores en uno (nombres y apellidos). Otro ejemplo similar podría ser el de las jurisdicciones y su número de casos. En este ejemplo:</p>
<ul>
<li><p>El valor <code>sep =</code> aparece entre cada nombre y apellido</p></li>
<li><p>El valor de <code>collapse =</code> aparece entre cada persona</p></li>
</ul>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"abdul"</span>, <span class="st">"fahruk"</span>, <span class="st">"janice"</span><span class="op">)</span> </span>
<span><span class="va">last_names</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hussein"</span>, <span class="st">"akinleye"</span>, <span class="st">"okeke"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sep displays between the respective input strings, while collapse displays between the elements produced</span></span>
<span><span class="fu">str_c</span><span class="op">(</span><span class="va">first_names</span>, <span class="va">last_names</span>, sep <span class="op">=</span> <span class="st">" "</span>, collapse <span class="op">=</span> <span class="st">";  "</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "abdul hussein;  fahruk akinleye;  janice okeke"</code></pre>
<p>Nota: Dependiendo del contexto de visualización deseado, al imprimir una cadena combinada de este tipo con nuevas líneas, puede ser necesario envolver toda la frase en <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> para que las nuevas líneas se impriman correctamente:</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For newlines to print correctly, the phrase may need to be wrapped in cat()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu">str_c</span><span class="op">(</span><span class="va">first_names</span>, <span class="va">last_names</span>, sep <span class="op">=</span> <span class="st">" "</span>, collapse <span class="op">=</span> <span class="st">";\n"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## abdul hussein;
## fahruk akinleye;
## janice okeke</code></pre>
<!-- ======================================================= -->
</div>
<div id="cadenas-dinámicas" class="section level3 unnumbered">
<h3>Cadenas dinámicas<a class="anchor" aria-label="anchor" href="#cadenas-din%C3%A1micas"><i class="fas fa-link"></i></a>
</h3>
<p>Utiliza <code>str_glue()</code> para insertar código R dinámico en una cadena. Se trata de una función muy útil para crear títulos o pies de gráfico dinámicos, como se muestra a continuación.</p>
<ul>
<li><p>Todo el contenido va entre comillas dobles <code>str_glue("")</code></p></li>
<li><p>Cualquier código dinámico o referencias a valores predefinidos se colocan entre llaves <code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code> dentro de las comillas dobles. Puede haber muchas llaves en el mismo comando <code>str_glue()</code>.</p></li>
<li><p>Para usar las comillas de caracteres ’’ dentro de la función, utiliza comillas <em>simples</em> dentro de las comillas dobles que las rodean (por ejemplo, al proporcionar el formato de la fecha - véase el ejemplo siguiente)</p></li>
<li><p>Consejo: Puedes utilizar <code>\n</code> para forzar una nueva línea</p></li>
<li><p>Consejo: Utiliza <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> para ajustar la visualización de la fecha, y utiliza <code><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date()</a></code> para mostrar la fecha actual</p></li>
</ul>
<p>Un ejemplo sencillo, de un título de gráfico dinámico:</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_glue</span><span class="op">(</span><span class="st">"Data include {nrow(linelist)} cases and are current to {format(Sys.Date(), '%d %b %Y')}."</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Data include 5888 cases and are current to 22 Nov 2022.</code></pre>
<p>Un formato alternativo es utilizar marcadores de posición dentro de los paréntesis y definir el código en argumentos separados al final de la función <code>str_glue()</code>, como se indica a continuación. Esto puede mejorar la legibilidad del código si el texto es largo.</p>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_glue</span><span class="op">(</span><span class="st">"Linelist as of {current_date}.\nLast case hospitalized on {last_hospital}.\n{n_missing_onset} cases are missing date of onset and not shown"</span>,</span>
<span>         current_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'%d %b %Y'</span><span class="op">)</span>,</span>
<span>         last_hospital <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_hospitalisation</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>, <span class="st">'%d %b %Y'</span><span class="op">)</span>,</span>
<span>         n_missing_onset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span></code></pre></div>
<pre><code>## Linelist as of 22 Nov 2022.
## Last case hospitalized on 30 Apr 2015.
## 256 cases are missing date of onset and not shown</code></pre>
<p><strong>Extraer de un dataframe</strong></p>
<p>A veces, es útil extraer datos de un dataframe y pegarlos secuencialmente. A continuación se muestra un ejemplo de dataframe. Lo utilizaremos para hacer una declaración resumida sobre las jurisdicciones y los recuentos de casos nuevos y totales.</p>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make case data frame</span></span>
<span><span class="va">case_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  zone        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Zone 1"</span>, <span class="st">"Zone 2"</span>, <span class="st">"Zone 3"</span>, <span class="st">"Zone 4"</span>, <span class="st">"Zone 5"</span><span class="op">)</span>,</span>
<span>  new_cases   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">7</span>, <span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>  total_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">4</span>, <span class="fl">25</span>, <span class="fl">10</span>, <span class="fl">103</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-1cd2c956adcf8c462d61" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1cd2c956adcf8c462d61">{"x":{"filter":"none","vertical":false,"data":[["Zone 1","Zone 2","Zone 3","Zone 4","Zone 5"],[3,0,7,0,15],[40,4,25,10,103]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>zone<\/th>\n      <th>new_cases<\/th>\n      <th>total_cases<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Utiliza <code>str_glue_data()</code>, que está hecho especialmente para obtener datos de las filas del dataframe:</p>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">case_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">str_glue_data</span><span class="op">(</span><span class="st">"{zone}: {new_cases} ({total_cases} total cases)"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Zone 1: 3 (40 total cases)
## Zone 2: 0 (4 total cases)
## Zone 3: 7 (25 total cases)
## Zone 4: 0 (10 total cases)
## Zone 5: 15 (103 total cases)</code></pre>
<p><strong>Combinar cadenas a través de las filas</strong></p>
<p>Si estás intentando “enrollar” valores en una columna del dataframe, por ejemplo, combinar valores de varias filas en una sola fila pegándolos con un separador, consulta la sección <a href="de-duplication.html#str_rollup">“combinación de valores”</a> de la página de <strong>De-duplicación</strong>.</p>
<p><strong>Dataframe a una línea</strong></p>
<p>Puedes hacer que la declaración aparezca en una línea utilizando <code>str_c()</code> (especificando el dataframe y los nombres de las columnas), y proporcionando los argumentos <code>sep =</code> y <code>collapse =</code>.</p>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_c</span><span class="op">(</span><span class="va">case_table</span><span class="op">$</span><span class="va">zone</span>, <span class="va">case_table</span><span class="op">$</span><span class="va">new_cases</span>, sep <span class="op">=</span> <span class="st">" = "</span>, collapse <span class="op">=</span> <span class="st">";  "</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Zone 1 = 3;  Zone 2 = 0;  Zone 3 = 7;  Zone 4 = 0;  Zone 5 = 15"</code></pre>
<p>Podría añadir el texto “Nuevos casos:” fijado al principio de la frase envolviéndolo con un <code>str_c()</code> separado (si “Nuevos casos:” estuviera dentro del <code>str_c()</code> original aparecería varias veces).</p>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_c</span><span class="op">(</span><span class="st">"New Cases: "</span>, <span class="fu">str_c</span><span class="op">(</span><span class="va">case_table</span><span class="op">$</span><span class="va">zone</span>, <span class="va">case_table</span><span class="op">$</span><span class="va">new_cases</span>, sep <span class="op">=</span> <span class="st">" = "</span>, collapse <span class="op">=</span> <span class="st">";  "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "New Cases: Zone 1 = 3;  Zone 2 = 0;  Zone 3 = 7;  Zone 4 = 0;  Zone 5 = 15"</code></pre>
</div>
<div id="str_unite" class="section level3 unnumbered">
<h3>Unir columnas<a class="anchor" aria-label="anchor" href="#str_unite"><i class="fas fa-link"></i></a>
</h3>
<p>Dentro de un dataframe, la unión de valores de caracteres de varias columnas puede lograrse con <code>unite()</code> de <strong>tidyr</strong>. Esto es lo contrario de <code>separate()</code>.</p>
<p>Indica el nombre de la nueva columna (que contendrá los valores unidos) y, a continuación, indica los nombres de las columnas que deseas unir.</p>
<ul>
<li><p>Por defecto, el separador utilizado en la columna unida es el guión bajo <code>_</code>, pero puede cambiarse con el argumento <code>sep =</code>.</p></li>
<li><p><code>remove =</code> elimina las columnas del dataframe que queremos unir (TRUE por defecto)</p></li>
<li><p><code>na.rm =</code> elimina los valores perdidos (NA) al realizar la unión (FALSE por defecto)</p></li>
</ul>
<p>A continuación, definimos un mini-dataframe con el que hacer una demostración:</p>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  case_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>  symptoms  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"jaundice, fever, chills"</span>,     <span class="co"># patient 1</span></span>
<span>                <span class="st">"chills, aches, pains"</span>,        <span class="co"># patient 2 </span></span>
<span>                <span class="st">"fever"</span>,                       <span class="co"># patient 3</span></span>
<span>                <span class="st">"vomiting, diarrhoea"</span>,         <span class="co"># patient 4</span></span>
<span>                <span class="st">"bleeding from gums, fever"</span>,   <span class="co"># patient 5</span></span>
<span>                <span class="st">"rapid pulse, headache"</span><span class="op">)</span>,      <span class="co"># patient 6</span></span>
<span>  outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Recover"</span>, <span class="st">"Death"</span>, <span class="st">"Death"</span>, <span class="st">"Recover"</span>, <span class="st">"Recover"</span>, <span class="st">"Recover"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_split</span> <span class="op">&lt;-</span> <span class="fu">separate</span><span class="op">(</span><span class="va">df</span>, <span class="va">symptoms</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sym_1"</span>, <span class="st">"sym_2"</span>, <span class="st">"sym_3"</span><span class="op">)</span>, extra <span class="op">=</span> <span class="st">"merge"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Expected 3 pieces. Missing pieces filled with `NA` in 2 rows [3, 4].</code></pre>
<p>Este es el dataframe de ejemplo:</p>
<div id="htmlwidget-9cb32c91a5231076864f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9cb32c91a5231076864f">{"x":{"filter":"none","vertical":false,"data":[[1,2,3,4,5,6],["jaundice","chills","fever","vomiting","bleeding","rapid"],["fever","aches",null,"diarrhoea","from","pulse"],["chills","pains",null,null,"gums, fever","headache"],["Recover","Death","Death","Recover","Recover","Recover"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_ID<\/th>\n      <th>sym_1<\/th>\n      <th>sym_2<\/th>\n      <th>sym_3<\/th>\n      <th>outcome<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>A continuación, unimos las tres columnas de síntomas:</p>
<div class="sourceCode" id="cb331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_split</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">unite</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">"all_symptoms"</span>,         <span class="co"># name of the new united column</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sym_1"</span>, <span class="st">"sym_2"</span>, <span class="st">"sym_3"</span><span class="op">)</span>, <span class="co"># columns to unite</span></span>
<span>    sep <span class="op">=</span> <span class="st">", "</span>,                   <span class="co"># separator to use in united column</span></span>
<span>    remove <span class="op">=</span> <span class="cn">TRUE</span>,                <span class="co"># if TRUE, removes input cols from the data frame</span></span>
<span>    na.rm <span class="op">=</span> <span class="cn">TRUE</span>                  <span class="co"># if TRUE, missing values are removed before uniting</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>##   case_ID                all_symptoms outcome
## 1       1     jaundice, fever, chills Recover
## 2       2        chills, aches, pains   Death
## 3       3                       fever   Death
## 4       4         vomiting, diarrhoea Recover
## 5       5 bleeding, from, gums, fever Recover
## 6       6      rapid, pulse, headache Recover</code></pre>
<!-- ======================================================= -->
</div>
<div id="dividir" class="section level3 unnumbered">
<h3>Dividir<a class="anchor" aria-label="anchor" href="#dividir"><i class="fas fa-link"></i></a>
</h3>
<p>Para dividir una cadena basada en un patrón, utiliza <code>str_split()</code>. Esta función evalúa las cadenas y devuelve una <code>lista</code> de vectores de caracteres formada por los valores recién divididos.</p>
<p>El ejemplo que sigue evalúa una cadena y la divide en tres. Por defecto, devuelve un objeto de tipo <code>list</code> con un elemento (un vector de caracteres) por cada cadena proporcionada inicialmente. Si <code>simplify = TRUE</code> devuelve una matriz de caracteres.</p>
<p>En este ejemplo, se proporciona una cadena y la función devuelve una lista con un elemento: un vector de caracteres con tres valores.</p>
<div class="sourceCode" id="cb333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_split</span><span class="op">(</span>string <span class="op">=</span> <span class="st">"jaundice, fever, chills"</span>,</span>
<span>          pattern <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] "jaundice" " fever"   " chills"</code></pre>
<p>Si se guarda la salida, puedes acceder al enésimo valor dividido con la sintaxis de corchetes. Para acceder a un valor específico puedes utilizar una sintaxis como esta: <code>the_returned_object[[1]][2]</code>, que accedería al segundo valor de la primera cadena evaluada (“fever”). Consulta la página de <a href="r-basics.html#r-basics">fundamentos de R</a> para obtener más detalles sobre el acceso a los elementos.</p>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt1_symptoms</span> <span class="op">&lt;-</span> <span class="fu">str_split</span><span class="op">(</span><span class="st">"jaundice, fever, chills"</span>, <span class="st">","</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pt1_symptoms</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>  <span class="co"># extracts 2nd value from 1st (and only) element of the list</span></span></code></pre></div>
<pre><code>## [1] " fever"</code></pre>
<p>Si se proporcionan varias cadenas mediante <code>str_split()</code>, habrá más de un elemento en la lista devuelta.</p>
<div class="sourceCode" id="cb337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">symptoms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"jaundice, fever, chills"</span>,     <span class="co"># patient 1</span></span>
<span>              <span class="st">"chills, aches, pains"</span>,        <span class="co"># patient 2 </span></span>
<span>              <span class="st">"fever"</span>,                       <span class="co"># patient 3</span></span>
<span>              <span class="st">"vomiting, diarrhoea"</span>,         <span class="co"># patient 4</span></span>
<span>              <span class="st">"bleeding from gums, fever"</span>,   <span class="co"># patient 5</span></span>
<span>              <span class="st">"rapid pulse, headache"</span><span class="op">)</span>       <span class="co"># patient 6</span></span>
<span></span>
<span><span class="fu">str_split</span><span class="op">(</span><span class="va">symptoms</span>, <span class="st">","</span><span class="op">)</span>                     <span class="co"># split each patient's symptoms</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] "jaundice" " fever"   " chills" 
## 
## [[2]]
## [1] "chills" " aches" " pains"
## 
## [[3]]
## [1] "fever"
## 
## [[4]]
## [1] "vomiting"   " diarrhoea"
## 
## [[5]]
## [1] "bleeding from gums" " fever"            
## 
## [[6]]
## [1] "rapid pulse" " headache"</code></pre>
<p>Para devolver una “matriz de caracteres” en su lugar, que puede ser útil si se crean columnas de dataframes, establece el argumento <code>simplify = TRUE</code> como se muestra a continuación:</p>
<div class="sourceCode" id="cb339"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_split</span><span class="op">(</span><span class="va">symptoms</span>, <span class="st">","</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      [,1]                 [,2]         [,3]     
## [1,] "jaundice"           " fever"     " chills"
## [2,] "chills"             " aches"     " pains" 
## [3,] "fever"              ""           ""       
## [4,] "vomiting"           " diarrhoea" ""       
## [5,] "bleeding from gums" " fever"     ""       
## [6,] "rapid pulse"        " headache"  ""</code></pre>
<p>También puedes ajustar el número de divisiones a crear con el argumento <code>n =</code>. Por ejemplo, esto restringe el número de divisiones a 2. De este modo, cualquier otra coma permanece dentro del segundo valor.</p>
<div class="sourceCode" id="cb341"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_split</span><span class="op">(</span><span class="va">symptoms</span>, <span class="st">","</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      [,1]                 [,2]            
## [1,] "jaundice"           " fever, chills"
## [2,] "chills"             " aches, pains" 
## [3,] "fever"              ""              
## [4,] "vomiting"           " diarrhoea"    
## [5,] "bleeding from gums" " fever"        
## [6,] "rapid pulse"        " headache"</code></pre>
<p><em>Nota - los mismos resultados se pueden conseguir con <code>str_split_fixed()</code>, en la que no se da el argumento <code>simplify</code>, sino que se debe designar el número de columnas (<code>n</code>).</em></p>
<div class="sourceCode" id="cb343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_split_fixed</span><span class="op">(</span><span class="va">symptoms</span>, <span class="st">","</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="dividir-columnas" class="section level3 unnumbered">
<h3>Dividir columnas<a class="anchor" aria-label="anchor" href="#dividir-columnas"><i class="fas fa-link"></i></a>
</h3>
<p>Si estás intentando dividir una columna de un dataframe, es mejor utilizar la función <code>separate()</code> de <strong>dplyr</strong>. Se utiliza para dividir una columna de caracteres en otras columnas.</p>
<p>Digamos que tenemos un dataframe simple <code>df</code> (definido y unido en la <a href="characters-and-strings.html#str_unite">sección de unir columnas</a>) que contiene una columna <code>case_ID</code>, una columna de caracteres con muchos síntomas y una columna de resultados. Nuestro objetivo es separar la columna de <code>symptoms</code> en varias columnas, cada una de las cuales contiene un síntoma.</p>
<div id="htmlwidget-963575ecef61acb43cbe" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-963575ecef61acb43cbe">{"x":{"filter":"none","vertical":false,"data":[[1,2,3,4,5,6],["jaundice, fever, chills","chills, aches, pains","fever","vomiting, diarrhoea","bleeding from gums, fever","rapid pulse, headache"],["Recover","Death","Death","Recover","Recover","Recover"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_ID<\/th>\n      <th>symptoms<\/th>\n      <th>outcome<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Asumiendo que los datos son enlazados con pipe en <code>separate()</code>, primero proporciona la columna a separar. A continuación, proporcione en = como un vector <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> que contiene los nombres de las <em>nuevas</em> columnas, como se muestra a continuación.</p>
<ul>
<li><p><code>sep =</code> el separador, puede ser un carácter, o un número (interpretado como la posición del carácter a dividir)</p></li>
<li><p><code>remove =</code> FALSE por defecto, elimina la columna de entrada</p></li>
<li><p><code>convert =</code> FALSE por defecto, hará que las cadenas “NA”s se conviertan en <code>NA</code></p></li>
<li><p><code>extra =</code> controla lo que sucede si hay más valores creados por la separación que nuevas columnas nombradas.</p></li>
<li><p><code>extra = "warn"</code> significa que verá una advertencia, pero quitará los valores en exceso (<strong>el valor por defecto</strong>)</p></li>
<li><p><code>extra = "drop"</code> significa que los valores sobrantes se eliminarán sin previo aviso</p></li>
<li><p><strong><code>extra = "merge"</code> sólo dividirá hasta el número de nuevas columnas listadas en <code>into</code> - <em>esta configuración preservará todos tus datos</em></strong></p></li>
</ul>
<p>A continuación se muestra un ejemplo con <code>extra = "merge"</code> - no se pierde ningún dato. Se definen dos nuevas columnas pero cualquier tercer síntoma se deja en la segunda columna nueva:</p>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># third symptoms combined into second new column</span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">separate</span><span class="op">(</span><span class="va">symptoms</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sym_1"</span>, <span class="st">"sym_2"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">","</span>, extra <span class="op">=</span> <span class="st">"merge"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 1 rows [3].</code></pre>
<pre><code>##   case_ID              sym_1          sym_2 outcome
## 1       1           jaundice  fever, chills Recover
## 2       2             chills   aches, pains   Death
## 3       3              fever           &lt;NA&gt;   Death
## 4       4           vomiting      diarrhoea Recover
## 5       5 bleeding from gums          fever Recover
## 6       6        rapid pulse       headache Recover</code></pre>
<p>Cuando se utiliza el <code>extra = "drop"</code> por defecto a continuación, se da una advertencia pero se pierden los terceros síntomas:</p>
<div class="sourceCode" id="cb347"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># third symptoms are lost</span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">separate</span><span class="op">(</span><span class="va">symptoms</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sym_1"</span>, <span class="st">"sym_2"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">","</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Additional pieces discarded in 2 rows [1, 2].</code></pre>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 1 rows [3].</code></pre>
<pre><code>##   case_ID              sym_1      sym_2 outcome
## 1       1           jaundice      fever Recover
## 2       2             chills      aches   Death
## 3       3              fever       &lt;NA&gt;   Death
## 4       4           vomiting  diarrhoea Recover
## 5       5 bleeding from gums      fever Recover
## 6       6        rapid pulse   headache Recover</code></pre>
<p><span style="color: orange;"><strong><em>PRECAUCIÓN:</em></strong> Si no proporcionas suficientes valores <code>into</code> en las nuevas columnas, tus datos pueden quedar truncados. </span></p>
<!-- ======================================================= -->
</div>
<div id="ordenar-alfabéticamente" class="section level3 unnumbered">
<h3>Ordenar alfabéticamente<a class="anchor" aria-label="anchor" href="#ordenar-alfab%C3%A9ticamente"><i class="fas fa-link"></i></a>
</h3>
<p>Se pueden ordenar varias cadenas por orden alfabético. <code>str_order()</code> devuelve el orden, mientras que <code>str_sort()</code> devuelve las cadenas en ese orden.</p>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># strings</span></span>
<span><span class="va">health_zones</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Alba"</span>, <span class="st">"Takota"</span>, <span class="st">"Delta"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># return the alphabetical order</span></span>
<span><span class="fu">str_order</span><span class="op">(</span><span class="va">health_zones</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1 3 2</code></pre>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># return the strings in alphabetical order</span></span>
<span><span class="fu">str_sort</span><span class="op">(</span><span class="va">health_zones</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Alba"   "Delta"  "Takota"</code></pre>
<p>Para utilizar un alfabeto diferente, añade el argumento <code>locale =</code>. Mira lista completa de locales introduciendo <code><a href="https://rdrr.io/pkg/stringi/man/stri_locale_list.html">stringi::stri_locale_list()</a></code> en la consola de R.</p>
<!-- ======================================================= -->
</div>
<div id="funciones-r-base" class="section level3 unnumbered">
<h3>funciones R base<a class="anchor" aria-label="anchor" href="#funciones-r-base"><i class="fas fa-link"></i></a>
</h3>
<p>Es común ver las funciones de R <strong>base</strong> <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> y <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>, que concatenan vectores después de convertir todas las partes en caracteres. Actúan de forma similar a <code>str_c()</code> pero la sintaxis es posiblemente más complicada - en los paréntesis cada parte está separada por una coma. Las partes son o bien texto de carácter (entre comillas) o bien objetos de código predefinidos (sin comillas). Por ejemplo:</p>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_beds</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">n_masks</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Regional hospital needs "</span>, <span class="va">n_beds</span>, <span class="st">" beds and "</span>, <span class="va">n_masks</span>, <span class="st">" masks."</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Regional hospital needs 10 beds and 20 masks."</code></pre>
<p>Se pueden especificar los argumentos <code>sep =</code> y <code>collapse =</code>. <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> es simplemente <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> con un <code>sep =</code> ” ” por defecto (un espacio).</p>
</div>
</div>
<div id="clean-and-standardise" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Limpiar y normalizar<a class="anchor" aria-label="anchor" href="#clean-and-standardise"><i class="fas fa-link"></i></a>
</h2>
<!-- ======================================================= -->
<div id="cambiar-mayúsculas" class="section level3 unnumbered">
<h3>Cambiar mayúsculas<a class="anchor" aria-label="anchor" href="#cambiar-may%C3%BAsculas"><i class="fas fa-link"></i></a>
</h3>
<p>A menudo hay que alterar las mayúsculas y minúsculas de un valor de cadena, por ejemplo los nombres de las jurisdicciones. Utiliza <code>str_to_upper()</code>, <code>str_to_lower()</code>, y <code>str_to_title()</code>, de <strong>stringr</strong>, como se muestra a continuación:</p>
<div class="sourceCode" id="cb357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_to_upper</span><span class="op">(</span><span class="st">"California"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "CALIFORNIA"</code></pre>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_to_lower</span><span class="op">(</span><span class="st">"California"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "california"</code></pre>
<p>Usando R <strong>base</strong>, lo anterior también se puede lograr con <code><a href="https://rdrr.io/r/base/chartr.html">toupper()</a></code>, <code><a href="https://rdrr.io/r/base/chartr.html">tolower()</a></code>.</p>
<p><strong>Capitalización del título</strong></p>
<p>Se puede transformar la cadena para que cada palabra esté en mayúsculas con <code>str_to_title()</code>:</p>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_to_title</span><span class="op">(</span><span class="st">"go to the US state of california "</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Go To The Us State Of California "</code></pre>
<p>Utiliza <code>toTitleCase()</code> del paquete de <strong>tools</strong> para lograr una capitalización más matizada (palabras como “a”, “el” y “de” no se escriben en mayúsculas).</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/toTitleCase.html">toTitleCase</a></span><span class="op">(</span><span class="st">"This is the US state of california"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "This is the US State of California"</code></pre>
<p>También puedes utilizar <code>str_to_sentence()</code>, que sólo pone en mayúsculas la primera letra de la cadena.</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_to_sentence</span><span class="op">(</span><span class="st">"the patient must be transported"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The patient must be transported"</code></pre>
</div>
<div id="str_pad" class="section level3 unnumbered">
<h3>Longitud de la cadena<a class="anchor" aria-label="anchor" href="#str_pad"><i class="fas fa-link"></i></a>
</h3>
<p>Utiliza <code>str_pad()</code> para añadir caracteres a una cadena, con una longitud mínima. Por defecto se añaden espacios, pero también puedes rellenar con otros caracteres utilizando el argumento <code>pad =</code>.</p>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ICD codes of differing length</span></span>
<span><span class="va">ICD_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"R10.13"</span>,</span>
<span>               <span class="st">"R10.819"</span>,</span>
<span>               <span class="st">"R17"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ICD codes padded to 7 characters on the right side</span></span>
<span><span class="fu">str_pad</span><span class="op">(</span><span class="va">ICD_codes</span>, <span class="fl">7</span>, <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "R10.13 " "R10.819" "R17    "</code></pre>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pad with periods instead of spaces</span></span>
<span><span class="fu">str_pad</span><span class="op">(</span><span class="va">ICD_codes</span>, <span class="fl">7</span>, <span class="st">"right"</span>, pad <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "R10.13." "R10.819" "R17...."</code></pre>
<p>Por ejemplo, para rellenar números con ceros a la izquierda (como en el caso de las horas o los minutos), puedes rellenar el número hasta una longitud mínima de 2 con pad = “0”.</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add leading zeros to two digits (e.g. for times minutes/hours)</span></span>
<span><span class="fu">str_pad</span><span class="op">(</span><span class="st">"4"</span>, <span class="fl">2</span>, pad <span class="op">=</span> <span class="st">"0"</span><span class="op">)</span> </span></code></pre></div>
<pre><code>## [1] "04"</code></pre>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example using a numeric column named "hours"</span></span>
<span><span class="co"># hours &lt;- str_pad(hours, 2, pad = "0")</span></span></code></pre></div>
</div>
<div id="truncar" class="section level3 unnumbered">
<h3>Truncar<a class="anchor" aria-label="anchor" href="#truncar"><i class="fas fa-link"></i></a>
</h3>
<p><code>str_trunc()</code> establece una longitud máxima para cada cadena. Si una cadena supera esta longitud, se trunca (acorta) y se incluye una elipsis (…) para indicar que la cadena era antes más larga. Ten en cuenta que la elipsis <em>se</em> cuenta en la longitud. Los caracteres de la elipsis pueden cambiarse con el argumento <code>ellipsis =</code>. El argumento opcional <code>side =</code>especifica dónde aparecerá la elipsis dentro de la cadena truncada (“left”, “right”, o “center”).</p>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">original</span> <span class="op">&lt;-</span> <span class="st">"Symptom onset on 4/3/2020 with vomiting"</span></span>
<span><span class="fu">str_trunc</span><span class="op">(</span><span class="va">original</span>, <span class="fl">10</span>, <span class="st">"center"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Symp...ing"</code></pre>
</div>
<div id="normalizar-la-longitud" class="section level3 unnumbered">
<h3>Normalizar la longitud<a class="anchor" aria-label="anchor" href="#normalizar-la-longitud"><i class="fas fa-link"></i></a>
</h3>
<p>Utiliza <code>str_trunc()</code> para establecer una longitud máxima y, a continuación, utiliza <code>str_pad()</code> para ampliar las cadenas muy cortas hasta esa longitud truncada. En el ejemplo siguiente, se establece 6 como longitud máxima (se trunca un valor), y luego se rellena un valor muy corto para alcanzar la longitud de 6.</p>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ICD codes of differing length</span></span>
<span><span class="va">ICD_codes</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"R10.13"</span>,</span>
<span>                 <span class="st">"R10.819"</span>,</span>
<span>                 <span class="st">"R17"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># truncate to maximum length of 6</span></span>
<span><span class="va">ICD_codes_2</span> <span class="op">&lt;-</span> <span class="fu">str_trunc</span><span class="op">(</span><span class="va">ICD_codes</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">ICD_codes_2</span></span></code></pre></div>
<pre><code>## [1] "R10.13" "R10..." "R17"</code></pre>
<div class="sourceCode" id="cb378"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># expand to minimum length of 6</span></span>
<span><span class="va">ICD_codes_3</span> <span class="op">&lt;-</span> <span class="fu">str_pad</span><span class="op">(</span><span class="va">ICD_codes_2</span>, <span class="fl">6</span>, <span class="st">"right"</span><span class="op">)</span></span>
<span><span class="va">ICD_codes_3</span></span></code></pre></div>
<pre><code>## [1] "R10.13" "R10..." "R17   "</code></pre>
</div>
<div id="eliminar-los-espacios-en-blanco-iniciales-y-finales" class="section level3 unnumbered">
<h3>Eliminar los espacios en blanco iniciales y finales<a class="anchor" aria-label="anchor" href="#eliminar-los-espacios-en-blanco-iniciales-y-finales"><i class="fas fa-link"></i></a>
</h3>
<p>Utiliza <code>str_trim()</code> para eliminar los espacios, las nuevas líneas (<code>\n</code>) o los tabuladores (<code>\t</code>) de los lados de una cadena de entrada. Añade <code>"right"</code> <code>"left"</code>, o <code>"both"</code> al comando para especificar qué lado recortar (por ejemplo, <code>str_trim(x, "right")</code>.</p>
<div class="sourceCode" id="cb380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ID numbers with excess spaces on right</span></span>
<span><span class="va">IDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"provA_1852  "</span>, <span class="co"># two excess spaces</span></span>
<span>         <span class="st">"provA_2345"</span>,   <span class="co"># zero excess spaces</span></span>
<span>         <span class="st">"provA_9460 "</span><span class="op">)</span>  <span class="co"># one excess space</span></span>
<span></span>
<span><span class="co"># IDs trimmed to remove excess spaces on right side only</span></span>
<span><span class="fu">str_trim</span><span class="op">(</span><span class="va">IDs</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "provA_1852" "provA_2345" "provA_9460"</code></pre>
</div>
<div id="eliminar-los-espacios-en-blanco-repetidos-en-una-cadena" class="section level3 unnumbered">
<h3>Eliminar los espacios en blanco repetidos en una cadena<a class="anchor" aria-label="anchor" href="#eliminar-los-espacios-en-blanco-repetidos-en-una-cadena"><i class="fas fa-link"></i></a>
</h3>
<p>Utiliza <code>str_squish()</code> para eliminar los espacios repetidos que aparecen <em>dentro</em> de una cadena. Por ejemplo, para convertir espacios dobles en espacios simples. También elimina espacios, nuevas líneas o tabulaciones en el exterior de la cadena como <code>str_trim()</code>.</p>
<div class="sourceCode" id="cb382"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># original contains excess spaces within string</span></span>
<span><span class="fu">str_squish</span><span class="op">(</span><span class="st">"  Pt requires   IV saline\n"</span><span class="op">)</span> </span></code></pre></div>
<pre><code>## [1] "Pt requires IV saline"</code></pre>
<p>Escribe <code>?str_trim</code>, <code>?str_pad</code> en tu consola de R para ver más detalles.</p>
</div>
<div id="convertir-en-párrafos" class="section level3 unnumbered">
<h3>convertir en párrafos<a class="anchor" aria-label="anchor" href="#convertir-en-p%C3%A1rrafos"><i class="fas fa-link"></i></a>
</h3>
<p>Utiliza <code>str_wrap()</code> para convertir un texto largo no estructurado en un párrafo estructurado con una longitud de línea fija. Proporciona la longitud de caracteres ideal para cada línea, y aplica un algoritmo para insertar nuevas líneas () dentro del párrafo, como se ve en el ejemplo siguiente.</p>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt_course</span> <span class="op">&lt;-</span> <span class="st">"Inicio de los síntomas 1/4/2020 vómitos escalofríos fiebre. La paciente consultó a un curandero tradicional en su pueblo natal el 2/4/2020. El 5/4/2020 los síntomas empeoraron y fue ingresada en la clínica Lumta. Se tomó una muestra y fue trasladada al hospital regional el 6/4/2020. La paciente murió en el hospital regional el 7/4/2020"</span></span>
<span></span>
<span><span class="fu">str_wrap</span><span class="op">(</span><span class="va">pt_course</span>, <span class="fl">40</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Inicio de los síntomas 1/4/2020 vómitos\nescalofríos fiebre. La paciente consultó\na un curandero tradicional en su pueblo\nnatal el 2/4/2020. El 5/4/2020 los\nsíntomas empeoraron y fue ingresada en\nla clínica Lumta. Se tomó una muestra\ny fue trasladada al hospital regional\nel 6/4/2020. La paciente murió en el\nhospital regional el 7/4/2020"</code></pre>
<p>La función <strong>base</strong> <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> puede envolver el comando anterior para imprimir la salida, mostrando las nuevas líneas añadidas.</p>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu">str_wrap</span><span class="op">(</span><span class="va">pt_course</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Inicio de los síntomas 1/4/2020 vómitos
## escalofríos fiebre. La paciente consultó
## a un curandero tradicional en su pueblo
## natal el 2/4/2020. El 5/4/2020 los
## síntomas empeoraron y fue ingresada en
## la clínica Lumta. Se tomó una muestra
## y fue trasladada al hospital regional
## el 6/4/2020. La paciente murió en el
## hospital regional el 7/4/2020</code></pre>
<!-- ======================================================= -->
</div>
</div>
<div id="handle-by-position" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Manipular por posición<a class="anchor" aria-label="anchor" href="#handle-by-position"><i class="fas fa-link"></i></a>
</h2>
<div id="extraer-por-posición-de-carácter" class="section level3 unnumbered">
<h3>Extraer por posición de carácter<a class="anchor" aria-label="anchor" href="#extraer-por-posici%C3%B3n-de-car%C3%A1cter"><i class="fas fa-link"></i></a>
</h3>
<p>Utiliza <code>str_sub()</code> para devolver sólo una parte de una cadena. La función toma tres argumentos principales:</p>
<ol style="list-style-type: decimal">
<li><p>el(los) vector(es) de caracteres</p></li>
<li><p>posición de inicio</p></li>
<li><p>posición final</p></li>
</ol>
<p>Algunas notas sobre los números de posición:</p>
<ul>
<li><p>Si un número de posición es positivo, la posición se cuenta a partir del extremo izquierdo de la cadena.</p></li>
<li><p>Si un número de posición es negativo, se cuenta a partir del extremo derecho de la cadena.</p></li>
<li><p>Los números de posición son inclusivos.</p></li>
<li><p>Las posiciones que se extienden más allá de la cadena serán truncadas (eliminadas).</p></li>
</ul>
<p>A continuación se muestran algunos ejemplos aplicados a la cadena “pneumonia”:</p>
<div class="sourceCode" id="cb388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># start and end third from left (3rd letter from left)</span></span>
<span><span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "e"</code></pre>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 0 is not present</span></span>
<span><span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] ""</code></pre>
<div class="sourceCode" id="cb392"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 6th from left, to the 1st from right</span></span>
<span><span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="fl">6</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "onia"</code></pre>
<div class="sourceCode" id="cb394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5th from right, to the 2nd from right</span></span>
<span><span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "moni"</code></pre>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4th from left to a position outside the string</span></span>
<span><span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="fl">4</span>, <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "umonia"</code></pre>
</div>
<div id="extraer-por-posición-de-palabra" class="section level3 unnumbered">
<h3>Extraer por posición de palabra<a class="anchor" aria-label="anchor" href="#extraer-por-posici%C3%B3n-de-palabra"><i class="fas fa-link"></i></a>
</h3>
<p>Para extraer la enésima ‘palabra’, utiliza <code>word()</code>, también de <strong>stringr</strong>. Proporciona la(s) cadena(s), luego la primera y la última posición de la palabra a extraer.</p>
<p>Por defecto, se asume que el separador entre ‘palabras’ es un espacio, a menos que se indica lo contrario con <code>sep =</code> (por ejemplo, <code>sep = "_"</code> cuando las palabras están separadas por barra baja.</p>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># strings to evaluate</span></span>
<span><span class="va">chief_complaints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I just got out of the hospital 2 days ago, but still can barely breathe."</span>,</span>
<span>                      <span class="st">"My stomach hurts"</span>,</span>
<span>                      <span class="st">"Severe ear pain"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract 1st to 3rd words of each string</span></span>
<span><span class="fu">word</span><span class="op">(</span><span class="va">chief_complaints</span>, start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">3</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "I just got"       "My stomach hurts" "Severe ear pain"</code></pre>
</div>
<div id="sustituir-por-posición-de-carácter" class="section level3 unnumbered">
<h3>Sustituir por posición de carácter<a class="anchor" aria-label="anchor" href="#sustituir-por-posici%C3%B3n-de-car%C3%A1cter"><i class="fas fa-link"></i></a>
</h3>
<p><code>str_sub()</code> emparejado con el operador de asignación (<code>&lt;-</code>) puede utilizarse para modificar una parte de una cadena:</p>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">word</span> <span class="op">&lt;-</span> <span class="st">"pneumonia"</span></span>
<span></span>
<span><span class="co"># convert the third and fourth characters to X </span></span>
<span><span class="fu">str_sub</span><span class="op">(</span><span class="va">word</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"XX"</span></span>
<span></span>
<span><span class="co"># print</span></span>
<span><span class="va">word</span></span></code></pre></div>
<pre><code>## [1] "pnXXmonia"</code></pre>
<p>Un ejemplo aplicado a varias cadenas (por ejemplo, una columna). Obsérvese la ampliación de la longitud de “HIV”.</p>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">words</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="st">"tubercolosis"</span>, <span class="st">"HIV"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert the third and fourth characters to X </span></span>
<span><span class="fu">str_sub</span><span class="op">(</span><span class="va">words</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"XX"</span></span>
<span></span>
<span><span class="va">words</span></span></code></pre></div>
<pre><code>## [1] "pnXXmonia"    "tuXXrcolosis" "HIXX"</code></pre>
</div>
<div id="evaluar-la-longitud" class="section level3 unnumbered">
<h3>Evaluar la longitud<a class="anchor" aria-label="anchor" href="#evaluar-la-longitud"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_length</span><span class="op">(</span><span class="st">"abc"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Como alternativa, utiliza <code><a href="https://rdrr.io/r/base/nchar.html">nchar()</a></code> de R <strong>base</strong></p>
<!-- ======================================================= -->
</div>
</div>
<div id="patterns" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Patrones<a class="anchor" aria-label="anchor" href="#patterns"><i class="fas fa-link"></i></a>
</h2>
<p>Muchas funciones de <strong>stringr</strong> trabajan para detectar, localizar, extraer, hacer coincidir, reemplazar y dividir basándose en un <em>patrón</em> especificado.</p>
<!-- ======================================================= -->
<div id="detectar-un-patrón" class="section level3 unnumbered">
<h3>Detectar un patrón<a class="anchor" aria-label="anchor" href="#detectar-un-patr%C3%B3n"><i class="fas fa-link"></i></a>
</h3>
<p>Utiliza <code>str_detect()</code> como se indica a continuación para detectar la presencia/ausencia de un patrón dentro de una cadena. Primero proporciona la cadena o vector en la que a buscar (<code>string =</code>), y luego el patrón a buscar (<code>pattern =</code>). Ten en cuenta que, por defecto, la búsqueda <em>distingue entre mayúsculas y minúsculas</em>.</p>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_detect</span><span class="op">(</span>string <span class="op">=</span> <span class="st">"primary school teacher"</span>, pattern <span class="op">=</span> <span class="st">"teach"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Se puede incluir el argumento <code>negate =</code> y ponerlo a <code>TRUE</code> si se quiere saber si el patrón NO está presente.</p>
<div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_detect</span><span class="op">(</span>string <span class="op">=</span> <span class="st">"primary school teacher"</span>, pattern <span class="op">=</span> <span class="st">"teach"</span>, negate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Para ignorar las mayúsculas y minúsculas, envuelve el patrón dentro de <code>regex()</code>, y <em>dentro</em> de <code>regex()</code> añade el argumento <code>ignore_case = TRUE</code> (o <code>T</code> como abreviatura).</p>
<div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_detect</span><span class="op">(</span>string <span class="op">=</span> <span class="st">"Teacher"</span>, pattern <span class="op">=</span> <span class="fu">regex</span><span class="op">(</span><span class="st">"teach"</span>, ignore_case <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Cuando <code>str_detect()</code> se aplica a un vector de caracteres o a una columna de un dataframe, devolverá TRUE o FALSE para cada uno de los valores.</p>
<div class="sourceCode" id="cb412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a vector/column of occupations </span></span>
<span><span class="va">occupations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"field laborer"</span>,</span>
<span>                 <span class="st">"university professor"</span>,</span>
<span>                 <span class="st">"primary school teacher &amp; tutor"</span>,</span>
<span>                 <span class="st">"tutor"</span>,</span>
<span>                 <span class="st">"nurse at regional hospital"</span>,</span>
<span>                 <span class="st">"lineworker at Amberdeen Fish Factory"</span>,</span>
<span>                 <span class="st">"physican"</span>,</span>
<span>                 <span class="st">"cardiologist"</span>,</span>
<span>                 <span class="st">"office worker"</span>,</span>
<span>                 <span class="st">"food service"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Detect presence of pattern "teach" in each string - output is vector of TRUE/FALSE</span></span>
<span><span class="fu">str_detect</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach"</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>Si necesitas contar los <code>TRUE</code>, simplemente <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> la salida. Esto cuenta el número de <code>TRUE</code>.</p>
<div class="sourceCode" id="cb414"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Para buscar con varios términos, inclúyelos separados por barras (<code>|</code>) dentro del argumento <code>pattern =</code>, como se muestra a continuación:</p>
<div class="sourceCode" id="cb416"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span>string <span class="op">=</span> <span class="va">occupations</span>, pattern <span class="op">=</span> <span class="st">"teach|professor|tutor"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Si necesitas construir una larga lista de términos de búsqueda, puedes combinarlos usando <code>str_c()</code> y <code>sep = |</code>, luego definir que esto es un objeto de caracteres, y luego referenciar el vector más adelante de manera más sucinta. El ejemplo siguiente incluye posibles términos de búsqueda de ocupación para proveedores médicos de primera línea.</p>
<div class="sourceCode" id="cb418"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># search terms</span></span>
<span><span class="va">occupation_med_frontline</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="st">"medical"</span>, <span class="st">"medicine"</span>, <span class="st">"hcw"</span>, <span class="st">"healthcare"</span>, <span class="st">"home care"</span>, <span class="st">"home health"</span>,</span>
<span>                                <span class="st">"surgeon"</span>, <span class="st">"doctor"</span>, <span class="st">"doc"</span>, <span class="st">"physician"</span>, <span class="st">"surgery"</span>, <span class="st">"peds"</span>, <span class="st">"pediatrician"</span>,</span>
<span>                               <span class="st">"intensivist"</span>, <span class="st">"cardiologist"</span>, <span class="st">"coroner"</span>, <span class="st">"nurse"</span>, <span class="st">"nursing"</span>, <span class="st">"rn"</span>, <span class="st">"lpn"</span>,</span>
<span>                               <span class="st">"cna"</span>, <span class="st">"pa"</span>, <span class="st">"physician assistant"</span>, <span class="st">"mental health"</span>,</span>
<span>                               <span class="st">"emergency department technician"</span>, <span class="st">"resp therapist"</span>, <span class="st">"respiratory"</span>,</span>
<span>                                <span class="st">"phlebotomist"</span>, <span class="st">"pharmacy"</span>, <span class="st">"pharmacist"</span>, <span class="st">"hospital"</span>, <span class="st">"snf"</span>, <span class="st">"rehabilitation"</span>,</span>
<span>                               <span class="st">"rehab"</span>, <span class="st">"activity"</span>, <span class="st">"elderly"</span>, <span class="st">"subacute"</span>, <span class="st">"sub acute"</span>,</span>
<span>                                <span class="st">"clinic"</span>, <span class="st">"post acute"</span>, <span class="st">"therapist"</span>, <span class="st">"extended care"</span>,</span>
<span>                                <span class="st">"dental"</span>, <span class="st">"dential"</span>, <span class="st">"dentist"</span>, sep <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">occupation_med_frontline</span></span></code></pre></div>
<pre><code>## [1] "medical|medicine|hcw|healthcare|home care|home health|surgeon|doctor|doc|physician|surgery|peds|pediatrician|intensivist|cardiologist|coroner|nurse|nursing|rn|lpn|cna|pa|physician assistant|mental health|emergency department technician|resp therapist|respiratory|phlebotomist|pharmacy|pharmacist|hospital|snf|rehabilitation|rehab|activity|elderly|subacute|sub acute|clinic|post acute|therapist|extended care|dental|dential|dentist"</code></pre>
<p>Este comando devuelve el número de ocupaciones que contienen alguno de los términos de búsqueda para proveedores médicos de primera línea (<code>occupation_med_frontline</code>):</p>
<div class="sourceCode" id="cb420"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span>string <span class="op">=</span> <span class="va">occupations</span>, pattern <span class="op">=</span> <span class="va">occupation_med_frontline</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p><strong>Funciones de búsqueda de cadenas en R base</strong></p>
<p><code><a href="https://rdrr.io/r/base/grep.html">grepl()</a></code> de R <strong>base</strong> funciona de forma similar a <code>str_detect()</code>, en el sentido de que busca coincidencias con un patrón y devuelve un vector lógico. La sintaxis básica es <code>grepl(patrón,  cadenas_de_búsqueda, ignore.case = FALSE, ...)</code>. Una ventaja es que el argumento ignore.case es más fácil de escribir (no hay necesidad de involucrar la función <code>regex()</code>).</p>
<p>Asimismo, las funciones <code><a href="https://rdrr.io/r/base/grep.html">sub()</a></code> y <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code>de R <strong>base</strong> actúan de forma similar a <code>str_replace()</code>. Su sintaxis básica es: <code>gsub(patrón, reemplazo, cadenas_de_búsqueda, ignore.case = FALSE)</code>. <code><a href="https://rdrr.io/r/base/grep.html">sub()</a></code> reemplazará la primera instancia del patrón, mientras que <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> reemplazará todas las instancias del patrón.</p>
<div id="convertir-comas-en-puntos" class="section level4 unnumbered">
<h4>Convertir comas en puntos<a class="anchor" aria-label="anchor" href="#convertir-comas-en-puntos"><i class="fas fa-link"></i></a>
</h4>
<p>He aquí un ejemplo de uso de <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> para convertir comas en puntos en un vector de números. Esto podría ser útil si tus datos proceden de otras partes del mundo que no sean Estados Unidos o Gran Bretaña.</p>
<p><code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> internamente actúa primero sobre <code>lengths</code> convirtiendo cualquier punto en sin espacio ““. El carácter de punto”.” tiene que ser “escapado” con dos barras inclinadas para significar realmente un punto, porque “.” en regex significa “cualquier carácter”. A continuación, el resultado (con sólo comas) se pasa a la función externa <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> en la que las comas se sustituyen por puntos.</p>
<div class="sourceCode" id="cb422"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2.454,56"</span>, <span class="st">"1,2"</span>, <span class="st">"6.096,5"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">","</span>,                <span class="co"># find commas     </span></span>
<span>                replacement <span class="op">=</span> <span class="st">"."</span>,            <span class="co"># replace with periods</span></span>
<span>                x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">""</span>, <span class="va">lengths</span><span class="op">)</span>  <span class="co"># vector with other periods removed (periods escaped)</span></span>
<span>                <span class="op">)</span></span>
<span>           <span class="op">)</span>                                  <span class="co"># convert outcome to numeric</span></span></code></pre></div>
</div>
</div>
<div id="sustituir-todo" class="section level3 unnumbered">
<h3>Sustituir todo<a class="anchor" aria-label="anchor" href="#sustituir-todo"><i class="fas fa-link"></i></a>
</h3>
<p>Utiliza <code>str_replace_all()</code> como herramienta de “búsqueda y sustitución”. Primero, proporcione las cadenas a evaluar a <code>string =</code>, luego el patrón a reemplazar a <code>pattern =</code>, y luego el valor de reemplazo a <code>replacement =</code>. El ejemplo siguiente reemplaza todas las instancias de “dead” con “deceased”. Ten en cuenta que esto distingue entre mayúsculas y minúsculas.</p>
<div class="sourceCode" id="cb423"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Karl: dead"</span>,</span>
<span>            <span class="st">"Samantha: dead"</span>,</span>
<span>            <span class="st">"Marco: not dead"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">str_replace_all</span><span class="op">(</span>string <span class="op">=</span> <span class="va">outcome</span>, pattern <span class="op">=</span> <span class="st">"dead"</span>, replacement <span class="op">=</span> <span class="st">"deceased"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Karl: deceased"      "Samantha: deceased"  "Marco: not deceased"</code></pre>
<p>Notas:</p>
<ul>
<li><p>Para sustituir un patrón por <code>NA</code>, utiliza <code>str_replace_na()</code>.</p></li>
<li><p>La función <code>str_replace()</code> reemplaza sólo la primera instancia del patrón dentro de cada cadena evaluada.</p></li>
</ul>
<!-- ======================================================= -->
</div>
<div id="detectar-con-lógica" class="section level3 unnumbered">
<h3>Detectar con lógica<a class="anchor" aria-label="anchor" href="#detectar-con-l%C3%B3gica"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Dentro de case_when()</strong></p>
<p><code>str_detect()</code> se utiliza a menudo dentro de <code>case_when()</code> (de <strong>dplyr</strong>). Digamos que ocupaciones es una columna en linelist. La función <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> de abajo crea una nueva columna llamada <code>is_educator</code> utilizando la lógica condicional a través de <code>case_when()</code>. Mira la página sobre limpieza de datos para aprender más sobre <code>case_when()</code>.</p>
<div class="sourceCode" id="cb425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>is_educator <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="co"># term search within occupation, not case sensitive</span></span>
<span>    <span class="fu">str_detect</span><span class="op">(</span><span class="va">occupations</span>,</span>
<span>               <span class="fu">regex</span><span class="op">(</span><span class="st">"teach|prof|tutor|university"</span>,</span>
<span>                     ignore_case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>              <span class="op">~</span> <span class="st">"Educator"</span>,</span>
<span>    <span class="co"># all others</span></span>
<span>    <span class="cn">TRUE</span>                                               <span class="op">~</span> <span class="st">"Not an educator"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Como recordatorio, puede ser importante añadir criterios de exclusión a la lógica condicional (<code>negate = F</code>):</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="characters-and-strings.html#cb426-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb426-2"><a href="characters-and-strings.html#cb426-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># value in new column is_educator is based on conditional logic</span></span>
<span id="cb426-3"><a href="characters-and-strings.html#cb426-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_educator =</span> <span class="fu">case_when</span>(</span>
<span id="cb426-4"><a href="characters-and-strings.html#cb426-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb426-5"><a href="characters-and-strings.html#cb426-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># occupation column must meet 2 criteria to be assigned "Educator":</span></span>
<span id="cb426-6"><a href="characters-and-strings.html#cb426-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># it must have a search term AND NOT any exclusion term</span></span>
<span id="cb426-7"><a href="characters-and-strings.html#cb426-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb426-8"><a href="characters-and-strings.html#cb426-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Must have a search term</span></span>
<span id="cb426-9"><a href="characters-and-strings.html#cb426-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(occupations,</span>
<span id="cb426-10"><a href="characters-and-strings.html#cb426-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">regex</span>(<span class="st">"teach|prof|tutor|university"</span>, <span class="at">ignore_case =</span> T)) <span class="sc">&amp;</span>              </span>
<span id="cb426-11"><a href="characters-and-strings.html#cb426-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb426-12"><a href="characters-and-strings.html#cb426-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AND must NOT have an exclusion term</span></span>
<span id="cb426-13"><a href="characters-and-strings.html#cb426-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(occupations,</span>
<span id="cb426-14"><a href="characters-and-strings.html#cb426-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">regex</span>(<span class="st">"admin"</span>, <span class="at">ignore_case =</span> T),</span>
<span id="cb426-15"><a href="characters-and-strings.html#cb426-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">negate =</span> <span class="cn">TRUE</span>                        <span class="sc">~</span> <span class="st">"Educator"</span></span>
<span id="cb426-16"><a href="characters-and-strings.html#cb426-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb426-17"><a href="characters-and-strings.html#cb426-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># All rows not meeting above criteria</span></span>
<span id="cb426-18"><a href="characters-and-strings.html#cb426-18" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span>                                            <span class="sc">~</span> <span class="st">"Not an educator"</span>))</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="localizar-la-posición-de-un-patrón" class="section level3 unnumbered">
<h3>Localizar la posición de un patrón<a class="anchor" aria-label="anchor" href="#localizar-la-posici%C3%B3n-de-un-patr%C3%B3n"><i class="fas fa-link"></i></a>
</h3>
<p>Para localizar la <em>primera</em> posición de un patrón, utiliza <code>str_locate()</code>. Esta función da como resultado una posición inicial y una final.</p>
<div class="sourceCode" id="cb427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_locate</span><span class="op">(</span><span class="st">"I wish"</span>, <span class="st">"sh"</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      start end
## [1,]     5   6</code></pre>
<p>Al igual que otras funciones <code>str</code>, existe una versión “_all” (<code>str_locate_all()</code>) que devolverá las posiciones de <em>todas</em> las instancias del patrón dentro de cada cadena. La salida es una <code>lista</code>.</p>
<div class="sourceCode" id="cb429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phrases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I wish"</span>, <span class="st">"I hope"</span>, <span class="st">"he hopes"</span>, <span class="st">"He hopes"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">str_locate</span><span class="op">(</span><span class="va">phrases</span>, <span class="st">"h"</span> <span class="op">)</span>     <span class="co"># position of *first* instance of the pattern</span></span></code></pre></div>
<pre><code>##      start end
## [1,]     6   6
## [2,]     3   3
## [3,]     1   1
## [4,]     4   4</code></pre>
<div class="sourceCode" id="cb431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_locate_all</span><span class="op">(</span><span class="va">phrases</span>, <span class="st">"h"</span> <span class="op">)</span> <span class="co"># position of *every* instance of the pattern</span></span></code></pre></div>
<pre><code>## [[1]]
##      start end
## [1,]     6   6
## 
## [[2]]
##      start end
## [1,]     3   3
## 
## [[3]]
##      start end
## [1,]     1   1
## [2,]     4   4
## 
## [[4]]
##      start end
## [1,]     4   4</code></pre>
<!-- ======================================================= -->
</div>
<div id="extraer-una-coincidencia" class="section level3 unnumbered">
<h3>Extraer una coincidencia<a class="anchor" aria-label="anchor" href="#extraer-una-coincidencia"><i class="fas fa-link"></i></a>
</h3>
<p><code>str_extract_all()</code> devuelve los patrones coincidentes en sí mismos, lo que resulta muy útil cuando se han ofrecido varios patrones mediante condiciones “OR”. Por ejemplo, buscando en el vector de cadenas de ocupaciones (véase la pestaña anterior) <em>cualquiera</em> “enseñ”, “profesor” o “tutor”.</p>
<p><code>str_extract_all()</code> devuelve una <code>lista</code> que contiene <em>todas las coincidencias</em> de cada cadena evaluada. Mira a continuación cómo la ocupación 3 tiene dos coincidencias de patrón dentro de ella.</p>
<div class="sourceCode" id="cb433"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach|prof|tutor"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [[1]]
## character(0)
## 
## [[2]]
## [1] "prof"
## 
## [[3]]
## [1] "teach" "tutor"
## 
## [[4]]
## [1] "tutor"
## 
## [[5]]
## character(0)
## 
## [[6]]
## character(0)
## 
## [[7]]
## character(0)
## 
## [[8]]
## character(0)
## 
## [[9]]
## character(0)
## 
## [[10]]
## character(0)</code></pre>
<p><code>str_extract()</code> extrae <em>sólo la primera coincidencia</em> en cada cadena evaluada, produciendo un vector de caracteres con un elemento por cada cadena evaluada. Devuelve NA cuando no hay coincidencias. Los <code>NA</code>s pueden ser eliminados envolviendo el vector devuelto con <code><a href="https://rdrr.io/r/stats/na.fail.html">na.exclude()</a></code>. Observa cómo la segunda de las coincidencias de la ocupación 3 no se muestra.</p>
<div class="sourceCode" id="cb435"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_extract</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach|prof|tutor"</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] NA      "prof"  "teach" "tutor" NA      NA      NA      NA      NA      NA</code></pre>
<!-- ======================================================= -->
</div>
<div id="subconjunto-y-recuento" class="section level3 unnumbered">
<h3>Subconjunto y recuento<a class="anchor" aria-label="anchor" href="#subconjunto-y-recuento"><i class="fas fa-link"></i></a>
</h3>
<p>Las funciones alineadas incluyen <code>str_subset()</code> y <code>str_count()</code>.</p>
<p><code>str_subset()</code> devuelve los valores reales que contienen el patrón:</p>
<div class="sourceCode" id="cb437"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_subset</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach|prof|tutor"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "university professor"           "primary school teacher &amp; tutor" "tutor"</code></pre>
<p><code>str_count()</code> devuelve un vector de números: el <strong>número de veces</strong> que aparece un término de búsqueda en cada valor evaluado.</p>
<div class="sourceCode" id="cb439"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_count</span><span class="op">(</span><span class="va">occupations</span>, <span class="fu">regex</span><span class="op">(</span><span class="st">"teach|prof|tutor"</span>, ignore_case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] 0 1 2 1 0 0 0 0 0 0</code></pre>
<!-- ======================================================= -->
</div>
<div id="grupos-regex" class="section level3 unnumbered">
<h3>Grupos Regex<a class="anchor" aria-label="anchor" href="#grupos-regex"><i class="fas fa-link"></i></a>
</h3>
<p>EN CONSTRUCCIÓN</p>
<!-- ======================================================= -->
</div>
</div>
<div id="special-characters" class="section level2" number="10.6">
<h2>
<span class="header-section-number">10.6</span> Caracteres especiales<a class="anchor" aria-label="anchor" href="#special-characters"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Barra invertida <code>\</code> como código de escape</strong></p>
<p>La barra invertida <code>\</code> se utiliza para “escapar” del significado del siguiente carácter. De este modo, se puede utilizar una barra invertida para que una comilla aparezca <em>dentro</em> de otras comillas (<code>\"</code>) - la comilla del medio no “romperá” las comillas circundantes.</p>
<p>Nota - por lo tanto, si quieres <em>mostrar una barra</em> invertida, debes escapar su significado con <em>otra</em> barra invertida. Así que debes escribir dos barras invertidas <code>\\</code> para mostrar una.</p>
<p><strong>Caracteres especiales</strong></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="64%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th>Carácter especial</th>
<th>Representa</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"\\"</code></td>
<td>barra invertida</td>
</tr>
<tr class="even">
<td><code>"\n"</code></td>
<td>una nueva línea</td>
</tr>
<tr class="odd">
<td><code>"\""</code></td>
<td>comillas dobles <em>dentro de</em> comillas dobles</td>
</tr>
<tr class="even">
<td><code>'\''</code></td>
<td>comillas simples <em>dentro de</em> comillas simples</td>
</tr>
<tr class="odd">
<td>
<code>"\</code>“<code>| acento grave</code>”<code>| retorno carro</code>“<code>| tab</code>”<code>| tab vertical</code>“`</td>
<td>retroceso</td>
</tr>
</tbody>
</table></div>
<p>Ejecuta <code><a href="https://rdrr.io/r/base/Quotes.html">?"'"</a></code> en la consola de R para mostrar una lista completa de estos caracteres especiales (aparecerá en el panel de ayuda de RStudio).</p>
<!-- ======================================================= -->
</div>
<div id="regular-expressions-regex" class="section level2" number="10.7">
<h2>
<span class="header-section-number">10.7</span> Expresiones regulares (regex)<a class="anchor" aria-label="anchor" href="#regular-expressions-regex"><i class="fas fa-link"></i></a>
</h2>
<!-- ======================================================= -->
</div>
<div id="regex-and-special-characters" class="section level2" number="10.8">
<h2>
<span class="header-section-number">10.8</span> Regex y caracteres especiales<a class="anchor" aria-label="anchor" href="#regex-and-special-characters"><i class="fas fa-link"></i></a>
</h2>
<p>Las expresiones regulares, o “regex”, son un lenguaje conciso para describir patrones en las cadenas. Si no está familiarizado con él, una expresión regular puede parecer un lenguaje extraño. Aquí tratamos de desmitificar un poco este lenguaje.</p>
<p><em>Gran parte de esta sección está adaptada de <a href="https://towardsdatascience.com/a-gentle-introduction-to-regular-expressions-with-r-df5e897ca432">este tutorial</a> y de <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf">esta hoja de trucos</a></em>. Aquí adaptamos selectivamente sabiendo que este manual podría ser visto por personas sin acceso a internet para ver los otros tutoriales.</p>
<p>Una expresión regular se aplica a menudo para extraer patrones específicos de texto “no estructurado”, por ejemplo, notas médicas, quejas principales, historial del paciente u otras columnas de texto libre en un dataframe.</p>
<p>Hay cuatro herramientas básicas que se pueden utilizar para crear una expresión regular básica:</p>
<ol style="list-style-type: decimal">
<li><p>Juegos de caracteres</p></li>
<li><p>Metacaracteres</p></li>
<li><p>Cuantificadores</p></li>
<li><p>Grupos</p></li>
</ol>
<p><strong>Juegos de caracteres</strong></p>
<p>Los conjuntos de caracteres, son una forma de expresar las opciones de la lista para una coincidencia de caracteres, entre paréntesis. Así, cualquier coincidencia se activará si cualquiera de los caracteres dentro de los paréntesis se encuentra en la cadena. Por ejemplo, para buscar vocales se podría utilizar este conjunto de caracteres “[aeiou]”. Otros conjuntos de caracteres comunes son:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Caracteres</th>
<th>Coinciden con</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"[A-Z]"</code></td>
<td>una letra mayúscula</td>
</tr>
<tr class="even">
<td><code>"[a-z]"</code></td>
<td>una letra minúscula</td>
</tr>
<tr class="odd">
<td><code>"[0-9]"</code></td>
<td>un dígito</td>
</tr>
<tr class="even">
<td><code>[:alnum:]</code></td>
<td>un carácter alfanumérico</td>
</tr>
<tr class="odd">
<td><code>[:digit:]</code></td>
<td>un dígito numérico</td>
</tr>
<tr class="even">
<td><code>[:alpha:]</code></td>
<td>una letra (mayúscula o minúscula)</td>
</tr>
<tr class="odd">
<td><code>[:upper:]</code></td>
<td>una letra mayúscula</td>
</tr>
<tr class="even">
<td><code>[:lower:]</code></td>
<td>una letra minúscula</td>
</tr>
</tbody>
</table></div>
<p>Los conjuntos de caracteres pueden combinarse dentro de un paréntesis (¡sin espacios!), como <code>"[A-Za-z]"</code> (cualquier letra mayúscula o minúscula), u otro ejemplo <code>"[t-z0-5]"</code> (de la t a la z en minúscula o del número 0 al 5).</p>
<p><strong>Meta caracteres</strong></p>
<p>Los metacaracteres son la abreviatura de los juegos de caracteres. A continuación se enumeran algunos de los más importantes:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="22%">
<col width="77%">
</colgroup>
<thead><tr class="header">
<th>Meta carácter</th>
<th>Coincide con</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"\\s"</code></td>
<td>un solo espacio</td>
</tr>
<tr class="even">
<td><code>"\\w"</code></td>
<td>cualquier carácter alfanumérico (A-Z, a-z, o 0-9)</td>
</tr>
<tr class="odd">
<td><code>"\\d"</code></td>
<td>cualquier dígito numérico (0-9)</td>
</tr>
</tbody>
</table></div>
<p><strong>Cuantificadores</strong></p>
<p>Normalmente no se desea buscar una coincidencia en un solo carácter. Los cuantificadores le permiten designar la longitud de las letras/números para permitir la coincidencia.</p>
<p>Los cuantificadores son números escritos entre corchetes <code><a href="https://rdrr.io/r/base/Paren.html">{ }</a></code> <em>después</em> del carácter que cuantifican, por ejemplo,</p>
<ul>
<li><p><code>"A{2}"</code> devolverá instancias de <strong>dos</strong> letras A mayúsculas.</p></li>
<li><p><code>"A{2,4}"</code> devolverá instancias de <strong>entre dos y cuatro</strong> letras A mayúsculas <em>(¡no ponga espacios!)</em>.</p></li>
<li><p><code>"A{2,}"</code> devolverá instancias de <strong>dos o más</strong> letras A mayúsculas.</p></li>
<li><p><code>"A+"</code> devolverá instancias de <strong>una o más</strong> letras A mayúsculas (grupo extendido hasta que se encuentre un carácter diferente).</p></li>
<li><p>Preceder con un asterisco <code>*</code> para devolver <strong>cero o más</strong> coincidencias (útil si no está seguro de que el patrón está presente)</p></li>
</ul>
<p>Utilizando el símbolo <code>+</code> como cuantificador, la coincidencia se producirá hasta que se encuentre un carácter diferente. Por ejemplo, esta expresión devolverá todas las <em>palabras</em> (caracteres alfa: <code>"[A-Za-z]+"</code></p>
<div class="sourceCode" id="cb441"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># test string for quantifiers</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="st">"A-AA-AAA-AAAA"</span></span></code></pre></div>
<p>Cuando se utiliza un cuantificador de {2}, sólo se devuelven los pares de A consecutivos. Se identifican dos pares dentro de <code>AAAA</code>.</p>
<div class="sourceCode" id="cb442"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">test</span>, <span class="st">"A{2}"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] "AA" "AA" "AA" "AA"</code></pre>
<p>Cuando se utiliza un cuantificador de {2,4}, se devuelven grupos de A consecutivos de dos a cuatro.</p>
<div class="sourceCode" id="cb444"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">test</span>, <span class="st">"A{2,4}"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] "AA"   "AAA"  "AAAA"</code></pre>
<p>Con el cuantificador <code>+</code>, se devuelven grupos de <strong>uno o más</strong>:</p>
<div class="sourceCode" id="cb446"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">test</span>, <span class="st">"A+"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] "A"    "AA"   "AAA"  "AAAA"</code></pre>
<p><strong>Posición relativa</strong></p>
<p>Expresan los requisitos de lo que precede o sigue a un patrón. Por ejemplo, para extraer frases, “dos números que van seguidos de un punto” (<code>""</code>). (?&lt;=\.)\s(?=[A-Z])</p>
<div class="sourceCode" id="cb448"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">test</span>, <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [[1]]
##  [1] "A" "-" "A" "A" "-" "A" "A" "A" "-" "A" "A" "A" "A"</code></pre>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Definición posición</th>
<th>Coincide con</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"(?&lt;=b)a"</code></td>
<td>“a” que <strong>está precedida</strong> con una “b”</td>
</tr>
<tr class="even">
<td><code>"(?&lt;!b)a"</code></td>
<td>“a” que <strong>NO está precedida</strong> con una “b”</td>
</tr>
<tr class="odd">
<td><code>"a(?=b)"</code></td>
<td>“a” que <strong>se sigue</strong> de una “b”</td>
</tr>
<tr class="even">
<td><code>"a(?!b)"</code></td>
<td>“a” que <strong>NO se sigue</strong> de una “b”</td>
</tr>
</tbody>
</table></div>
<p><strong>Grupos</strong></p>
<p>La captura de grupos en su expresión regular es una forma de tener una salida más organizada al momento de la extracción.</p>
<p><strong>Ejemplos de Regex</strong></p>
<p>A continuación se presenta un texto libre para los ejemplos. Intentaremos extraer información útil del mismo utilizando un término de búsqueda de expresión regular.</p>
<div class="sourceCode" id="cb450"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt_note</span> <span class="op">&lt;-</span> <span class="st">"El paciente llegó a la sala de urgencias del Broward Hospital a las 18:00 horas del 6/12/2005. Se presentó con dolor abdominal irradiado desde el cuadrante LR. La piel estaba pálida, fría y húmeda. Su temperatura era de 99,8 grados Farinheit. El pulso era de 100 lpm y filiforme. La frecuencia respiratoria era de 29 por minuto"</span></span></code></pre></div>
<p>Esta expresión coincide con todas las palabras (cualquier carácter hasta llegar a un no carácter como un espacio):</p>
<div class="sourceCode" id="cb451"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">pt_note</span>, <span class="st">"[A-Za-z]+"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [[1]]
##  [1] "El"           "paciente"     "lleg"         "a"            "la"           "sala"        
##  [7] "de"           "urgencias"    "del"          "Broward"      "Hospital"     "a"           
## [13] "las"          "horas"        "del"          "Se"           "present"      "con"         
## [19] "dolor"        "abdominal"    "irradiado"    "desde"        "el"           "cuadrante"   
## [25] "LR"           "La"           "piel"         "estaba"       "p"            "lida"        
## [31] "fr"           "a"            "y"            "h"            "meda"         "Su"          
## [37] "temperatura"  "era"          "de"           "grados"       "Farinheit"    "El"          
## [43] "pulso"        "era"          "de"           "lpm"          "y"            "filiforme"   
## [49] "La"           "frecuencia"   "respiratoria" "era"          "de"           "por"         
## [55] "minuto"</code></pre>
<p>La expresión <code>"[0-9]{1,2}"</code> coincide con números consecutivos de 1 o 2 dígitos. También podría escribirse <code>"\\d{1,2}"</code>, o <code>"[:digit:]{1,2}"</code>.</p>
<div class="sourceCode" id="cb453"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">pt_note</span>, <span class="st">"[0-9]{1,2}"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [[1]]
##  [1] "18" "00" "6"  "12" "20" "05" "99" "8"  "10" "0"  "29"</code></pre>
<!-- This expression will extract all sentences (assuming first letter is capitalized, and the sentence ends with a period). The pattern reads in English as: "A capital letter followed by some lowercase letters, a space, some letters, a space,     -->
<!-- ```{r} -->
<!-- str_extract_all(pt_note, "[A-Z][a-z]+\\s\\w+\\s\\d{1,2}\\s\\w+\\s*\\w*") -->
<!-- ``` -->
<p>Puedes ver una lista útil de expresiones regex y consejos en la página 2 de <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf">esta hoja de trucos</a></p>
<p>Mira también este <a href="https://towardsdatascience.com/a-gentle-introduction-to-regular-expressions-with-r-df5e897ca432">tutorial</a>.</p>
<!-- ======================================================= -->
</div>
<div id="resources-3" class="section level2" number="10.9">
<h2>
<span class="header-section-number">10.9</span> Recursos<a class="anchor" aria-label="anchor" href="#resources-3"><i class="fas fa-link"></i></a>
</h2>
<p>Puedes encontrar una hoja de referencia para las funciones de <strong>stringr</strong> <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf">aquí</a></p>
<p>Puedes encontrar una viñeta sobre <strong>stringr</strong> <a href="https://cran.r-project.org/web/packages/stringr/vignettes/stringr.html">aquí</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="working-with-dates.html"><span class="header-section-number">9</span> Trabajando con Fechas</a></div>
<div class="next"><a href="factors.html"><span class="header-section-number">11</span> Factores</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#characters-and-strings"><span class="header-section-number">10</span> Caracteres y cadenas</a></li>
<li>
<a class="nav-link" href="#preparation-1"><span class="header-section-number">10.1</span> Preparación</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cargar-paquetes-1">Cargar paquetes</a></li>
<li><a class="nav-link" href="#importar-datos-1">Importar datos</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#unite-split-and-arrange"><span class="header-section-number">10.2</span> Unir, dividir y ordenar</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#combinar-cadenas">Combinar cadenas</a></li>
<li><a class="nav-link" href="#cadenas-din%C3%A1micas">Cadenas dinámicas</a></li>
<li><a class="nav-link" href="#str_unite">Unir columnas</a></li>
<li><a class="nav-link" href="#dividir">Dividir</a></li>
<li><a class="nav-link" href="#dividir-columnas">Dividir columnas</a></li>
<li><a class="nav-link" href="#ordenar-alfab%C3%A9ticamente">Ordenar alfabéticamente</a></li>
<li><a class="nav-link" href="#funciones-r-base">funciones R base</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#clean-and-standardise"><span class="header-section-number">10.3</span> Limpiar y normalizar</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cambiar-may%C3%BAsculas">Cambiar mayúsculas</a></li>
<li><a class="nav-link" href="#str_pad">Longitud de la cadena</a></li>
<li><a class="nav-link" href="#truncar">Truncar</a></li>
<li><a class="nav-link" href="#normalizar-la-longitud">Normalizar la longitud</a></li>
<li><a class="nav-link" href="#eliminar-los-espacios-en-blanco-iniciales-y-finales">Eliminar los espacios en blanco iniciales y finales</a></li>
<li><a class="nav-link" href="#eliminar-los-espacios-en-blanco-repetidos-en-una-cadena">Eliminar los espacios en blanco repetidos en una cadena</a></li>
<li><a class="nav-link" href="#convertir-en-p%C3%A1rrafos">convertir en párrafos</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#handle-by-position"><span class="header-section-number">10.4</span> Manipular por posición</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#extraer-por-posici%C3%B3n-de-car%C3%A1cter">Extraer por posición de carácter</a></li>
<li><a class="nav-link" href="#extraer-por-posici%C3%B3n-de-palabra">Extraer por posición de palabra</a></li>
<li><a class="nav-link" href="#sustituir-por-posici%C3%B3n-de-car%C3%A1cter">Sustituir por posición de carácter</a></li>
<li><a class="nav-link" href="#evaluar-la-longitud">Evaluar la longitud</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#patterns"><span class="header-section-number">10.5</span> Patrones</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#detectar-un-patr%C3%B3n">Detectar un patrón</a></li>
<li><a class="nav-link" href="#sustituir-todo">Sustituir todo</a></li>
<li><a class="nav-link" href="#detectar-con-l%C3%B3gica">Detectar con lógica</a></li>
<li><a class="nav-link" href="#localizar-la-posici%C3%B3n-de-un-patr%C3%B3n">Localizar la posición de un patrón</a></li>
<li><a class="nav-link" href="#extraer-una-coincidencia">Extraer una coincidencia</a></li>
<li><a class="nav-link" href="#subconjunto-y-recuento">Subconjunto y recuento</a></li>
<li><a class="nav-link" href="#grupos-regex">Grupos Regex</a></li>
</ul>
</li>
<li><a class="nav-link" href="#special-characters"><span class="header-section-number">10.6</span> Caracteres especiales</a></li>
<li><a class="nav-link" href="#regular-expressions-regex"><span class="header-section-number">10.7</span> Expresiones regulares (regex)</a></li>
<li><a class="nav-link" href="#regex-and-special-characters"><span class="header-section-number">10.8</span> Regex y caracteres especiales</a></li>
<li><a class="nav-link" href="#resources-3"><span class="header-section-number">10.9</span> Recursos</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EpiRhandbook en español</strong>" was written by El equipo del manual. It was last built on 2022-11-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
